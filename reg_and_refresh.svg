<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1056" height="2155"><desc>Google%20DBSC%0A%0Aparticipant%20%22TPM%22%20as%20t%0Aparticipant%20%22Browser%22%20as%20b%0Aparticipant%20%22Server%22%20as%20w%0A%0A%0A%0Ab-%3Ew%3A%20sign-in%20flow%0Aw-%3Eb%3A%20200%20w%2Fsigned-in%20content%2C%5Cnpage%20includes%20JS%20to%20start%5Cnsecure%20session%0Anote%20over%20b%3A%20JS%20in%20page%20runs%5Cnnavigator.secureSession.start()%0Ab-%3Et%3A%20request%20create%20keypair%0At-%3Eb%3A%20return%20public%20key%0Ab-%3Ew%3A%20POST%20%2Fsecuresession%2Fstartsession%20%5Cn%5Cn%22%22%7B%22binding_alg%22%3A...%2C%20%22binding_public_key%3A...%2C%20...%7D%22%22%0Anote%20over%20w%3A%20store%20public%20key%2C%20establish%20session%0Aw-%3Eb%3A%20200%20w%2Fcookie%20and%20session%20ID%5Cnbody%20includes%20scope%20of%20cookies%20(origin%20%2B%20path)%5Cn%5Cnheader%3A%20%22%22Set-Cookie%3A%20auth_cookie%22%22%5Cnbody%3A%20%22%22%7B%22session_identifier%22%3A...%7D%22%22%0Anote%20over%20b%3A%20promise.resolve(sessionId)%0A%0A%0A%3D%3DSome%20time%20passes...%3D%3D%0Anote%20over%20b%3A%20user%20clicks%20link%20for%20path%20%2Fsomecontent%0Ab-%3Eb%3A%20check%20if%20origin%2Bpath%20requires%20bound%20cookie%0Aalt%20bound%20cookie%20not%20required%0Ab-%3Ew%3A%20GET%20%2Fsomecontent%0Aw-%3Eb%3A%20200%20w%2Fcontent%0Aelse%20bound%20cookie%20required%0Ab-%3Eb%3A%20check%20if%20required%20cookies%20exist%0Aalt%20required%20cookie%20present%20and%20not%20expired%0Ab-%3Ew%3A%20GET%20%2Fsomecontent%0Aw-%3Eb%3A%20200%20w%2Fcontent%0Aelse%20required%20cookie%20missing%20or%20expired%0Anote%20over%20b%3A%20request%20deferred%20while%20we%20get%20cookies...%0Ab-%3Ew%3A%20GET%20%2Fsecuresession%2Frefresh%20%5Cnheader%3A%20%22%22Sec-Session-Id%3A%20%5Bsession%20ID%5D%22%22%0Aw-%3Eb%3A401%5Cn%5CnHeader%3A%20%22%22Sec-Session-Challenge%3A%20session_identifier%3D...%2C%20challenge%3D...%22%22%0Anote%20over%20b%3A%20create%20JWT%20w%2Fchallenge%0Ab-%3Et%3Arequest%20sign%20JWT%0At-%3Eb%3A%20return%20JWT%20signature%0Ab-%3Ew%3A%20GET%20%2Fsecuresession%2Frefresh%20%5Cnheader%3A%20%22%22Sec-Session-Response%3A%20%5BJWT%5D%22%22%0Anote%20over%20w%3A%20validate%20proof%20of%20possesion%0Aw-%3Eb%3A200%20w%2Fcookie%20and%20session%20ID%5Cnbody%20includes%20scope%20of%20cookies%20(origin%20%2B%20path)%5Cn%5Cnheader%3A%20%22%22Set-Cookie%3A%20auth_cookie%22%22%5Cnbody%3A%20%22%22%7B%22session_identifier%22%3A...%7D%22%22%0Anote%20over%20b%3A%20secure%20session%20established%2C%20resume%5Cnoriginal%20request%0Ab-%3Ew%3A%20GET%20%2Fsomecontent%0Aw-%3Eb%3A%20200%20w%2Fsome%20content%0Aend%0Aend%0A%0A%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1056" height="2155"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 89.84361815 55.049635120999994 L 89.84361815 2155.756779501" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 278.070832036263 55.049635120999994 L 278.070832036263 2155.756779501" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 905.7313726437175 55.049635120999994 L 905.7313726437175 2155.756779501" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 56.66992276023486 11.107938244000005 L 123.01731353976513 11.107938244000005 L 123.01731353976513 55.049635120999994 L 56.66992276023486 55.049635120999994 L 56.66992276023486 11.107938244000005 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="74.39361834073486" y="38.71443182099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TPM</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 233.5304688990003 11.107938244000005 L 322.61119517352574 11.107938244000005 L 322.61119517352574 55.049635120999994 L 233.5304688990003 55.049635120999994 L 233.5304688990003 11.107938244000005 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="251.25416447950033" y="38.71443182099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Browser</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 866.4743442385104 11.107938244000005 L 944.9884010489245 11.107938244000005 L 944.9884010489245 55.049635120999994 L 866.4743442385104 55.049635120999994 L 866.4743442385104 11.107938244000005 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="884.1980398190104" y="38.71443182099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Server</text></g></g><g><g><g><rect fill="white" stroke="none" x="552.8674897832227" y="87.720041721" width="78.06722511353516" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="555.3177702782227" y="102.42172469100001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">sign-in flow</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 278.070832036263 108.95580601099999 L 892.2820552600508 108.95580601099999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(905.7313726437175,108.95580601099999) translate(-905.7313726437175,-108.95580601099999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 892.1187032270508 102.14947130266665 L 905.7313726437175 108.95580601099999 L 892.1187032270508 115.76214071933333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="509.36748596852544" y="133.45861096099998" width="163.46722663941406" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="509.36748596852544" y="149.79381426099997" width="165.0672327429297" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="509.36748596852544" y="166.12901756099996" width="102.40056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="511.81776646352546" y="148.16029393099996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/signed-in content,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="511.81776646352546" y="164.49549723099994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">page includes JS to start</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="511.81776646352546" y="180.83070053099993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">secure session</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 905.7313726437175 187.36478185099998 L 291.5201494199297 187.36478185099998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(278.070832036263,187.36478185099998) translate(-278.070832036263,-187.36478185099998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 291.6835014529297 180.55844714266664 L 278.070832036263 187.36478185099998 L 291.6835014529297 194.1711165593333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 154.418214591556 211.86758680099996 L 387.0217665109701 211.86758680099996 L 401.7234494809701 226.56926977099997 L 401.7234494809701 265.77375769099996 L 154.418214591556 265.77375769099996 L 154.418214591556 211.86758680099996 M 387.0217665109701 211.86758680099996 L 387.0217665109701 226.56926977099997 L 401.7234494809701 226.56926977099997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="177.287499211556" y="234.73687142099993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">JS in page runs</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="177.287499211556" y="251.07207472099992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">navigator.secureSession.start()</text></g><g><g><rect fill="white" stroke="none" x="109.17360872166667" y="290.27656264099994" width="149.5672327429297" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.62388921666667" y="304.9782456109999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">request create keypair</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 278.070832036263 311.51232693099996 L 103.29293553366666 311.51232693099996" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(89.84361815,311.51232693099996) translate(-89.84361815,-311.51232693099996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 103.45628756666666 304.7059922226666 L 89.84361815 311.51232693099996 L 103.45628756666666 318.3186616393333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="127.8569430722526" y="336.01513188099995" width="112.20056404175781" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="130.3072235672526" y="350.7168148509999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return public key</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 89.84361815 357.25089617099997 L 264.6215146525964 357.25089617099997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(278.070832036263,357.25089617099997) translate(-278.070832036263,-357.25089617099997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 264.45816261959635 350.4445614626666 L 278.070832036263 357.25089617099997 L 264.45816261959635 364.0572308793333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="373.85081574147466" y="381.75370112099995" width="232.43390144410156" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="373.85081574147466" y="398.08890442099994" width="4.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="373.85081574147466" y="414.4241077209999" width="436.1005731970312" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="376.3010962364747" y="396.4553840909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /securesession/startsession </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="376.3010962364747" y="412.7905873909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="376.3010962364747" y="429.1257906909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"binding_alg":..., "binding_public_key:..., ...}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 278.070832036263 435.65987201099995 L 892.2820552600508 435.65987201099995" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(905.7313726437175,435.65987201099995) translate(-905.7313726437175,-435.65987201099995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 892.1187032270508 428.8535373026666 L 905.7313726437175 435.65987201099995 L 892.1187032270508 442.4662067193333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 772.8454177966668 460.16267696099993 L 1023.9156445207683 460.16267696099993 L 1038.6173274907683 474.8643599309999 L 1038.6173274907683 497.73364455099994 L 772.8454177966668 497.73364455099994 L 772.8454177966668 460.16267696099993 M 1023.9156445207683 460.16267696099993 L 1023.9156445207683 474.8643599309999 L 1038.6173274907683 474.8643599309999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="795.7147024166667" y="483.0319615809999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">store public key, establish session</text></g><g><g><rect fill="white" stroke="none" x="440.8841561955762" y="522.2364495009999" width="191.0672327429297" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="440.8841561955762" y="538.5716528009999" width="302.0338922888281" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="440.8841561955762" y="554.9068561009999" width="4.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="440.8841561955762" y="571.2420594009999" width="260.96722282471677" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="440.8841561955762" y="587.5772627009999" width="273.53389610352536" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="443.33443669057624" y="536.9381324709999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/cookie and session ID</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="443.33443669057624" y="553.2733357709999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body includes scope of cookies (origin + path)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="443.33443669057624" y="569.6085390709999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="443.33443669057624" y="585.9437423709999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="497.00110462880866" y="585.9437423709999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Set-Cookie: auth_cookie</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="443.33443669057624" y="602.2789456709999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="483.1677687523438" y="602.2789456709999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"session_identifier":...}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 905.7313726437175 608.8130269909999 L 291.5201494199297 608.8130269909999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(278.070832036263,608.8130269909999) translate(-278.070832036263,-608.8130269909999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 291.6835014529297 602.0066922826666 L 278.070832036263 608.8130269909999 L 291.6835014529297 615.6193616993332 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 167.83487871509115 633.3158319409999 L 373.60510238743495 633.3158319409999 L 388.30678535743493 648.0175149109999 L 388.30678535743493 670.886799531 L 167.83487871509115 670.886799531 L 167.83487871509115 633.3158319409999 M 373.60510238743495 633.3158319409999 L 373.60510238743495 648.0175149109999 L 388.30678535743493 648.0175149109999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="190.70416333509115" y="656.185116561" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">promise.resolve(sessionId)</text></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.16760165 708.7300205093333 L 1047.83239835 708.7300205093333 M 8.16760165 714.1750882759999 L 1047.83239835 714.1750882759999 M 8.16760165 719.6201560426665 L 1047.83239835 719.6201560426665" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 438.86404515294925 695.3896044809999 L 617.1359548470508 695.3896044809999 L 617.1359548470508 732.9605720709999 L 438.86404515294925 732.9605720709999 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="461.7333297729492" y="718.2588891009999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Some time passes...</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 135.30154589038412 757.4633770209998 L 406.138435212142 757.4633770209998 L 420.84011818214196 772.1650599909998 L 420.84011818214196 795.0343446109998 L 135.30154589038412 795.0343446109998 L 135.30154589038412 757.4633770209998 M 406.138435212142 757.4633770209998 L 406.138435212142 772.1650599909998 L 420.84011818214196 772.1650599909998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="158.17083051038412" y="780.3326616409998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">user clicks link for path /somecontent</text></g><g><g><rect fill="white" stroke="none" x="297.4008226079297" y="819.5371495609998" width="279.30055488648435" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="299.8511031029297" y="834.2388325309997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">check if origin+path requires bound cookie</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 278.070832036263 840.7729138509998 L 343.41164523626304 840.7729138509998 L 343.41164523626304 862.0086781409998 L 291.5201494199297 862.0086781409998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(278.070832036263,862.0086781409998) translate(-278.070832036263,-862.0086781409998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 291.6835014529297 855.2023434326665 L 278.070832036263 862.0086781409998 L 291.6835014529297 868.8150128493331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="528.4841546696973" y="930.6165320009998" width="126.83389534058594" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="530.9344351646973" y="945.3182149709997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /somecontent</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 278.070832036263 951.8522962909998 L 892.2820552600508 951.8522962909998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(905.7313726437175,951.8522962909998) translate(-905.7313726437175,-951.8522962909998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 892.1187032270508 945.0459615826665 L 905.7313726437175 951.8522962909998 L 892.1187032270508 958.6586309993331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="543.9174890202833" y="976.3551012409997" width="95.96722663941406" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="546.3677695152833" y="991.0567842109997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/content</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 905.7313726437175 997.5908655309997 L 291.5201494199297 997.5908655309997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(278.070832036263,997.5908655309997) translate(-278.070832036263,-997.5908655309997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 291.6835014529297 990.7845308226664 L 278.070832036263 997.5908655309997 L 291.6835014529297 1004.3972002393331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="297.4008226079297" y="1066.1987193909997" width="199.96722663941406" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="299.8511031029297" y="1080.9004023609998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">check if required cookies exist</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 278.070832036263 1087.4344836809998 L 343.41164523626304 1087.4344836809998 L 343.41164523626304 1108.6702479709998 L 291.5201494199297 1108.6702479709998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(278.070832036263,1108.6702479709998) translate(-278.070832036263,-1108.6702479709998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 291.6835014529297 1101.8639132626665 L 278.070832036263 1108.6702479709998 L 291.6835014529297 1115.476582679333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="528.4841546696973" y="1177.278101831" width="126.83389534058594" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="530.9344351646973" y="1191.979784801" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /somecontent</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 278.070832036263 1198.5138661209999 L 892.2820552600508 1198.5138661209999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(905.7313726437175,1198.5138661209999) translate(-905.7313726437175,-1198.5138661209999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 892.1187032270508 1191.7075314126666 L 905.7313726437175 1198.5138661209999 L 892.1187032270508 1205.320200829333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="543.9174890202833" y="1223.016671071" width="95.96722663941406" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="546.3677695152833" y="1237.718354041" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/content</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 905.7313726437175 1244.252435361 L 291.5201494199297 1244.252435361" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(278.070832036263,1244.252435361) translate(-278.070832036263,-1244.252435361)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 291.6835014529297 1237.4461006526667 L 278.070832036263 1244.252435361 L 291.6835014529297 1251.0587700693331 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 126.33487871509115 1312.860289221 L 415.10510238743495 1312.860289221 L 429.80678535743493 1327.561972191 L 429.80678535743493 1350.431256811 L 126.33487871509115 1350.431256811 L 126.33487871509115 1312.860289221 M 415.10510238743495 1312.860289221 L 415.10510238743495 1327.561972191 L 429.80678535743493 1327.561972191" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="149.20416333509115" y="1335.729573841" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">request deferred while we get cookies...</text></g><g><g><rect fill="white" stroke="none" x="439.4174909276319" y="1374.9340617609998" width="190.16722358765625" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="439.4174909276319" y="1391.269265061" width="304.96722282471677" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="441.8677714226319" y="1389.635744731" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="441.8677714226319" y="1405.970948031" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="495.5344393608643" y="1405.970948031" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Id: [session ID]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 278.070832036263 1412.5050293509998 L 892.2820552600508 1412.5050293509998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(905.7313726437175,1412.5050293509998) translate(-905.7313726437175,-1412.5050293509998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 892.1187032270508 1405.6986946426666 L 905.7313726437175 1412.5050293509998 L 892.1187032270508 1419.311364059333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="297.40082260792974" y="1437.007834301" width="29.300560608530272" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="297.40082260792974" y="1453.343037601" width="4.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="297.40082260792974" y="1469.6782409010002" width="589.0005594641211" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="299.85110310292976" y="1451.709517271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">401</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="299.85110310292976" y="1468.0447205710002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="299.85110310292976" y="1484.3799238710003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.95110157705085" y="1484.3799238710003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Challenge: session_identifier=..., challenge=...</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 905.7313726437175 1490.914005191 L 291.5201494199297 1490.914005191" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(278.070832036263,1490.914005191) translate(-278.070832036263,-1490.914005191)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 291.6835014529297 1484.1076704826667 L 278.070832036263 1490.914005191 L 291.6835014529297 1497.720339899333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 177.168214591556 1515.4168101409998 L 364.2717665109701 1515.4168101409998 L 378.9734494809701 1530.118493111 L 378.9734494809701 1552.9877777309998 L 177.168214591556 1552.9877777309998 L 177.168214591556 1515.4168101409998 M 364.2717665109701 1515.4168101409998 L 364.2717665109701 1530.118493111 L 378.9734494809701 1530.118493111" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="200.037499211556" y="1538.286094761" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">create JWT w/challenge</text></g><g><g><rect fill="white" stroke="none" x="124.62360948460612" y="1577.490582681" width="118.66723121705078" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="127.07388997960612" y="1592.192265651" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">request sign JWT</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 278.070832036263 1598.7263469709999 L 103.29293553366666 1598.7263469709999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(89.84361815,1598.7263469709999) translate(-89.84361815,-1598.7263469709999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 103.45628756666666 1591.9200122626667 L 89.84361815 1598.7263469709999 L 103.45628756666666 1605.532681679333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="113.24027437108073" y="1623.229151921" width="141.43390144410156" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="115.69055486608073" y="1637.9308348910001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return JWT signature</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 89.84361815 1644.464916211 L 264.6215146525964 1644.464916211" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(278.070832036263,1644.464916211) translate(-278.070832036263,-1644.464916211)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 264.45816261959635 1637.6585815026667 L 278.070832036263 1644.464916211 L 264.45816261959635 1651.2712509193332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="443.81748482411626" y="1668.9677211609999" width="190.16722358765625" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="443.81748482411626" y="1685.302924461" width="296.167235031748" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.2677653191163" y="1683.669404131" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.2677653191163" y="1700.004607431" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.9344332573487" y="1700.004607431" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Response: [JWT]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 278.070832036263 1706.5386887509999 L 892.2820552600508 1706.5386887509999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(905.7313726437175,1706.5386887509999) translate(-905.7313726437175,-1706.5386887509999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 892.1187032270508 1699.7323540426667 L 905.7313726437175 1706.5386887509999 L 892.1187032270508 1713.345023459333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 795.8620880237175 1731.0414937009998 L 1000.8989742937175 1731.0414937009998 L 1015.6006572637175 1745.743176671 L 1015.6006572637175 1768.6124612909998 L 795.8620880237175 1768.6124612909998 L 795.8620880237175 1731.0414937009998 M 1000.8989742937175 1731.0414937009998 L 1000.8989742937175 1745.743176671 L 1015.6006572637175 1745.743176671" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="818.7313726437175" y="1753.910778321" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">validate proof of possesion</text></g><g><g><rect fill="white" stroke="none" x="440.8841561955762" y="1793.1152662409997" width="191.0672327429297" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="440.8841561955762" y="1809.4504695409998" width="302.0338922888281" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="440.8841561955762" y="1825.785672841" width="4.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="440.8841561955762" y="1842.120876141" width="260.96722282471677" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="440.8841561955762" y="1858.4560794410002" width="273.53389610352536" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="443.33443669057624" y="1807.8169492109998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/cookie and session ID</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="443.33443669057624" y="1824.152152511" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body includes scope of cookies (origin + path)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="443.33443669057624" y="1840.487355811" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="443.33443669057624" y="1856.8225591110001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="497.00110462880866" y="1856.8225591110001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Set-Cookie: auth_cookie</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="443.33443669057624" y="1873.1577624110002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="483.1677687523438" y="1873.1577624110002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"session_identifier":...}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 905.7313726437175 1879.6918437309998 L 291.5201494199297 1879.6918437309998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(278.070832036263,1879.6918437309998) translate(-278.070832036263,-1879.6918437309998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 291.6835014529297 1872.8855090226666 L 278.070832036263 1879.6918437309998 L 291.6835014529297 1886.498178439333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 138.9682176433138 1904.1946486809998 L 402.4717634592123 1904.1946486809998 L 417.1734464292123 1918.8963316509999 L 417.1734464292123 1958.1008195709999 L 138.9682176433138 1958.1008195709999 L 138.9682176433138 1904.1946486809998 M 402.4717634592123 1904.1946486809998 L 402.4717634592123 1918.8963316509999 L 417.1734464292123 1918.8963316509999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="161.8375022633138" y="1927.0639333010001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">secure session established, resume</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="161.8375022633138" y="1943.3991366010002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">original request</text></g><g><g><rect fill="white" stroke="none" x="528.4841546696973" y="1982.603624521" width="126.83389534058594" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="530.9344351646973" y="1997.3053074910001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /somecontent</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 278.070832036263 2003.839388811 L 892.2820552600508 2003.839388811" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(905.7313726437175,2003.839388811) translate(-905.7313726437175,-2003.839388811)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 892.1187032270508 1997.0330541026667 L 905.7313726437175 2003.839388811 L 892.1187032270508 2010.6457235193332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="524.0008248967481" y="2028.3421937609999" width="135.80055488648438" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="526.4511053917481" y="2043.043876731" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/some content</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 905.7313726437175 2049.5779580509998 L 291.5201494199297 2049.5779580509998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(278.070832036263,2049.5779580509998) translate(-278.070832036263,-2049.5779580509998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 291.6835014529297 2042.7716233426665 L 278.070832036263 2049.5779580509998 L 291.6835014529297 2056.384292759333 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 16.335203300000003 886.5114830909998 L 1040.1034622137174 886.5114830909998 L 1040.1034622137174 2098.583567951 L 16.335203300000003 2098.583567951 L 16.335203300000003 886.5114830909998 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 16.335203300000003 886.5114830909998 L 16.335203300000003 906.1137270509998 L 62.73894348764649 906.1137270509998 L 72.54006546764649 896.3126050709998 L 72.54006546764649 886.5114830909998 L 16.335203300000003 886.5114830909998" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="32.67040660000001" y="899.5796457309998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="86.42498827264649" y="887.8182993549998" width="161.23388923707031" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="88.87526876764649" y="899.5796457309998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[bound cookie not required]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 16.335203300000003 1022.0936704809998 L 1040.1034622137174 1022.0936704809998" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray="4.083800825"/></g><g/><g><rect fill="white" stroke="none" x="86.42498827264649" y="1023.4004867449997" width="139.63389839234375" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="88.87526876764649" y="1035.1618331209997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[bound cookie required]</text></g><g/><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 32.6704066 1133.173052921 L 1023.7682589137174 1133.173052921 L 1023.7682589137174 2074.080763001 L 32.6704066 2074.080763001 L 32.6704066 1133.173052921 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 32.6704066 1133.173052921 L 32.6704066 1152.7752968809998 L 79.07414678764648 1152.7752968809998 L 88.87526876764649 1142.974174901 L 88.87526876764649 1133.173052921 L 32.6704066 1133.173052921" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="49.005609899999996" y="1146.2412155609998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="102.76019157264649" y="1134.4798691849999" width="237.03389228882813" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="105.21047206764649" y="1146.2412155609998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[required cookie present and not expired]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 32.6704066 1268.755240311 L 1023.7682589137174 1268.755240311" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray="4.083800825"/></g><g/><g><rect fill="white" stroke="none" x="102.76019157264649" y="1270.062056575" width="208.23388923707031" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="105.21047206764649" y="1281.823402951" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[required cookie missing or expired]</text></g><g/></g></g></svg>