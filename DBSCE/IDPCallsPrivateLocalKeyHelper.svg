<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="2040.930199898857" height="4152.726244350725"><desc>title%20IdP%20calls%20a%20private%20Local%20Key%20Helper%0A%0Aautonumber%201%0Aparticipant%20%22Relying%20Party%22%20as%20W%0Aparticipant%20%22IdP%22%20as%20I%0Aparticipant%20%22Browser%22%20as%20B%0Aparticipant%20%22Local%20Key%20Helper%22%20as%20P%0A%0Anote%20over%20W%2C%20P%3A%20IdP%20life...%0AB-%3E%3EI%3A%20Any%20request%0AI-%3E%3EB%3A%20Any%20response%5CnSec-Session-HelperIdList%3A%20%5BHelperId1%2C%20HelperId2%5D%2C%20HelperCacheTime%0AB-%3E%3EB%3A%20Cache%20HelperId%20for%20IDPURL%20for%20HelperCacheTime%0A%0Anote%20over%20W%2C%20P%3A%20Sign%20in...%0AW-%3E%3EB%3A%20Start%20sign%20in%20(302)%5CnSec-Session-Registration%3A%20path%2C%20RPChallenge%2C...%20%5CnSec-Session-GenerateKey%3A%20RPUrl%2C%20IDPUrl%2C%20extraParams%0AB-%3E%3EB%3A%20Check%20for%20cached%20HelperId%20for%20IDPUrl%0A%0Aalt%20Cached%20HelperId%20present%20(99.99%25%20cases)%0A%0A%20%20%20%20B-%3E%3EB%3A%20currentHelperId%20%3D%20Evaluate%20policy%20for%20(IdP%2C%20%5BHelperId1%2C%20HelperId2...%5D)%0A%0A%20%20%20%20B-%3E%3EP%3A%20Pre-gen%20key%20and%20attest%20(RPUrl%2C%20IDPUrl%2C%20extraParams...)%0A%0A%20%20%20%20P-%3E%3EP%3A%20Generate%20Key%0A%0A%20%20%20%20loop%20For%20each%20device%0A%20%20%20%20%20%20%20%20P-%3E%3EP%3A%20create%20binding%20statement%20S(publicKey%2C%20AIK)%0A%20%20%20%20end%0A%0A%20%20%20%20P-%3E%3EB%3A%20Return%3A%20KeyId%2C%20%5Cnarray%20of%20binding%20statements%20%5BBindingStatement1%20%7BextraClaims....%7D%2C%20%5CnBindingStatement2%20%7BextraCalims...%7D%5D%0A%20%20%20%20B-%3E%3EB%3A%20Remember%20this%20key%20is%20for%20RP%20(and%20maybe%20path)%0A%0A%20%20%20%20B-%3E%3EI%3A%20Load%20sign-in%20(follow%20the%20302)%5Cn%5CnUserAuthHeader1%7Bnonce%7D%5CnDeviceAuthHeader%7Bnonce%7D%5Cn%5CnUserAuthHeader1%7Bnonce%7D%5CnDeviceAuthHeader%7Bnonce%7D%20...%5Cn%5CnSec-Session-BindingInfo%3A%20KeyId%2C%20PublicKey%2C%20%5Cnarray%20of%20binding%20statements%20%5BBindingStatement1%20%7BextraClaims....%7D%2C%20%5CnBindingStatement2%20%7BextraCalims...%7D%5D%0A%0A%20%20%20%20opt%20nonce%20is%20stale%0A%20%20%20%20%20%20%20%20I-%3E%3EB%3A%20302%20to%20IdP%20with%20qs%20parameter%20sso_nonce%3Dnew_nonce%5CnSec-Session-GenerateKey%3A%20RPURL%2C%20IDPURL%2C%20extraParams%0A%20%20%20%20%20%20%20%20B-%3E%3EI%3A%20Load%20sign-in%5Cn%5CnUserAuthHeader1%7Bnew_nonce%7D%5CnDeviceAuthHeader1%7Bnew_nonce%7D%5Cn%5CnUserAuthHeader2%7Bnew_nonce%7D%5CnDeviceAuthHeader2%7Bnew_nonce%7D%20...%5Cn%5CnSec-Session-BindingInfo%3A%20KeyId%2C%20PublicKey%2C%20%5Cnarray%20of%20binding%20statements%20%5BBindingStatement1%20%7BextraClaims....%7D%2C%20%5CnBindingStatement2%20%7BextraCalims...%7D%5D%0A%20%20%20%20end%0A%0Aelse%20No%20cached%20HelperId%20present%0A%0A%0A%20%20%20%20B-%3E%3EI%3A%20Load%20sign-in%20(follow%20the%20302)%5Cn%5CnUserAuthHeader1%7Bnonce%7D%5CnDeviceAuthHeader1%7Bnonce%7D%5Cn%5CnUserAuthHeader2%7Bnonce%7D%5CnDeviceAuthHeader2%7Bnonce%7D%20...%20%5Cn%5CnSec-Session-HelperDiscoveryNeeded%3A%20RPURL%2C%20IDPURL%2C%20extraParams%0A%0A%20%20%20%20note%20over%20I%2C%20B%3A%20No%20binding%20info%20present%2C%20but%20the%20reequest%20has%20GenerratKey%2C%20so%20IdP%20issues%20helper%20id%20list%0A%0A%20%20%20%20I-%3E%3EB%3A%20302%20to%20IdP%20with%20qs%20parameter%20sso_nonce%3Dnew_nonce%5Cn%5CnSec-Session-GenerateKey%3A%20RPURL%2C%20IDPURL%2C%20extraParams%5CnSec-Session-HelperIdList%3A%20%5BHelperId1%2C%20HelperId2%5D%2C%20HelperCacheTime%0A%20%20%20%20B-%3E%3EB%3A%20Cache%20HelperId%20for%20IDPURL%20for%20HelperCacheTime%0A%0A%20%20%20%20B-%3E%3EB%3A%20currentHelperId%20%3D%20Evaluate%20policy%20for%20(IdP%2C%20%5BHelperId1%5D)%0A%20%20%20%20B-%3E%3EP%3A%20Pre-gen%20key%20and%20attest%20(RPURL%2C%20IDPURL%2C%20extraParams...)%0A%0A%20%20%20%20P-%3E%3EP%3A%20Generate%20Key%0A%0A%20%20%20%20loop%20For%20each%20device%0A%20%20%20%20%20%20%20%20P-%3E%3EP%3A%20create%20binding%20statement%20S(publicKey%2C%20AIK)%0A%20%20%20%20end%0A%0A%20%20%20%20P-%3E%3EB%3A%20Return%3A%20KeyId%2C%20%5Cnarray%20of%20binding%20statements%20%5BBindingStatement1%20%7BextraClaims....%7D%2C%20%5CnBindingStatement2%20%7BextraCalims...%7D%5D%0A%20%20%20%20B-%3E%3EB%3A%20Remember%20this%20key%20is%20for%20RP%20(and%20maybe%20path)%0A%0A%20%20%20%20B-%3E%3EI%3A%20Load%20sign-in%5Cn%5CnUserAuthHeader1%7Bnew_nonce%7D%5CnDeviceAuthHeader1%7Bnew_nonce%7D%5Cn%20UserAuthHeader2%7Bnew_nonce%7D%5Cn%20DeviceAuthHeader2%7Bnew_nonce%7D%20...%20%5Cn%5CnSec-Session-BindingInfo%3A%20KeyId%2C%20PublicKey%2C%20%5Cnarray%20of%20binding%20statements%20%5BBindingStatement1%20%7BextraClaims....%7D%2C%20%5CnBindingStatement2%20%7BextraCalims...%7D%5D%0A%0A%0Aend%0A%0Aopt%20SSO%20information%20is%20not%20sufficient%0A%20%20%20%20I-%3E%3EB%3A%20Sign%20in%20ceremony%0A%20%20%20%20B-%3E%3EI%3A%20Sign%20done%0Aend%0A%0AI-%3E%3EB%3A%20Authorization%20code%2C%20KeyId%0A%0A%0Anote%20over%20W%2C%20B%3A%20Since%20DBSC%20session%20has%20been%20initialized%20already%20for%20RP%2C%20browser%20needs%20to%20generate%20JWT%20on%20redirect%20back%0AB-%3E%3EP%3A%20Request%20Sign%20JWT%20(path%2C%20RPChallenge%2C%20extraParams)%0AP-%3E%3EB%3A%20Return%20JWT%20Signature%0Anote%20over%20W%2C%20B%3A%20JWT%20is%20appended%20by%20the%20browser%20before%20returning%20the%20response%20from%20IDP%20back%20to%20the%20RP%0AB-%3E%3EW%3A%20Authorization%20code%2C%20KeyId%2C%20JWT%0AW-%3E%3EI%3A%20(confidential%20client%20request)%20redeem%20authorization%20code%0AI-%3E%3EW%3A%20(confidential%20client%20response)%20return%20id_token%0AW-%3E%3EW%3A%20parse%20id_token%20and%20validate%20binding%2C%20match%20with%20the%20JWT%20from%20the%20previous%0AW-%3E%3EB%3A%20Bound%20AuthCookie%0A%0Anote%20over%20W%2C%20P%3A%20Refresh%20DBSC...%0AB-%3E%3EW%3A%20GET%20%2Fsecuresession%2Frefresh%20(sessionID)%0AW-%3E%3EB%3A%20Challenge%2C%20**extraParams**%0AB-%3E%3EP%3A%20Request%20Sign%20JWT%20(sessionID%2C%20RPChallenge%2C%20**extraParams**)%0AP-%3E%3EB%3A%20Return%20JWT%20Signature%0AB-%3E%3EW%3A%20GET%20%2Fsecuresession%2Frefresh%20(JWT)%0AW-%3E%3EW%3A%20Validate%20JWT%20(w%2Fpublic%20key%20on%20file)%0AW-%3E%3EB%3A%20AuthCookie%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="2040" height="4152"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 71.47274871142187 103.10369087072726 L 71.47274871142187 4152.726244350725" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 608.949599965263 103.10369087072726 L 608.949599965263 4152.726244350725" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 103.10369087072726 L 1182.8618071943647 4152.726244350725" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1674.6978428782188 103.10369087072726 L 1674.6978428782188 4152.726244350725" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.795878699999996 55.781863464727266 L 134.14961872284374 55.781863464727266 L 134.14961872284374 103.10369087072726 L 8.795878699999996 103.10369087072726 L 8.795878699999996 55.781863464727266 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="27.882935478999997" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Relying Party</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 578.8603993263997 55.781863464727266 L 639.0388006041263 55.781863464727266 L 639.0388006041263 103.10369087072726 L 578.8603993263997 103.10369087072726 L 578.8603993263997 55.781863464727266 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="597.9474561053997" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1136.892159167806 55.781863464727266 L 1228.8314552209233 55.781863464727266 L 1228.8314552209233 103.10369087072726 L 1136.892159167806 103.10369087072726 L 1136.892159167806 55.781863464727266 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1155.979215946806" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Browser</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1599.7911983916993 55.781863464727266 L 1749.6044873647384 55.781863464727266 L 1749.6044873647384 103.10369087072726 L 1599.7911983916993 103.10369087072726 L 1599.7911983916993 55.781863464727266 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1618.8782551706993" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Local Key Helper</text></g></g><g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16pt" font-style="normal" font-weight="normal" text-decoration="normal" x="851.6463012695312" y="26.547561167272725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP calls a private Local Key Helper</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 55.64016705142187 138.28720567072725 L 1674.6978428782188 138.28720567072725 L 1690.5304245382188 154.11978733072723 L 1690.5304245382188 178.74824769072725 L 55.64016705142187 178.74824769072725 L 55.64016705142187 138.28720567072725 M 1674.6978428782188 138.28720567072725 L 1674.6978428782188 154.11978733072723 L 1690.5304245382188 154.11978733072723" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="844.567053912496" y="162.9156660307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP life...</text></g><g><rect fill="white" stroke="none" x="860.2640942056538" y="205.13588379072726" width="83.50941503738281" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="862.9028578156538" y="220.96846545072728" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Any request</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="850.6766615265913" y="220.96846545072728" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 228.00516841072726 L 611.148569640263 228.00516841072726" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(608.949599965263,228.00516841072726) translate(-608.949599965263,-228.00516841072726)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.021401608552 221.28150958005585 L 610.5976152050855 228.00516841072726 L 624.021401608552 234.72882724139868" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="678.0200680215718" y="254.39280451072727" width="94.91957128738281" height="22.86928462"/><rect fill="white" stroke="none" x="678.0200680215718" y="271.9845619107273" width="447.997497923125" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="680.6588316315717" y="270.2253861707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Any response</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="668.4326353425092" y="270.2253861707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="680.6588316315717" y="287.8171435707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-HelperIdList: [HelperId1, HelperId2], HelperCacheTime</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 608.949599965263 294.85384653072725 L 1180.6628375193648 294.85384653072725" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,294.85384653072725) translate(-1182.8618071943647,-294.85384653072725)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1167.7900055510756 288.1301877000559 L 1181.213791954542 294.85384653072725 L 1167.7900055510756 301.5775053613986" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1215.9049164067605" y="321.24148263072726" width="329.0140384504688" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1218.5436800167606" y="337.0740642907273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Cache HelperId for IDPURL for HelperCacheTime</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1206.3174837276981" y="337.0740642907273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 344.1107672507273 L 1253.2288367943647 344.1107672507273 L 1253.2288367943647 366.98005187072727 L 1185.0607768693646 366.98005187072727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,366.98005187072727) translate(-1182.8618071943647,-366.98005187072727)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1197.9336088376538 360.2563930400559 L 1184.5098224341873 366.98005187072727 L 1197.9336088376538 373.7037107013986" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 55.64016705142187 393.3676879707273 L 1674.6978428782188 393.3676879707273 L 1690.5304245382188 409.2002696307273 L 1690.5304245382188 433.82872999072725 L 55.64016705142187 433.82872999072725 L 55.64016705142187 393.3676879707273 M 1674.6978428782188 393.3676879707273 L 1674.6978428782188 409.2002696307273 L 1690.5304245382188 409.2002696307273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="844.5634757264609" y="417.99614833072724" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sign in...</text></g><g><rect fill="white" stroke="none" x="448.9630922847878" y="460.21636609072726" width="120.98254430984375" height="22.86928462"/><rect fill="white" stroke="none" x="448.9630922847878" y="477.80812349072727" width="322.2566531965625" height="22.86928462"/><rect fill="white" stroke="none" x="448.9630922847878" y="495.3998808907273" width="368.6345523664844" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="451.60185589478783" y="476.0489477507273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Start sign in (302)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="439.37565960572533" y="476.0489477507273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="451.60185589478783" y="493.6407051507273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Registration: path, RPChallenge,... </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="451.60185589478783" y="511.2324625507273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-GenerateKey: RPUrl, IDPUrl, extraParams</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 71.47274871142187 518.2691655107272 L 1180.6628375193648 518.2691655107272" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,518.2691655107272) translate(-1182.8618071943647,-518.2691655107272)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1167.7900055510756 511.5455066800559 L 1181.213791954542 518.2691655107272 L 1167.7900055510756 524.9928243413987" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1215.9049164067605" y="544.6568016107273" width="247.26025427078125" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1218.5436800167606" y="560.4893832707272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Check for cached HelperId for IDPUrl</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1206.3174837276981" y="560.4893832707272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 567.5260862307272 L 1253.2288367943647 567.5260862307272 L 1253.2288367943647 590.3953708507272 L 1185.0607768693646 590.3953708507272" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,590.3953708507272) translate(-1182.8618071943647,-590.3953708507272)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1197.9336088376538 583.6717120200558 L 1184.5098224341873 590.3953708507272 L 1197.9336088376538 597.1190296813986" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1215.9049164067605" y="664.2807519307272" width="440.5457767317188" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1218.5436800167606" y="680.1133335907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">currentHelperId = Evaluate policy for (IdP, [HelperId1, HelperId2...])</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1206.3174837276981" y="680.1133335907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 687.1500365507271 L 1253.2288367943647 687.1500365507271 L 1253.2288367943647 710.0193211707272 L 1185.0607768693646 710.0193211707272" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,710.0193211707272) translate(-1182.8618071943647,-710.0193211707272)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1197.9336088376538 703.2956623400557 L 1184.5098224341873 710.0193211707272 L 1197.9336088376538 716.7429800013986" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1254.6522308598853" y="736.4069572707272" width="360.481384641875" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1257.2909944698854" y="752.2395389307271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Pre-gen key and attest (RPUrl, IDPUrl, extraParams...)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1245.064798180823" y="752.2395389307271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 759.2762418907272 L 1672.4988732032189 759.2762418907272" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1674.6978428782188,759.2762418907272) translate(-1674.6978428782188,-759.2762418907272)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1659.6260412349297 752.5525830600558 L 1673.0498276383962 759.2762418907272 L 1659.6260412349297 765.9999007213986" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1707.7409520906147" y="785.6638779907272" width="95.73562658523437" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1710.3797157006147" y="801.4964596507272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate Key</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1698.1535194115522" y="801.4964596507272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1674.6978428782188 808.5331626107271 L 1745.0648724782188 808.5331626107271 L 1745.0648724782188 831.4024472307271 L 1676.8968125532188 831.4024472307271" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1674.6978428782188,831.4024472307271) translate(-1674.6978428782188,-831.4024472307271)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1689.7696445215079 824.6787884000557 L 1676.3458581180414 831.4024472307271 L 1689.7696445215079 838.1261060613986" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1707.7409520906147" y="905.2878283107271" width="283.6954349348438" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1710.3797157006147" y="921.1204099707271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">create binding statement S(publicKey, AIK)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1698.1535194115522" y="921.1204099707271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1674.6978428782188 928.1571129307271 L 1745.0648724782188 928.1571129307271 L 1745.0648724782188 951.0263975507271 L 1676.8968125532188 951.0263975507271" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1674.6978428782188,951.0263975507271) translate(-1674.6978428782188,-951.0263975507271)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1689.7696445215079 944.3027387200557 L 1676.3458581180414 951.0263975507271 L 1689.7696445215079 957.7500563813985" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1224.0580993901588" y="1003.801669750727" width="103.05845678542968" height="22.86928462"/><rect fill="white" stroke="none" x="1224.0580993901588" y="1021.3934271507269" width="429.8228153059375" height="22.86928462"/><rect fill="white" stroke="none" x="1224.0580993901588" y="1038.985184550727" width="236.70193517898437" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1226.6968630001588" y="1019.634251410727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return: KeyId, </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1206.317483727698" y="1019.634251410727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1226.6968630001588" y="1037.2260088107269" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">array of binding statements [BindingStatement1 {extraClaims....}, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1226.6968630001588" y="1054.8177662107269" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BindingStatement2 {extraCalims...}]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1674.6978428782188 1061.854469170727 L 1185.0607768693646 1061.854469170727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,1061.854469170727) translate(-1182.8618071943647,-1061.854469170727)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1197.9336088376538 1055.1308103400556 L 1184.5098224341873 1061.854469170727 L 1197.9336088376538 1068.5781280013985" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1223.2563873540262" y="1088.242105270727" width="310.8106693098438" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1225.8951509640262" y="1104.074686930727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Remember this key is for RP (and maybe path)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1206.3174837276981" y="1104.074686930727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">11 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 1111.1113898907272 L 1253.2288367943647 1111.1113898907272 L 1253.2288367943647 1133.980674510727 L 1185.0607768693646 1133.980674510727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,1133.980674510727) translate(-1182.8618071943647,-1133.980674510727)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1197.9336088376538 1127.2570156800557 L 1184.5098224341873 1133.980674510727 L 1197.9336088376538 1140.7043333413985" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="691.1839779336811" y="1160.3683106107271" width="189.45066869949218" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="1195.5518254107271" width="172.35693395828125" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="1213.1435828107271" width="178.06201208328125" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="1248.3270976107272" width="172.35693395828125" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="1265.9188550107272" width="194.3540653059375" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="1301.1023698107272" width="291.848572141875" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="1318.6941272107272" width="429.8228153059375" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="1336.2858846107272" width="236.70193517898437" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1176.200892270727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Load sign-in (follow the 302)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="673.4433622712202" y="1176.200892270727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">12 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1211.384407070727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UserAuthHeader1{nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1228.976164470727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DeviceAuthHeader{nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1264.159679270727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UserAuthHeader1{nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1281.7514366707271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DeviceAuthHeader{nonce} ...</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1316.9349514707271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-BindingInfo: KeyId, PublicKey, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1334.5267088707271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">array of binding statements [BindingStatement1 {extraClaims....}, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1352.1184662707271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BindingStatement2 {extraCalims...}]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 1359.155169230727 L 611.148569640263 1359.155169230727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(608.949599965263,1359.155169230727) translate(-608.949599965263,-1359.155169230727)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.021401608552 1352.4315104000557 L 610.5976152050855 1359.155169230727 L 624.021401608552 1365.8788280613985" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="711.1768063028218" y="1433.040550310727" width="351.2330325910938" height="22.86928462"/><rect fill="white" stroke="none" x="711.1768063028218" y="1450.632307710727" width="389.8371890852344" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="713.8155699128217" y="1448.873131970727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">302 to IdP with qs parameter sso_nonce=new_nonce</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="693.4361906403608" y="1448.873131970727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">13 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="713.8155699128217" y="1466.464889370727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-GenerateKey: RPURL, IDPURL, extraParams</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 608.949599965263 1473.501592330727 L 1180.6628375193648 1473.501592330727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,1473.501592330727) translate(-1182.8618071943647,-1473.501592330727)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1167.7900055510756 1466.7779335000555 L 1181.213791954542 1473.501592330727 L 1167.7900055510756 1480.2252511613983" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="691.1839779336811" y="1499.889228430727" width="85.14863622878906" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="1535.072743230727" width="207.4034580061328" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="1552.664500630727" width="221.26171911453125" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="1587.848015430727" width="207.4034580061328" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="1605.439772830727" width="237.5537723371875" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="1640.623287630727" width="291.848572141875" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="1658.215045030727" width="429.8228153059375" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="1675.806802430727" width="236.70193517898437" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1515.7218100907269" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Load sign-in</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="673.4433622712202" y="1515.7218100907269" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">14 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1550.905324890727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UserAuthHeader1{new_nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1568.497082290727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DeviceAuthHeader1{new_nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1603.680597090727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UserAuthHeader2{new_nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1621.272354490727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DeviceAuthHeader2{new_nonce} ...</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1656.455869290727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-BindingInfo: KeyId, PublicKey, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1674.047626690727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">array of binding statements [BindingStatement1 {extraClaims....}, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="1691.639384090727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BindingStatement2 {extraCalims...}]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 1698.676087050727 L 611.148569640263 1698.676087050727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(608.949599965263,1698.676087050727) translate(-608.949599965263,-1698.676087050727)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.021401608552 1691.9524282200555 L 610.5976152050855 1698.676087050727 L 624.021401608552 1705.3997458813983" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="674.9241436441304" y="1798.949104230727" width="189.45066869949218" height="22.86928462"/><rect fill="white" stroke="none" x="674.9241436441304" y="1834.132619030727" width="172.35693395828125" height="22.86928462"/><rect fill="white" stroke="none" x="674.9241436441304" y="1851.724376430727" width="186.21519506667968" height="22.86928462"/><rect fill="white" stroke="none" x="674.9241436441304" y="1886.907891230727" width="172.35693395828125" height="22.86928462"/><rect fill="white" stroke="none" x="674.9241436441304" y="1904.499648630727" width="206.580261595" height="22.86928462"/><rect fill="white" stroke="none" x="674.9241436441304" y="1939.683163430727" width="462.34249914382815" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="677.5629072541303" y="1814.781685890727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Load sign-in (follow the 302)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="657.1835279816694" y="1814.781685890727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">15 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="677.5629072541303" y="1849.965200690727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UserAuthHeader1{nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="677.5629072541303" y="1867.556958090727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DeviceAuthHeader1{nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="677.5629072541303" y="1902.740472890727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UserAuthHeader2{nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="677.5629072541303" y="1920.332230290727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DeviceAuthHeader2{nonce} ... </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="677.5629072541303" y="1955.515745090727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-HelperDiscoveryNeeded: RPURL, IDPURL, extraParams</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 1962.552448050727 L 611.148569640263 1962.552448050727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(608.949599965263,1962.552448050727) translate(-608.949599965263,-1962.552448050727)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.021401608552 1955.8287892200556 L 610.5976152050855 1962.552448050727 L 624.021401608552 1969.2761068813984" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 593.1170183052631 1988.940084150727 L 1182.8618071943647 1988.940084150727 L 1198.6943888543647 2004.772665810727 L 1198.6943888543647 2029.401126170727 L 593.1170183052631 2029.401126170727 L 593.1170183052631 1988.940084150727 M 1182.8618071943647 1988.940084150727 L 1182.8618071943647 2004.772665810727 L 1198.6943888543647 2004.772665810727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="617.7454786652631" y="2013.5685445107267" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">No binding info present, but the reequest has GenerratKey, so IdP issues helper id list</text></g><g><rect fill="white" stroke="none" x="682.096659513271" y="2055.7887622707267" width="351.2330325910938" height="22.86928462"/><rect fill="white" stroke="none" x="682.096659513271" y="2090.9722770707267" width="389.8371890852344" height="22.86928462"/><rect fill="white" stroke="none" x="682.096659513271" y="2108.5640344707267" width="447.997497923125" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="684.735423123271" y="2071.6213439307267" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">302 to IdP with qs parameter sso_nonce=new_nonce</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="664.35604385081" y="2071.6213439307267" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">16 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="684.735423123271" y="2106.8048587307267" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-GenerateKey: RPURL, IDPURL, extraParams</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="684.735423123271" y="2124.3966161307267" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-HelperIdList: [HelperId1, HelperId2], HelperCacheTime</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 608.949599965263 2131.433319090727 L 1180.6628375193648 2131.433319090727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,2131.433319090727) translate(-1182.8618071943647,-2131.433319090727)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1167.7900055510756 2124.7096602600554 L 1181.213791954542 2131.433319090727 L 1167.7900055510756 2138.1569779213983" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1224.058099390159" y="2157.820955190727" width="329.0140384504688" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1226.696863000159" y="2173.653536850727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Cache HelperId for IDPURL for HelperCacheTime</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1206.3174837276981" y="2173.653536850727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">17 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 2180.690239810727 L 1253.2288367943647 2180.690239810727 L 1253.2288367943647 2203.559524430727 L 1185.0607768693646 2203.559524430727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,2203.559524430727) translate(-1182.8618071943647,-2203.559524430727)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1197.9336088376538 2196.8358656000555 L 1184.5098224341873 2203.559524430727 L 1197.9336088376538 2210.2831832613983" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1224.058099390159" y="2229.947160530727" width="356.61590612625" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1226.696863000159" y="2245.779742190727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">currentHelperId = Evaluate policy for (IdP, [HelperId1])</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1206.3174837276981" y="2245.779742190727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">18 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 2252.816445150727 L 1253.2288367943647 2252.816445150727 L 1253.2288367943647 2275.685729770727 L 1185.0607768693646 2275.685729770727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,2275.685729770727) translate(-1182.8618071943647,-2275.685729770727)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1197.9336088376538 2268.9620709400556 L 1184.5098224341873 2275.685729770727 L 1197.9336088376538 2282.4093886013984" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1248.1275192509986" y="2302.073365870727" width="381.6839603254688" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1250.7662828609987" y="2317.9059475307267" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Pre-gen key and attest (RPURL, IDPURL, extraParams...)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1230.3869035885377" y="2317.9059475307267" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">19 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 2324.942650490727 L 1672.4988732032189 2324.942650490727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1674.6978428782188,2324.942650490727) translate(-1674.6978428782188,-2324.942650490727)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1659.6260412349297 2318.2189916600555 L 1673.0498276383962 2324.942650490727 L 1659.6260412349297 2331.6663093213983" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1715.894135074013" y="2351.330286590727" width="95.73562658523437" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1718.5328986840132" y="2367.162868250727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate Key</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1698.1535194115522" y="2367.162868250727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">20 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1674.6978428782188 2374.199571210727 L 1745.0648724782188 2374.199571210727 L 1745.0648724782188 2397.068855830727 L 1676.8968125532188 2397.068855830727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1674.6978428782188,2397.068855830727) translate(-1674.6978428782188,-2397.068855830727)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1689.7696445215079 2390.3451970000556 L 1676.3458581180414 2397.068855830727 L 1689.7696445215079 2403.7925146613984" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1715.894135074013" y="2470.954236910727" width="283.6954349348438" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1718.5328986840132" y="2486.786818570727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">create binding statement S(publicKey, AIK)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1698.1535194115522" y="2486.786818570727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">21 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1674.6978428782188 2493.823521530727 L 1745.0648724782188 2493.823521530727 L 1745.0648724782188 2516.692806150727 L 1676.8968125532188 2516.692806150727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1674.6978428782188,2516.692806150727) translate(-1674.6978428782188,-2516.692806150727)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1689.7696445215079 2509.9691473200555 L 1676.3458581180414 2516.692806150727 L 1689.7696445215079 2523.4164649813983" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1224.0580993901588" y="2569.4680783507265" width="103.05845678542968" height="22.86928462"/><rect fill="white" stroke="none" x="1224.0580993901588" y="2587.0598357507265" width="429.8228153059375" height="22.86928462"/><rect fill="white" stroke="none" x="1224.0580993901588" y="2604.6515931507265" width="236.70193517898437" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1226.6968630001588" y="2585.3006600107265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return: KeyId, </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1206.317483727698" y="2585.3006600107265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">22 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1226.6968630001588" y="2602.8924174107265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">array of binding statements [BindingStatement1 {extraClaims....}, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1226.6968630001588" y="2620.4841748107265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BindingStatement2 {extraCalims...}]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1674.6978428782188 2627.5208777707267 L 1185.0607768693646 2627.5208777707267" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,2627.5208777707267) translate(-1182.8618071943647,-2627.5208777707267)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1197.9336088376538 2620.7972189400552 L 1184.5098224341873 2627.5208777707267 L 1197.9336088376538 2634.244536601398" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1224.058099390159" y="2653.908513870727" width="310.8106693098438" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1226.696863000159" y="2669.741095530727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Remember this key is for RP (and maybe path)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1206.3174837276981" y="2669.741095530727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">23 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 2676.7777984907266 L 1253.2288367943647 2676.7777984907266 L 1253.2288367943647 2699.6470831107267 L 1185.0607768693646 2699.6470831107267" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,2699.6470831107267) translate(-1182.8618071943647,-2699.6470831107267)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1197.9336088376538 2692.9234242800553 L 1184.5098224341873 2699.6470831107267 L 1197.9336088376538 2706.370741941398" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="691.1839779336811" y="2726.0347192107265" width="85.14863622878906" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="2761.2182340107265" width="207.4034580061328" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="2778.8099914107265" width="221.26171911453125" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="2796.4017488107265" width="211.47647131179687" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="2813.9935062107265" width="245.69979894851562" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="2849.1770210107265" width="291.848572141875" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="2866.7687784107266" width="429.8228153059375" height="22.86928462"/><rect fill="white" stroke="none" x="691.1839779336811" y="2884.3605358107266" width="236.70193517898437" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="2741.8673008707265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Load sign-in</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="673.4433622712202" y="2741.8673008707265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">24 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="2777.0508156707265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UserAuthHeader1{new_nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="2794.6425730707265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DeviceAuthHeader1{new_nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="2812.2343304707265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> UserAuthHeader2{new_nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="2829.8260878707265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> DeviceAuthHeader2{new_nonce} ... </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="2865.0096026707265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-BindingInfo: KeyId, PublicKey, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="2882.6013600707265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">array of binding statements [BindingStatement1 {extraClaims....}, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.8227415436811" y="2900.1931174707265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BindingStatement2 {extraCalims...}]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 2907.2298204307267 L 611.148569640263 2907.2298204307267" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(608.949599965263,2907.2298204307267) translate(-608.949599965263,-2907.2298204307267)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.021401608552 2900.5061616000553 L 610.5976152050855 2907.2298204307267 L 624.021401608552 2913.953479261398" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="846.8245876748921" y="3007.502837610726" width="118.54161108230468" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="849.463351284892" y="3023.335419270726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sign in ceremony</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="829.0839720124311" y="3023.335419270726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">25 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 608.949599965263 3030.3721222307263 L 1180.6628375193648 3030.3721222307263" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,3030.3721222307263) translate(-1182.8618071943647,-3030.3721222307263)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1167.7900055510756 3023.648463400055 L 1181.213791954542 3030.3721222307263 L 1167.7900055510756 3037.0957810613977" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="870.4430416543843" y="3056.759758330726" width="71.30470312332031" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="873.0818052643842" y="3072.592339990726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sign done</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="852.7024259919233" y="3072.592339990726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">26 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 3079.629042950726 L 611.148569640263 3079.629042950726" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(608.949599965263,3079.629042950726) translate(-608.949599965263,-3079.629042950726)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.021401608552 3072.905384120055 L 610.5976152050855 3079.629042950726 L 624.021401608552 3086.3527017813976" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="819.9240978677632" y="3132.404315150726" width="172.3425906965625" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="822.5628614777631" y="3148.2368968107257" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization code, KeyId</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="802.1834822053022" y="3148.2368968107257" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">27 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 608.949599965263 3155.273599770726 L 1180.6628375193648 3155.273599770726" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,3155.273599770726) translate(-1182.8618071943647,-3155.273599770726)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1167.7900055510756 3148.5499409400545 L 1181.213791954542 3155.273599770726 L 1167.7900055510756 3161.9972586013973" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 55.64016705142187 3181.6612358707257 L 1182.8618071943647 3181.6612358707257 L 1198.6943888543647 3197.4938175307257 L 1198.6943888543647 3222.122277890726 L 55.64016705142187 3222.122277890726 L 55.64016705142187 3181.6612358707257 M 1182.8618071943647 3181.6612358707257 L 1182.8618071943647 3197.4938175307257 L 1198.6943888543647 3197.4938175307257" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="284.6549030749635" y="3206.289696230726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Since DBSC session has been initialized already for RP, browser needs to generate JWT on redirect back</text></g><g><rect fill="white" stroke="none" x="1261.1518570195533" y="3248.5099139907256" width="355.6353153059375" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1263.7906206295534" y="3264.3424956507256" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Request Sign JWT (path, RPChallenge, extraParams)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1243.4112413570924" y="3264.3424956507256" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">28 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 3271.379198610726 L 1672.4988732032189 3271.379198610726" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1674.6978428782188,3271.379198610726) translate(-1674.6978428782188,-3271.379198610726)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1659.6260412349297 3264.6555397800544 L 1673.0498276383962 3271.379198610726 L 1659.6260412349297 3278.102857441397" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1363.8182464848853" y="3297.7668347107256" width="150.30253637527343" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1366.4570100948854" y="3313.5994163707255" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return JWT Signature</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1346.0776308224245" y="3313.5994163707255" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">29 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1674.6978428782188 3320.6361193307257 L 1185.0607768693646 3320.6361193307257" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,3320.6361193307257) translate(-1182.8618071943647,-3320.6361193307257)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1197.9336088376538 3313.9124605000543 L 1184.5098224341873 3320.6361193307257 L 1197.9336088376538 3327.359778161397" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 55.64016705142187 3347.0237554307255 L 1182.8618071943647 3347.0237554307255 L 1198.6943888543647 3362.8563370907254 L 1198.6943888543647 3387.4847974507256 L 55.64016705142187 3387.4847974507256 L 55.64016705142187 3347.0237554307255 M 1182.8618071943647 3347.0237554307255 L 1182.8618071943647 3362.8563370907254 L 1198.6943888543647 3362.8563370907254" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="340.7464786975221" y="3371.6522157907257" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">JWT is appended by the browser before returning the response from IDP back to the RP</text></g><g><rect fill="white" stroke="none" x="532.0518145137918" y="3413.8724335507254" width="210.61030615066406" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="534.6905781237917" y="3429.7050152107254" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization code, KeyId, JWT</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="514.3111988513308" y="3429.7050152107254" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">30 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 3436.7417181707256 L 73.67171838642187 3436.7417181707256" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(71.47274871142187,3436.7417181707256) translate(-71.47274871142187,-3436.7417181707256)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 86.54455035471084 3430.018059340054 L 73.12076395124438 3436.7417181707256 L 86.54455035471084 3443.465377001397" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="171.3341294783424" y="3463.1293542707253" width="358.13348425125" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="173.9728930883424" y="3478.9619359307253" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(confidential client request) redeem authorization code</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="153.59351381588147" y="3478.9619359307253" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">31 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 71.47274871142187 3485.9986388907255 L 606.7506302902631 3485.9986388907255" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(608.949599965263,3485.9986388907255) translate(-608.949599965263,-3485.9986388907255)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 593.8777983219741 3479.274980060054 L 607.3015847254405 3485.9986388907255 L 593.8777983219741 3492.722297721397" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="203.52452864826427" y="3512.3862749907253" width="293.7526859114063" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="206.16329225826428" y="3528.2188566507252" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(confidential client response) return id_token</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="185.78391298580334" y="3528.2188566507252" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">32 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 608.949599965263 3535.2555596107254 L 73.67171838642187 3535.2555596107254" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(71.47274871142187,3535.2555596107254) translate(-71.47274871142187,-3535.2555596107254)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 86.54455035471084 3528.531900780054 L 73.12076395124438 3535.2555596107254 L 86.54455035471084 3541.979218441397" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="112.66904090721614" y="3561.6431957107256" width="490.1233524153125" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="115.30780451721614" y="3577.4757773707256" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">parse id_token and validate binding, match with the JWT from the previous</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="94.9284252447552" y="3577.4757773707256" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">33 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 71.47274871142187 3584.5124803307253 L 141.83977831142187 3584.5124803307253 L 141.83977831142187 3607.3817649507255 L 73.67171838642187 3607.3817649507255" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(71.47274871142187,3607.3817649507255) translate(-71.47274871142187,-3607.3817649507255)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 86.54455035471084 3600.658106120054 L 73.12076395124438 3607.3817649507255 L 86.54455035471084 3614.105423781397" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="573.590808349241" y="3633.7694010507253" width="127.53231847976562" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="576.229571959241" y="3649.601982710725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bound AuthCookie</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="555.85019268678" y="3649.601982710725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">34 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 71.47274871142187 3656.6386856707254 L 1180.6628375193648 3656.6386856707254" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,3656.6386856707254) translate(-1182.8618071943647,-3656.6386856707254)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1167.7900055510756 3649.915026840054 L 1181.213791954542 3656.6386856707254 L 1167.7900055510756 3663.362344501397" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 55.64016705142187 3683.026321770725 L 1674.6978428782188 3683.026321770725 L 1690.5304245382188 3698.858903430725 L 1690.5304245382188 3723.4873637907253 L 55.64016705142187 3723.4873637907253 L 55.64016705142187 3683.026321770725 M 1674.6978428782188 3683.026321770725 L 1674.6978428782188 3698.858903430725 L 1690.5304245382188 3698.858903430725" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="818.9084998353476" y="3707.6547821307254" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Refresh DBSC...</text></g><g><rect fill="white" stroke="none" x="504.7719530635964" y="3749.874999890725" width="265.1700443098438" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="507.4107166735964" y="3765.707581550725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh (sessionID)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="487.0313374011355" y="3765.707581550725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">35 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 3772.7442845107253 L 73.67171838642187 3772.7442845107253" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(71.47274871142187,3772.7442845107253) translate(-71.47274871142187,-3772.7442845107253)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 86.54455035471084 3766.020625680054 L 73.12076395124438 3772.7442845107253 L 86.54455035471084 3779.4679433413967" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="553.6230272823465" y="3799.131920610725" width="79.44357336257812" height="22.86928462"/><rect fill="white" stroke="none" x="553.6230272823465" y="3799.131920610725" width="93.30183447097656" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="556.2617908923464" y="3814.964502270725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Challenge, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="630.4278370349246" y="3814.964502270725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">extraParams</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="535.8824116198855" y="3814.964502270725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">36 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 71.47274871142187 3822.001205230725 L 1180.6628375193648 3822.001205230725" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,3822.001205230725) translate(-1182.8618071943647,-3822.001205230725)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1167.7900055510756 3815.277546400054 L 1181.213791954542 3822.001205230725 L 1167.7900055510756 3828.7248640613966" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1240.7724777470924" y="3848.388841330725" width="303.4878543684375" height="22.86928462"/><rect fill="white" stroke="none" x="1240.7724777470924" y="3848.388841330725" width="93.30183447097656" height="22.86928462"/><rect fill="white" stroke="none" x="1240.7724777470924" y="3848.388841330725" width="10.159408933867187" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1243.4112413570924" y="3864.221422990725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Request Sign JWT (sessionID, RPChallenge, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1541.62156850553" y="3864.221422990725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">extraParams</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1629.6458757565065" y="3864.221422990725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1223.0318620846315" y="3864.221422990725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">37 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 3871.258125950725 L 1672.4988732032189 3871.258125950725" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1674.6978428782188,3871.258125950725) translate(-1674.6978428782188,-3871.258125950725)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1659.6260412349297 3864.5344671200537 L 1673.0498276383962 3871.258125950725 L 1659.6260412349297 3877.9817847813965" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="1363.8182464848853" y="3897.645762050725" width="150.30253637527343" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1366.4570100948854" y="3913.478343710725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return JWT Signature</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1346.0776308224245" y="3913.478343710725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">38 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1674.6978428782188 3920.515046670725 L 1185.0607768693646 3920.515046670725" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,3920.515046670725) translate(-1182.8618071943647,-3920.515046670725)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1197.9336088376538 3913.7913878400536 L 1184.5098224341873 3920.515046670725 L 1197.9336088376538 3927.2387055013965" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="521.8943438106668" y="3946.902682770725" width="230.92524755691406" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="524.5331074206667" y="3962.735264430725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh (JWT)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="504.1537281482058" y="3962.735264430725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">39 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1182.8618071943647 3969.771967390725 L 73.67171838642187 3969.771967390725" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(71.47274871142187,3969.771967390725) translate(-71.47274871142187,-3969.771967390725)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 86.54455035471084 3963.0483085600536 L 73.12076395124438 3969.771967390725 L 86.54455035471084 3976.4956262213964" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="112.66904090721614" y="3996.159603490725" width="228.24807775710937" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="115.30780451721614" y="4011.992185150725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate JWT (w/public key on file)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="94.9284252447552" y="4011.992185150725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">40 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 71.47274871142187 4019.028888110725 L 141.83977831142187 4019.028888110725 L 141.83977831142187 4041.898172730725 L 73.67171838642187 4041.898172730725" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(71.47274871142187,4041.898172730725) translate(-71.47274871142187,-4041.898172730725)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 86.54455035471084 4035.1745139000536 L 73.12076395124438 4041.898172730725 L 86.54455035471084 4048.6218315613964" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><rect fill="white" stroke="none" x="596.8227266842019" y="4068.285808830725" width="81.06848180984375" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="599.4614902942019" y="4084.118390490725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthCookie</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="579.082111021741" y="4084.118390490725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">41 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 71.47274871142187 4091.155093450725 L 1180.6628375193648 4091.155093450725" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1182.8618071943647,4091.155093450725) translate(-1182.8618071943647,-4091.155093450725)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1167.7900055510756 4084.4314346200536 L 1181.213791954542 4091.155093450725 L 1167.7900055510756 4097.878752281396" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 529.786691665263 616.7830069507272 L 2023.3384424988567 616.7830069507272 L 2023.3384424988567 2933.6174565307265 L 529.786691665263 2933.6174565307265 L 529.786691665263 616.7830069507272 Z" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 529.786691665263 616.7830069507272 L 529.786691665263 637.8931158307272 L 578.6590034623333 637.8931158307272 L 589.2140579023334 627.3380613907273 L 589.2140579023334 616.7830069507272 L 529.786691665263 616.7830069507272" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="547.378449065263" y="630.8564128707272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="604.1670516923334" y="618.1903475427273" width="238.01585424636718" height="18.295427696"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="606.8058153023334" y="630.8564128707272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Cached HelperId present (99.99% cases)]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 529.786691665263 1751.451359250727 L 2023.338442498857 1751.451359250727" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray="4.39793935"/></g><g/><g><rect fill="white" stroke="none" x="604.1670516923334" y="1752.858699842727" width="168.23156774734375" height="18.295427696"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="606.8058153023334" y="1765.524765170727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[No cached HelperId present]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1613.1266919782188 857.7900833307272 L 1997.5935021154585 857.7900833307272 L 1997.5935021154585 977.4140336507271 L 1613.1266919782188 977.4140336507271 L 1613.1266919782188 857.7900833307272 Z" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1613.1266919782188 857.7900833307272 L 1613.1266919782188 878.9001922107271 L 1673.0646013094688 878.9001922107271 L 1683.6196557494688 868.3451377707272 L 1683.6196557494688 857.7900833307272 L 1613.1266919782188 857.7900833307272" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1630.7184493782188" y="871.8634892507272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">loop</text><g><rect fill="white" stroke="none" x="1698.5726495394688" y="859.1974239227272" width="101.75782812332031" height="18.295427696"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1701.2114131494689" y="871.8634892507272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[For each device]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 547.378449065263 1385.5428053307269 L 1244.4329580943647 1385.5428053307269 L 1244.4329580943647 1725.063723150727 L 547.378449065263 1725.063723150727 L 547.378449065263 1385.5428053307269 Z" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 547.378449065263 1385.5428053307269 L 547.378449065263 1406.652914210727 L 600.7984293193646 1406.652914210727 L 611.3534837593646 1396.097859770727 L 611.3534837593646 1385.5428053307269 L 547.378449065263 1385.5428053307269" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="564.970206465263" y="1399.616211250727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">opt</text><g><rect fill="white" stroke="none" x="626.3064775493647" y="1386.950145922727" width="90.66931188796875" height="18.295427696"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="628.9452411593646" y="1399.616211250727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[nonce is stale]</text></g><g/><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1613.1266919782188 2423.4564919307268 L 2005.746685098857 2423.4564919307268 L 2005.746685098857 2543.0804422507267 L 1613.1266919782188 2543.0804422507267 L 1613.1266919782188 2423.4564919307268 Z" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1613.1266919782188 2423.4564919307268 L 1613.1266919782188 2444.566600810727 L 1673.0646013094688 2444.566600810727 L 1683.6196557494688 2434.0115463707266 L 1683.6196557494688 2423.4564919307268 L 1613.1266919782188 2423.4564919307268" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1630.7184493782188" y="2437.5298978507267" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">loop</text><g><rect fill="white" stroke="none" x="1698.5726495394688" y="2424.8638325227266" width="101.75782812332031" height="18.295427696"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1701.2114131494689" y="2437.5298978507267" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[For each device]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 547.378449065263 2960.0050926307263 L 1244.4329580943647 2960.0050926307263 L 1244.4329580943647 3106.016679050726 L 547.378449065263 3106.016679050726 L 547.378449065263 2960.0050926307263 Z" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 547.378449065263 2960.0050926307263 L 547.378449065263 2981.1152015107264 L 600.7984293193646 2981.1152015107264 L 611.3534837593646 2970.560147070726 L 611.3534837593646 2960.0050926307263 L 547.378449065263 2960.0050926307263" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="564.970206465263" y="2974.078498550726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">opt</text><g><rect fill="white" stroke="none" x="626.3064775493647" y="2961.412433222726" width="195.5632938215625" height="18.295427696"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="628.9452411593646" y="2974.078498550726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[SSO information is not sufficient]</text></g></g></g></svg>