<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1795.0230604103804" height="3489.500997863997"><desc>%0Aparticipant%20%22%3Ccolor%3A%23blue%3EAttestation%20Service%22%20as%20s%0Aparticipant%20%22%3Ccolor%3A%23blue%3ELocalKeyHelper%20(Replaces%20TPM)%22%20as%20t%0Aparticipant%20%22Browser%22%20as%20b%0Aparticipant%20%22Server%5Cn%3Ccolor%3A%23blue%3ERP%2FIDP%22%20as%20w%0A%0Aautonumber%201%0Ab-%3Ew%3A%20%3Ccolor%3A%23blue%3E%20user%20initiates%20%3C%2Fcolor%3E%20sign-in%20flow%20%3Ccolor%3A%23blue%3E%20in%20the%20browser%20%3C%2Fcolor%3E%20%0Aw-%3Eb%3A%20%3Ccolor%3A%23blue%3E302%5CnSec-Session-GenerateKey%3A%20%5CnRPUrl%2C%20IDPUrl%2C%20challenge%3Dnonce%2C%20extraParams...%5Cn%5CnSec-Session-HelperIdList%3A%20%5Cn%5BHelperId1%2C%20HelperId2%2C%20..%5D%2C%20HelperCacheTime%0Anote%20over%20b%3A%3Ccolor%3A%23blue%3Ebrowser%20invokes%20local%20key%20helper%20%5Cnto%20pre-generate%20keys%20%20based%20on%20DBSC(E)%20headers%5Cn%5Cn%3Ccolor%3A%23blue%3EcurrentHelperId%3D%5Cnevaluate%20policy%20for%20%5Cn(Server%7BIDPUrl%2C%20RPUrl%7D%2C%20%5BHelperId1%2C%20HelperId2...%5D)%0Ab-%3Et%3A%20request%20create%20keypair%20%5Cn%3Ccolor%3A%23blue%3E(serverUrl%7BIDPUrl%2C%20RPUrl%7D%2C%20challenge%2C%20extraParams%3F)%5Cn%20pre%20generates%20key%20and%20attestation%0At-%3Et%3A%20%3Ccolor%3A%23blue%3EgenerateKey()%0Anote%20over%20t%3A%20For%20Enterprise%2C%20this%20call%20will%20be%20platform%5Cnbased%20%26%20generates%20device%20attestation%0At-%3Es%3A%20%3Ccolor%3A%23blue%3EgenerateBindingStatement%5Cn(publicKey%2C%20AIK%2C%20challenge)%0As-%3Et%3A%20%3Ccolor%3A%23blue%3EBindingStatement%5Cn%7Bchallenge%2C%20thumbprint(publicKey)%2C%20extraClaims%7D%0At-%3Eb%3A%20return%20public%20key%20%3Ccolor%3A%23blue%3E(KeyId)%20%26%5Cn%3Ccolor%3A%23blue%3EBindingStatement%5Cn%7Bchallenge%2C%20thumbprint(publicKey)%2C%20extraClaims%3F..%7D%0Anote%20over%20b%3A%20%3Ccolor%3A%23blue%3ECache%20the%20key%20for%20server%0Ab-%3Ew%3A%20%3Ccolor%3A%23blue%3ELoad%20sign-in%5CnSec-Session-Keys%3A%20KeyId%2C%5CnBinding%20Statement%5Cn%7Bchallenge%2C%20thumbprint(publicKey)%2C%20extraClaims...%7D%0Aw-%3Ew%3A%20%3Ccolor%3A%23blue%3Evalidate%20signature%20on%20the%20%5Cnbinding%20statement%20and%20challenge%5Cnstore%20thumbprint%2C%20KeyId%0Aw-%3Eb%3A%20200%20w%2Fsigned-in%20content%2C%20response%20includes%20header%20to%20start%20secure%20session.%20%20%5CnHeader%3A%20%22%22Sec-Session-Registration%3A%20session_identifier%3D...%2C%20challenge%3D...%22%22%2C%5Cn%3Ccolor%3A%23blue%3EKeyId%2C%20extraParams%3C%2Fcolor%3E%5Cn(challenge%20required%20for%20private%20key%20proof%20of%20possession)%0Anote%20over%20b%3A%20browser%20initiates%20session%20binding%5Cnbased%20on%20header%20presence%0Anote%20over%20b%3A%20create%20JWT%20w%2Fchallenge%0Ab-%3Et%3Arequest%20sign%20JWT%20%20%5Cn%3Ccolor%3A%23blue%3E(challenge%2C%20KeyId%2C%20extraParams%3F...)%0At-%3Eb%3A%20return%20JWT%20signature%0Ab-%3Ew%3A%20POST%20%2Fsecuresession%2Fstartsession%20%5Cn%5Cn%22%22%7B%22alg%22%3A...%2C%20%22typ%22%3A%22JWT%22%2C%20...%7D%7B...%2C%22key%22%3A%22%3Cpublic_key%3E%22%7D%22%22%20%0Anote%20over%20w%3A%20store%20public%20key%2C%20establish%20session%5Cn%3Ccolor%3A%23blue%3Evalidate%20the%20JWT%5Cn%3Ccolor%3A%23blue%3Evalidate%20that%20stored%20thumbprint%20is%5Cnmatched%20to%20the%20public%20key%20in%20the%20request.%0Aw-%3Eb%3A%20200%20w%2Fcookie%20and%20session%20ID%5Cnbody%20includes%20scope%20of%20cookies%20(origin%20%2B%20path)%5Cn%5Cnheader%3A%20%22%22Set-Cookie%3A%20auth_cookie%22%22%5Cnbody%3A%20%22%22%7B%22session_identifier%22%3A...%7D%22%22%0A%3D%3DSome%20time%20passes...%3D%3D%0Anote%20over%20b%3A%20user%20clicks%20link%20for%20path%20%2Fsomecontent%0Ab-%3Eb%3A%20check%20if%20origin%2Bpath%20requires%20bound%20cookie%0Aalt%20bound%20cookie%20not%20required%0Ab-%3Ew%3A%20GET%20%2Fsomecontent%0Aw-%3Eb%3A%20200%20w%2Fcontent%0Aelse%20bound%20cookie%20required%0Ab-%3Eb%3A%20check%20if%20required%20cookies%20exist%0Aalt%20required%20cookie%20present%20and%20not%20expired%0Ab-%3Ew%3A%20GET%20%2Fsomecontent%0Aw-%3Eb%3A%20200%20w%2Fcontent%0Aelse%20required%20cookie%20missing%20or%20expired%0Anote%20over%20b%3A%20request%20deferred%20while%20we%20get%20cookies...%0Ab-%3Ew%3A%20GET%20%2Fsecuresession%2Frefresh%20%5Cnheader%3A%20%22%22Sec-Session-Id%3A%20%5Bsession%20ID%5D%22%22%0Aw-%3Eb%3A401%5Cn%5CnHeader%3A%20%22%22Sec-Session-Challenge%3A%20session_identifier%3D...%2C%20challenge%3D...%22%22%5Cn%3Ccolor%3A%23blue%3E%22extraParams%22%3A%3Ccustom..%3E%7D%22%22%20%0Anote%20over%20b%3A%20create%20JWT%20w%2Fchallenge%0Ab-%3Et%3Arequest%20sign%20JWT%5Cn%3Ccolor%3A%23blue%3E(challenge%2C%20KeyId%2C%20extraParams%3F...)%0At-%3Eb%3A%20return%20JWT%20signature%0Ab-%3Ew%3A%20GET%20%2Fsecuresession%2Frefresh%20%5Cnheader%3A%20%22%22Sec-Session-Response%3A%20%5BJWT%5D%22%22%0Anote%20over%20w%3A%20validate%20proof%20of%20possesion%0Aw-%3Eb%3A200%20w%2Fcookie%20and%20session%20ID%5Cnbody%20includes%20scope%20of%20cookies%20(origin%20%2B%20path)%5Cn%5Cnheader%3A%20%22%22Set-Cookie%3A%20auth_cookie%22%22%5Cnbody%3A%20%22%22%7B%22session_identifier%22%3A...%7D%22%22%0Anote%20over%20b%3A%20secure%20session%20established%2C%20resume%5Cnoriginal%20request%0Ab-%3Ew%3A%20GET%20%2Fsomecontent%0Aw-%3Eb%3A%20200%20w%2Fsome%20content%0Aend%0Aend</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1795" height="3489"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 88.99600310595314 76.700062264 L 88.99600310595314 3489.500997863997" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 456.95946493726825 76.700062264 L 456.95946493726825 3489.500997863997" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.8176869004193 76.700062264 L 855.8176869004193 3489.500997863997" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1539.4501855969688 76.700062264 L 1539.4501855969688 3489.500997863997" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.795878700000003 29.378234858000003 L 169.19612751190627 29.378234858000003 L 169.19612751190627 76.700062264 L 8.795878700000003 76.700062264 L 8.795878700000003 29.378234858000003 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="27.88293547900001" y="59.10830486399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Attestation Service</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 331.140169388737 29.378234858000003 L 582.7787604857995 29.378234858000003 L 582.7787604857995 76.700062264 L 331.140169388737 76.700062264 L 331.140169388737 29.378234858000003 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="350.227226167737" y="59.10830486399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">LocalKeyHelper (Replaces TPM)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 809.8480388738607 29.378234858000003 L 901.7873349269779 29.378234858000003 L 901.7873349269779 76.700062264 L 809.8480388738607 76.700062264 L 809.8480388738607 29.378234858000003 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="828.9350956528607" y="59.10830486399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Browser</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1495.9250489839844 11.786477458000004 L 1582.9753222099532 11.786477458000004 L 1582.9753222099532 76.700062264 L 1495.9250489839844 76.700062264 L 1495.9250489839844 11.786477458000004 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1517.8610818982384" y="41.51654746399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Server</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1515.0121057629844" y="59.10830486399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP/IDP</text></g></g><g><g><rect fill="white" stroke="none" x="1063.001680512229" y="111.88357706399997" width="95.72128332351562" height="22.86928462"/><rect fill="white" stroke="none" x="1063.001680512229" y="111.88357706399997" width="86.75207555984375" height="22.86928462"/><rect fill="white" stroke="none" x="1063.001680512229" y="111.88357706399997" width="105.49939001296875" height="22.86928462"/><rect fill="white" stroke="none" x="1063.001680512229" y="111.88357706399997" width="9.350540525664062" height="22.86928462"/><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1065.6404441222292" y="127.71615872399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> user initiates </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1156.0842002257448" y="127.71615872399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> sign-in flow </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1237.5587485655885" y="127.71615872399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> in the browser </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1337.7806113585573" y="127.71615872399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1053.4142478331667" y="127.71615872399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.8176869004193 134.75286168399998 L 1524.9663053376355 134.75286168399998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1539.4501855969688,134.75286168399998) translate(-1539.4501855969688,-134.75286168399998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1524.7903877636354 127.42296276733332 L 1539.4501855969688 134.75286168399998 L 1524.7903877636354 142.08276060066666 Z"/></g></g><g><rect fill="white" stroke="none" x="1044.4691029975806" y="161.140497784" width="29.737076170195312" height="22.86928462"/><rect fill="white" stroke="none" x="1044.4691029975806" y="178.732255184" width="186.98825109695312" height="22.86928462"/><rect fill="white" stroke="none" x="1044.4691029975806" y="196.324012584" width="318.5558475325" height="22.86928462"/><rect fill="white" stroke="none" x="1044.4691029975806" y="231.507527384" width="178.8278964826953" height="22.86928462"/><rect fill="white" stroke="none" x="1044.4691029975806" y="249.09928478400002" width="290.7391361067188" height="22.86928462"/><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1047.1078666075807" y="176.973079444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">302</text><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1034.8816703185182" y="176.973079444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1047.1078666075807" y="194.564836844" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-GenerateKey: </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1047.1078666075807" y="212.15659424400002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RPUrl, IDPUrl, challenge=nonce, extraParams...</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1047.1078666075807" y="247.34010904400003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-HelperIdList: </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1047.1078666075807" y="264.93186644400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[HelperId1, HelperId2, ..], HelperCacheTime</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1539.4501855969688 271.968569404 L 870.3015671597526 271.968569404" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(855.8176869004193,271.968569404) translate(-855.8176869004193,-271.968569404)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 870.4774847337526 264.63867048733334 L 855.8176869004193 271.968569404 L 870.4774847337526 279.29846832066664 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 669.0275215233295 298.356205504 L 1026.7752706175092 298.356205504 L 1042.6078522775092 314.188787164 L 1042.6078522775092 426.776034524 L 669.0275215233295 426.776034524 L 669.0275215233295 298.356205504 M 1026.7752706175092 298.356205504 L 1026.7752706175092 314.188787164 L 1042.6078522775092 314.188787164" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.6559818833294" y="322.9846658640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">browser invokes local key helper </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.6559818833294" y="340.5764232640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">to pre-generate keys  based on DBSC(E) headers</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.6559818833294" y="375.7599380640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">currentHelperId=</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.6559818833294" y="393.3516954640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">evaluate policy for </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.6559818833294" y="410.9434528640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(Server{IDPUrl, RPUrl}, [HelperId1, HelperId2...])</text></g><g><rect fill="white" stroke="none" x="490.0025741496641" y="453.163670624" width="154.3969882795703" height="22.86928462"/><rect fill="white" stroke="none" x="490.0025741496641" y="470.755428024" width="344.9981998274219" height="22.86928462"/><rect fill="white" stroke="none" x="490.0025741496641" y="488.34718542400003" width="226.9524539778125" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="492.6413377596641" y="468.99625228400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">request create keypair </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="480.4151414706016" y="468.99625228400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="492.6413377596641" y="486.58800968400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(serverUrl{IDPUrl, RPUrl}, challenge, extraParams?)</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="492.6413377596641" y="504.17976708400005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> pre generates key and attestation</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.8176869004193 511.216470044 L 471.44334519660157 511.216470044" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(456.95946493726825,511.216470044) translate(-456.95946493726825,-511.216470044)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 471.6192627706016 503.88657112733335 L 456.95946493726825 511.216470044 L 471.6192627706016 518.5463689606667 Z"/></g></g><g><rect fill="white" stroke="none" x="490.0025741496641" y="537.6041061440001" width="98.17654455398437" height="22.86928462"/><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="492.6413377596641" y="553.436687804" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">generateKey()</text><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="480.4151414706016" y="553.436687804" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 456.95946493726825 560.473390764 L 527.3264945372682 560.473390764 L 527.3264945372682 583.342675384 L 471.44334519660157 583.342675384" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(456.95946493726825,583.342675384) translate(-456.95946493726825,-583.342675384)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 471.6192627706016 576.0127764673333 L 456.95946493726825 583.342675384 L 471.6192627706016 590.6725743006667 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 306.45776696740495 609.730311484 L 591.6285812471315 609.730311484 L 607.4611629071314 625.562893144 L 607.4611629071314 667.7831109040001 L 306.45776696740495 667.7831109040001 L 306.45776696740495 609.730311484 M 591.6285812471315 609.730311484 L 591.6285812471315 625.562893144 L 607.4611629071314 625.562893144" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="331.08622732740497" y="634.3587718440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">For Enterprise, this call will be platform</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="331.08622732740497" y="651.9505292440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">based &amp; generates device attestation</text></g><g><rect fill="white" stroke="none" x="188.98611854393488" y="694.170747004" width="178.87803686355468" height="22.86928462"/><rect fill="white" stroke="none" x="188.98611854393488" y="711.762504404" width="180.20942724441406" height="22.86928462"/><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="191.6248821539349" y="710.0033286639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">generateBindingStatement</text><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="179.3986858648724" y="710.0033286639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="191.6248821539349" y="727.5950860639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(publicKey, AIK, challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 456.95946493726825 734.631789024 L 103.47988336528647 734.631789024" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(88.99600310595314,734.631789024) translate(-88.99600310595314,-734.631789024)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 103.65580093928646 727.3018901073333 L 88.99600310595314 734.631789024 L 103.65580093928646 741.9616879406667 Z"/></g></g><g><rect fill="white" stroke="none" x="122.03911231834896" y="761.0194251239999" width="121.00404394363281" height="22.86928462"/><rect fill="white" stroke="none" x="122.03911231834896" y="778.6111825239999" width="314.103454954375" height="22.86928462"/><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="124.67787592834895" y="776.8520067839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BindingStatement</text><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="112.45167963928645" y="776.8520067839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="124.67787592834895" y="794.4437641839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{challenge, thumbprint(publicKey), extraClaims}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 88.99600310595314 801.4804671439999 L 442.47558467793493 801.4804671439999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(456.95946493726825,801.4804671439999) translate(-456.95946493726825,-801.4804671439999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 442.2996671039349 794.1505682273332 L 456.95946493726825 801.4804671439999 L 442.2996671039349 808.8103660606666 Z"/></g></g><g><rect fill="white" stroke="none" x="497.3003494182188" y="827.8681032439998" width="116.90953100417968" height="22.86928462"/><rect fill="white" stroke="none" x="497.3003494182188" y="827.8681032439998" width="66.37985265945312" height="22.86928462"/><rect fill="white" stroke="none" x="497.3003494182188" y="845.4598606439998" width="121.00404394363281" height="22.86928462"/><rect fill="white" stroke="none" x="497.3003494182188" y="863.0516180439998" width="330.4026492903125" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.9391130282188" y="843.7006849039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return public key </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="611.5711168123985" y="843.7006849039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(KeyId) &amp;</text><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="487.7129167391563" y="843.7006849039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.9391130282188" y="861.2924423039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BindingStatement</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.9391130282188" y="878.8841997039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{challenge, thumbprint(publicKey), extraClaims?..}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 456.95946493726825 885.9209026639999 L 841.333806641086 885.9209026639999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(855.8176869004193,885.9209026639999) translate(-855.8176869004193,-885.9209026639999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 841.157889067086 878.5910037473332 L 855.8176869004193 885.9209026639999 L 841.157889067086 893.2508015806666 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 751.3395866478412 912.3085387639998 L 944.4632054929975 912.3085387639998 L 960.2957871529975 928.1411204239997 L 960.2957871529975 952.7695807839998 L 751.3395866478412 952.7695807839998 L 751.3395866478412 912.3085387639998 M 944.4632054929975 912.3085387639998 L 944.4632054929975 928.1411204239997 L 960.2957871529975 928.1411204239997" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="775.9680470078412" y="936.9369991239998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Cache the key for server</text></g><g><rect fill="white" stroke="none" x="1040.5857945869361" y="979.1572168839998" width="85.14863622878906" height="22.86928462"/><rect fill="white" stroke="none" x="1040.5857945869361" y="996.7489742839998" width="174.75488317703125" height="22.86928462"/><rect fill="white" stroke="none" x="1040.5857945869361" y="1014.3407316839998" width="125.07705724929687" height="22.86928462"/><rect fill="white" stroke="none" x="1040.5857945869361" y="1031.9324890839998" width="326.32247961257815" height="22.86928462"/><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1043.2245581969362" y="994.9897985439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Load sign-in</text><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1030.9983619078737" y="994.9897985439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1043.2245581969362" y="1012.5815559439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Keys: KeyId,</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1043.2245581969362" y="1030.1733133439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Binding Statement</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1043.2245581969362" y="1047.7650707439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{challenge, thumbprint(publicKey), extraClaims...}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.8176869004193 1054.8017737039997 L 1524.9663053376355 1054.8017737039997" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1539.4501855969688,1054.8017737039997) translate(-1539.4501855969688,-1054.8017737039997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1524.7903877636354 1047.471874787333 L 1539.4501855969688 1054.8017737039997 L 1524.7903877636354 1062.1316726206664 Z"/></g></g><g><rect fill="white" stroke="none" x="1572.4932948093647" y="1081.1894098039998" width="169.09277380203125" height="22.86928462"/><rect fill="white" stroke="none" x="1572.4932948093647" y="1098.7811672039998" width="216.37265051101562" height="22.86928462"/><rect fill="white" stroke="none" x="1572.4932948093647" y="1116.3729246039998" width="156.8379520246875" height="22.86928462"/><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1575.1320584193647" y="1097.0219914639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">validate signature on the </text><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1562.9058621303022" y="1097.0219914639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1575.1320584193647" y="1114.6137488639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">binding statement and challenge</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1575.1320584193647" y="1132.2055062639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">store thumbprint, KeyId</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1539.4501855969688 1139.242209224 L 1609.8172151969688 1139.242209224 L 1609.8172151969688 1162.1114938439998 L 1553.9340658563021 1162.1114938439998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1539.4501855969688,1162.1114938439998) translate(-1539.4501855969688,-1162.1114938439998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1554.1099834303022 1154.7815949273331 L 1539.4501855969688 1162.1114938439998 L 1554.1099834303022 1169.4413927606665 Z"/></g></g><g><rect fill="white" stroke="none" x="897.0139790962136" y="1188.4991299439998" width="499.1140140364063" height="22.86928462"/><rect fill="white" stroke="none" x="897.0139790962136" y="1206.0908873439998" width="61.50514257644531" height="22.86928462"/><rect fill="white" stroke="none" x="897.0139790962136" y="1206.0908873439998" width="561.3186649153125" height="22.86928462"/><rect fill="white" stroke="none" x="897.0139790962136" y="1206.0908873439998" width="9.350540525664062" height="22.86928462"/><rect fill="white" stroke="none" x="897.0139790962136" y="1223.6826447439998" width="134.01046789382812" height="22.86928462"/><rect fill="white" stroke="none" x="897.0139790962136" y="1241.2744021439999" width="363.0081790754688" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="899.6527427062135" y="1204.3317116039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/signed-in content, response includes header to start secure session.  </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="879.2733634337526" y="1204.3317116039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="899.6527427062135" y="1221.9234690039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="955.8803580626588" y="1221.9234690039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Registration: session_identifier=..., challenge=...</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1511.9214957579713" y="1221.9234690039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">,</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="899.6527427062135" y="1239.5152264039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">KeyId, extraParams</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="899.6527427062135" y="1257.1069838039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(challenge required for private key proof of possession)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1539.4501855969688 1264.1436867639998 L 870.3015671597526 1264.1436867639998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(855.8176869004193,1264.1436867639998) translate(-855.8176869004193,-1264.1436867639998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 870.4774847337526 1256.813787847333 L 855.8176869004193 1264.1436867639998 L 870.4774847337526 1271.4735856806665 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 725.663156899306 1290.5313228639998 L 970.1396352415327 1290.5313228639998 L 985.9722169015326 1306.3639045239997 L 985.9722169015326 1348.5841222839997 L 725.663156899306 1348.5841222839997 L 725.663156899306 1290.5313228639998 M 970.1396352415327 1290.5313228639998 L 970.1396352415327 1306.3639045239997 L 985.9722169015326 1306.3639045239997" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="750.291617259306" y="1315.1597832239995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">browser initiates session binding</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="750.291617259306" y="1332.7515406239995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">based on header presence</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 752.9716438377826 1374.9717583839997 L 942.8311483030561 1374.9717583839997 L 958.6637299630561 1390.8043400439997 L 958.6637299630561 1415.4328004039996 L 752.9716438377826 1415.4328004039996 L 752.9716438377826 1374.9717583839997 M 942.8311483030561 1374.9717583839997 L 942.8311483030561 1390.8043400439997 L 958.6637299630561 1390.8043400439997" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="777.6001041977826" y="1399.6002187439994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">create JWT w/challenge</text></g><g><rect fill="white" stroke="none" x="548.6496536174376" y="1441.8204365039996" width="127.48220861648437" height="22.86928462"/><rect fill="white" stroke="none" x="548.6496536174376" y="1459.4121939039997" width="235.05551183914062" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="551.2884172274375" y="1457.6530181639996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">request sign JWT  </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="531.7107499911094" y="1457.6530181639996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">11 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="551.2884172274375" y="1475.2447755639996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(challenge, KeyId, extraParams?...)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.8176869004193 1482.2814785239996 L 471.44334519660157 1482.2814785239996" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(456.95946493726825,1482.2814785239996) translate(-456.95946493726825,-1482.2814785239996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 471.6192627706016 1474.9515796073329 L 456.95946493726825 1482.2814785239996 L 471.6192627706016 1489.6113774406663 Z"/></g></g><g><rect fill="white" stroke="none" x="595.5035964885313" y="1508.6691146239996" width="142.14933813308593" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="598.1423600985313" y="1524.5016962839995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return JWT signature</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="577.7629808260704" y="1524.5016962839995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">12 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 456.95946493726825 1531.5383992439995 L 841.333806641086 1531.5383992439995" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(855.8176869004193,1531.5383992439995) translate(-855.8176869004193,-1531.5383992439995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 841.157889067086 1524.2085003273328 L 855.8176869004193 1531.5383992439995 L 841.157889067086 1538.8682981606662 Z"/></g></g><g><rect fill="white" stroke="none" x="960.4319859931862" y="1557.9260353439995" width="233.40913427566406" height="22.86928462"/><rect fill="white" stroke="none" x="960.4319859931862" y="1593.1095501439995" width="490.7102664778125" height="22.86928462"/><rect fill="white" stroke="none" x="960.4319859931862" y="1593.1095501439995" width="9.350540525664062" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="963.0707496031862" y="1573.7586170039995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /securesession/startsession </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="942.6913703307252" y="1573.7586170039995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">13 </text></g><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="963.0707496031862" y="1608.9421318039995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"alg":..., "typ":"JWT", ...}{...,"key":"&lt;public_key&gt;"}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1448.5034888609987" y="1608.9421318039995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.8176869004193 1615.9788347639994 L 1524.9663053376355 1615.9788347639994" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1539.4501855969688,1615.9788347639994) translate(-1539.4501855969688,-1615.9788347639994)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1524.7903877636354 1608.6489358473327 L 1539.4501855969688 1615.9788347639994 L 1524.7903877636354 1623.3087336806661 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1383.2111829396056 1642.3664708639994 L 1679.856606594332 1642.3664708639994 L 1695.689188254332 1658.1990525239994 L 1695.689188254332 1735.6027850839994 L 1383.2111829396056 1735.6027850839994 L 1383.2111829396056 1642.3664708639994 M 1679.856606594332 1642.3664708639994 L 1679.856606594332 1658.1990525239994 L 1695.689188254332 1658.1990525239994" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1407.8396432996055" y="1666.9949312239992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">store public key, establish session</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1407.8396432996055" y="1684.5866886239992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">validate the JWT</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1407.8396432996055" y="1702.1784460239992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">validate that stored thumbprint is</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1407.8396432996055" y="1719.7702034239992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">matched to the public key in the request.</text></g><g><rect fill="white" stroke="none" x="1056.2586690376197" y="1761.9904211839994" width="191.89163244460937" height="22.86928462"/><rect fill="white" stroke="none" x="1056.2586690376197" y="1779.5821785839994" width="303.1298831770313" height="22.86928462"/><rect fill="white" stroke="none" x="1056.2586690376197" y="1814.7656933839994" width="59.071350462187496" height="22.86928462"/><rect fill="white" stroke="none" x="1056.2586690376197" y="1814.7656933839994" width="208.2766727278125" height="22.86928462"/><rect fill="white" stroke="none" x="1056.2586690376197" y="1832.3574507839994" width="45.21308935378906" height="22.86928462"/><rect fill="white" stroke="none" x="1056.2586690376197" y="1832.3574507839994" width="234.754822141875" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1058.8974326476198" y="1777.8230028439993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/cookie and session ID</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1038.5180533751588" y="1777.8230028439993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">14 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1058.8974326476198" y="1795.4147602439994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body includes scope of cookies (origin + path)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1058.8974326476198" y="1830.5982750439994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1112.6912558898073" y="1830.5982750439994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Set-Cookie: auth_cookie</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1058.8974326476198" y="1848.1900324439994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1098.8329947814088" y="1848.1900324439994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"session_identifier":...}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1539.4501855969688 1855.2267354039993 L 870.3015671597526 1855.2267354039993" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(855.8176869004193,1855.2267354039993) translate(-855.8176869004193,-1855.2267354039993)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 870.4774847337526 1847.8968364873326 L 855.8176869004193 1855.2267354039993 L 870.4774847337526 1862.556634320666 Z"/></g></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.7958787 1895.9809733806658 L 1786.2041213 1895.9809733806658 M 8.7958787 1901.8448925139992 L 1786.2041213 1901.8448925139992 M 8.7958787 1907.7088116473326 L 1786.2041213 1907.7088116473326" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 806.4685550208594 1881.6143715039993 L 988.5314449791407 1881.6143715039993 L 988.5314449791407 1922.0754135239993 L 806.4685550208594 1922.0754135239993 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="831.0970153808594" y="1906.242831863999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Some time passes...</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 711.0067543114154 1948.4630496239993 L 984.7960378294233 1948.4630496239993 L 1000.6286194894233 1964.2956312839992 L 1000.6286194894233 1988.9240916439992 L 711.0067543114154 1988.9240916439992 L 711.0067543114154 1948.4630496239993 M 984.7960378294233 1948.4630496239993 L 984.7960378294233 1964.2956312839992 L 1000.6286194894233 1964.2956312839992" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="735.6352146714154" y="1973.091509983999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">user clicks link for path /somecontent</text></g><g><rect fill="white" stroke="none" x="897.0139790962136" y="2015.311727743999" width="280.32391393875" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="899.6527427062135" y="2031.144309403999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">check if origin+path requires bound cookie</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="879.2733634337526" y="2031.144309403999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">15 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.8176869004193 2038.1810123639991 L 926.1847165004193 2038.1810123639991 L 926.1847165004193 2061.050296983999 L 870.3015671597526 2061.050296983999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(855.8176869004193,2061.050296983999) translate(-855.8176869004193,-2061.050296983999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 870.4774847337526 2053.7203980673326 L 855.8176869004193 2061.050296983999 L 870.4774847337526 2068.3801959006655 Z"/></g></g><g><rect fill="white" stroke="none" x="1144.0753499458228" y="2134.9356780639987" width="127.49655187820312" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1146.714113555823" y="2150.7682597239987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /somecontent</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1126.334734283362" y="2150.7682597239987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">16 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.8176869004193 2157.804962683999 L 1524.9663053376355 2157.804962683999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1539.4501855969688,2157.804962683999) translate(-1539.4501855969688,-2157.804962683999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1524.7903877636354 2150.4750637673324 L 1539.4501855969688 2157.804962683999 L 1524.7903877636354 2165.1348616006653 Z"/></g></g><g><rect fill="white" stroke="none" x="1159.5442143867408" y="2184.1925987839986" width="96.55882299636718" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1162.1829779967409" y="2200.0251804439986" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/content</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1141.80359872428" y="2200.0251804439986" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">17 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1539.4501855969688 2207.0618834039988 L 870.3015671597526 2207.0618834039988" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(855.8176869004193,2207.0618834039988) translate(-855.8176869004193,-2207.0618834039988)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 870.4774847337526 2199.7319844873323 L 855.8176869004193 2207.0618834039988 L 870.4774847337526 2214.3917823206652 Z"/></g></g><g><rect fill="white" stroke="none" x="897.0139790962136" y="2280.947264483999" width="200.8321689436328" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="899.6527427062135" y="2296.779846143999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">check if required cookies exist</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="879.2733634337526" y="2296.779846143999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">18 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.8176869004193 2303.8165491039986 L 926.1847165004193 2303.8165491039986 L 926.1847165004193 2326.6858337239987 L 870.3015671597526 2326.6858337239987" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(855.8176869004193,2326.6858337239987) translate(-855.8176869004193,-2326.6858337239987)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 870.4774847337526 2319.3559348073322 L 855.8176869004193 2326.6858337239987 L 870.4774847337526 2334.015732640665 Z"/></g></g><g><rect fill="white" stroke="none" x="1144.0753499458228" y="2400.5712148039984" width="127.49655187820312" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1146.714113555823" y="2416.4037964639983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /somecontent</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1126.334734283362" y="2416.4037964639983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">19 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.8176869004193 2423.4404994239985 L 1524.9663053376355 2423.4404994239985" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1539.4501855969688,2423.4404994239985) translate(-1539.4501855969688,-2423.4404994239985)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1524.7903877636354 2416.110600507332 L 1539.4501855969688 2423.4404994239985 L 1524.7903877636354 2430.770398340665 Z"/></g></g><g><rect fill="white" stroke="none" x="1159.5442143867408" y="2449.8281355239983" width="96.55882299636718" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1162.1829779967409" y="2465.6607171839983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/content</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1141.80359872428" y="2465.6607171839983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">20 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1539.4501855969688 2472.6974201439984 L 870.3015671597526 2472.6974201439984" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(855.8176869004193,2472.6974201439984) translate(-855.8176869004193,-2472.6974201439984)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 870.4774847337526 2465.367521227332 L 855.8176869004193 2472.6974201439984 L 870.4774847337526 2480.027319060665 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 702.0303672874896 2546.582801223998 L 993.7724248533491 2546.582801223998 L 1009.605006513349 2562.415382883998 L 1009.605006513349 2587.0438432439983 L 702.0303672874896 2587.0438432439983 L 702.0303672874896 2546.582801223998 M 993.7724248533491 2546.582801223998 L 993.7724248533491 2562.415382883998 L 1009.605006513349 2562.415382883998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="726.6588276474896" y="2571.2112615839983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">request deferred while we get cookies...</text></g><g><rect fill="white" stroke="none" x="1054.7232533882056" y="2613.431479343998" width="191.03979528640625" height="22.86928462"/><rect fill="white" stroke="none" x="1054.7232533882056" y="2631.023236743998" width="59.071350462187496" height="22.86928462"/><rect fill="white" stroke="none" x="1054.7232533882056" y="2631.023236743998" width="252.40692175125" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1057.3620169982057" y="2629.264061003998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1036.9826377257448" y="2629.264061003998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">21 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1057.3620169982057" y="2646.855818403998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1111.1558402403932" y="2646.855818403998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Id: [session ID]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.8176869004193 2653.892521363998 L 1524.9663053376355 2653.892521363998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1539.4501855969688,2653.892521363998) translate(-1539.4501855969688,-2653.892521363998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1524.7903877636354 2646.5626224473317 L 1539.4501855969688 2653.892521363998 L 1524.7903877636354 2661.2224202806647 Z"/></g></g><g><rect fill="white" stroke="none" x="912.2895604560769" y="2680.280157463998" width="29.737076170195312" height="22.86928462"/><rect fill="white" stroke="none" x="912.2895604560769" y="2715.463672263998" width="61.50514257644531" height="22.86928462"/><rect fill="white" stroke="none" x="912.2895604560769" y="2715.463672263998" width="534.84051550125" height="22.86928462"/><rect fill="white" stroke="none" x="912.2895604560769" y="2733.055429663998" width="180.27389562820312" height="22.86928462"/><rect fill="white" stroke="none" x="912.2895604560769" y="2733.055429663998" width="14.1035770246875" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="914.9283240660768" y="2696.112739123998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">401</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="894.5489447936159" y="2696.112739123998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">22 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="914.9283240660768" y="2731.296253923998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="971.1559394225221" y="2731.296253923998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Challenge: session_identifier=..., challenge=...</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="914.9283240660768" y="2748.888011323998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"extraParams":&lt;custom..&gt;}</text><text fill="blue" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1089.92469247428" y="2748.888011323998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1539.4501855969688 2755.924714283998 L 870.3015671597526 2755.924714283998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(855.8176869004193,2755.924714283998) translate(-855.8176869004193,-2755.924714283998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 870.4774847337526 2748.5948153673316 L 855.8176869004193 2755.924714283998 L 870.4774847337526 2763.2546132006646 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 752.9716438377826 2782.312350383998 L 942.8311483030561 2782.312350383998 L 958.6637299630561 2798.144932043998 L 958.6637299630561 2822.773392403998 L 752.9716438377826 2822.773392403998 L 752.9716438377826 2782.312350383998 M 942.8311483030561 2782.312350383998 L 942.8311483030561 2798.144932043998 L 958.6637299630561 2798.144932043998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="777.6001041977826" y="2806.940810743998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">create JWT w/challenge</text></g><g><rect fill="white" stroke="none" x="549.050509635504" y="2849.161028503998" width="119.33618200515625" height="22.86928462"/><rect fill="white" stroke="none" x="549.050509635504" y="2866.752785903998" width="235.05551183914062" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="551.689273245504" y="2864.993610163998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">request sign JWT</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="531.309893973043" y="2864.993610163998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">23 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="551.689273245504" y="2882.585367563998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(challenge, KeyId, extraParams?...)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.8176869004193 2889.622070523998 L 471.44334519660157 2889.622070523998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(456.95946493726825,2889.622070523998) translate(-456.95946493726825,-2889.622070523998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 471.6192627706016 2882.2921716073315 L 456.95946493726825 2889.622070523998 L 471.6192627706016 2896.9519694406645 Z"/></g></g><g><rect fill="white" stroke="none" x="595.5035964885313" y="2916.0097066239978" width="142.14933813308593" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="598.1423600985313" y="2931.8422882839977" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return JWT signature</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="577.7629808260704" y="2931.8422882839977" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">24 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 456.95946493726825 2938.878991243998 L 841.333806641086 2938.878991243998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(855.8176869004193,2938.878991243998) translate(-855.8176869004193,-2938.878991243998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 841.157889067086 2931.5490923273314 L 855.8176869004193 2938.878991243998 L 841.157889067086 2946.2088901606644 Z"/></g></g><g><rect fill="white" stroke="none" x="1059.1362782905494" y="2965.2666273439977" width="191.03979528640625" height="22.86928462"/><rect fill="white" stroke="none" x="1059.1362782905494" y="2982.8583847439977" width="59.071350462187496" height="22.86928462"/><rect fill="white" stroke="none" x="1059.1362782905494" y="2982.8583847439977" width="243.5808719465625" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1061.7750419005495" y="2981.0992090039977" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1041.3956626280885" y="2981.0992090039977" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">25 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1061.7750419005495" y="2998.6909664039977" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1115.568865142737" y="2998.6909664039977" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Response: [JWT]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.8176869004193 3005.727669363998 L 1524.9663053376355 3005.727669363998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1539.4501855969688,3005.727669363998) translate(-1539.4501855969688,-3005.727669363998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1524.7903877636354 2998.3977704473314 L 1539.4501855969688 3005.727669363998 L 1524.7903877636354 3013.0575682806643 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1427.6206220265196 3032.1153054639976 L 1635.447167507418 3032.1153054639976 L 1651.279749167418 3047.9478871239976 L 1651.279749167418 3072.576347483998 L 1427.6206220265196 3072.576347483998 L 1427.6206220265196 3032.1153054639976 M 1635.447167507418 3032.1153054639976 L 1635.447167507418 3047.9478871239976 L 1651.279749167418 3047.9478871239976" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1452.2490823865196" y="3056.743765823998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">validate proof of possesion</text></g><g><rect fill="white" stroke="none" x="1056.2586690376197" y="3098.9639835839976" width="191.89163244460937" height="22.86928462"/><rect fill="white" stroke="none" x="1056.2586690376197" y="3116.5557409839976" width="303.1298831770313" height="22.86928462"/><rect fill="white" stroke="none" x="1056.2586690376197" y="3151.7392557839976" width="59.071350462187496" height="22.86928462"/><rect fill="white" stroke="none" x="1056.2586690376197" y="3151.7392557839976" width="208.2766727278125" height="22.86928462"/><rect fill="white" stroke="none" x="1056.2586690376197" y="3169.3310131839976" width="45.21308935378906" height="22.86928462"/><rect fill="white" stroke="none" x="1056.2586690376197" y="3169.3310131839976" width="234.754822141875" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1058.8974326476198" y="3114.7965652439975" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/cookie and session ID</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1038.5180533751588" y="3114.7965652439975" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">26 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1058.8974326476198" y="3132.3883226439975" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body includes scope of cookies (origin + path)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1058.8974326476198" y="3167.5718374439975" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1112.6912558898073" y="3167.5718374439975" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Set-Cookie: auth_cookie</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1058.8974326476198" y="3185.1635948439975" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1098.8329947814088" y="3185.1635948439975" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"session_identifier":...}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1539.4501855969688 3192.2002978039977 L 870.3015671597526 3192.2002978039977" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(855.8176869004193,3192.2002978039977) translate(-855.8176869004193,-3192.2002978039977)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 870.4774847337526 3184.8703988873312 L 855.8176869004193 3192.2002978039977 L 870.4774847337526 3199.530196720664 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 714.6645912254779 3218.5879339039975 L 981.1382009153608 3218.5879339039975 L 996.9707825753608 3234.4205155639975 L 996.9707825753608 3276.6407333239977 L 714.6645912254779 3276.6407333239977 L 714.6645912254779 3218.5879339039975 M 981.1382009153608 3218.5879339039975 L 981.1382009153608 3234.4205155639975 L 996.9707825753608 3234.4205155639975" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="739.2930515854779" y="3243.2163942639977" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">secure session established, resume</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="739.2930515854779" y="3260.8081516639977" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">original request</text></g><g><rect fill="white" stroke="none" x="1144.0753499458228" y="3303.0283694239974" width="127.49655187820312" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1146.714113555823" y="3318.8609510839974" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /somecontent</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1126.334734283362" y="3318.8609510839974" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">27 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.8176869004193 3325.8976540439976 L 1524.9663053376355 3325.8976540439976" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1539.4501855969688,3325.8976540439976) translate(-1539.4501855969688,-3325.8976540439976)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1524.7903877636354 3318.567755127331 L 1539.4501855969688 3325.8976540439976 L 1524.7903877636354 3333.227552960664 Z"/></g></g><g><rect fill="white" stroke="none" x="1139.5835896919166" y="3352.2852901439974" width="136.48007238601562" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1142.2223533019167" y="3368.1178718039973" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/some content</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1121.8429740294557" y="3368.1178718039973" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">28 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1539.4501855969688 3375.1545747639975 L 870.3015671597526 3375.1545747639975" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(855.8176869004193,3375.1545747639975) translate(-855.8176869004193,-3375.1545747639975)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 870.4774847337526 3367.824675847331 L 855.8176869004193 3375.1545747639975 L 870.4774847337526 3382.484473680664 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 377.7965566372683 2087.437933083999 L 1677.667385267418 2087.437933083999 L 1677.667385267418 3427.929846963997 L 377.7965566372683 3427.929846963997 L 377.7965566372683 2087.437933083999 Z" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 377.7965566372683 2087.437933083999 L 377.7965566372683 2108.548041963999 L 426.6688684343386 2108.548041963999 L 437.2239228743386 2097.9929875239986 L 437.2239228743386 2087.437933083999 L 377.7965566372683 2087.437933083999" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="395.3883140372683" y="2101.5113390039987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="452.1769166643386" y="2088.8452736759987" width="161.02058447097656" height="18.295427696"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="454.8156802743386" y="2101.5113390039987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[bound cookie not required]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 377.7965566372683 2233.4495195039985 L 1677.667385267418 2233.4495195039985" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray="4.39793935"/></g><g/><g><rect fill="white" stroke="none" x="452.1769166643386" y="2234.8568600959984" width="139.5251621076953" height="18.295427696"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="454.8156802743386" y="2247.5229254239985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[bound cookie required]</text></g><g/><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 395.3883140372683 2353.0734698239985 L 1660.075627867418 2353.0734698239985 L 1660.075627867418 3401.5422108639973 L 395.3883140372683 3401.5422108639973 L 395.3883140372683 2353.0734698239985 Z" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 395.3883140372683 2353.0734698239985 L 395.3883140372683 2374.1835787039986 L 444.2606258343386 2374.1835787039986 L 454.8156802743386 2363.6285242639983 L 454.8156802743386 2353.0734698239985 L 395.3883140372683 2353.0734698239985" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="412.9800714372683" y="2367.1468757439984" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="469.7686740643386" y="2354.4808104159983" width="236.66410864089843" height="18.295427696"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="472.4074376743386" y="2367.1468757439984" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[required cookie present and not expired]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 395.3883140372683 2499.085056243998 L 1660.075627867418 2499.085056243998" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray="4.39793935"/></g><g/><g><rect fill="white" stroke="none" x="469.7686740643386" y="2500.492396835998" width="207.99778784011718" height="18.295427696"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="472.4074376743386" y="2513.158462163998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[required cookie missing or expired]</text></g><g/></g></g></svg>