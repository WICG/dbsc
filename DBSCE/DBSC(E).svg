<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1717.8271165375963" height="3207.5805199879987"><desc>%0Aparticipant%20%22%3Ccolor%3A%23blue%3EAttestation%20Service%22%20as%20s%0Aparticipant%20%22%3Ccolor%3A%23blue%3ELocalKeyHelper%2FTPM%22%20as%20t%0Aparticipant%20%22Browser%22%20as%20b%0Aparticipant%20%22Server%5Cn%3Ccolor%3A%23blue%3ERP%2FIDP%22%20as%20w%0A%0Aautonumber%201%0Ab-%3Ew%3A%20%3Ccolor%3A%23blue%3E%20initiate%20%3C%2Fcolor%3E%20sign-in%20flow%20%0Aw-%3Eb%3A%20%3Ccolor%3A%23blue%3E302%5CnSec-Session-GenerateKey%3A%20%5CnRPUrl%2C%20IDPUrl%2C%20challenge%3Dnonce%2C%20extraParams...%5Cn%5CnSec-Session-HelperIdList%3A%20%5Cn%5BHelperId1%2C%20HelperId2%2C%20..%5D%2C%20HelperCacheTime%0Anote%20over%20b%3A%3Ccolor%3A%23blue%3Ebrowser%20pre-generates%20keys%5Cnbased%20on%20headers%5Cn%5Cn%3Ccolor%3A%23blue%3EcurrentHelperId%3D%5Cnevaluate%20policy%20for%20%5Cn(Server%2C%20%5BHelperId1%2C%20HelperId2...%5D)%0Ab-%3Et%3A%20request%20create%20keypair%20%5Cn%3Ccolor%3A%23blue%3E(serverUrl%2Cchallenge%2CextraParams%3F)%5Cn%20pre%20generates%20key%20and%20attestation%0At-%3Et%3A%20%3Ccolor%3A%23blue%3EgenerateKey()%0Anote%20over%20t%3A%20For%20Enterprise%2C%20this%20call%20will%20be%20platform%5Cnbased%20%26%20generates%20device%20attestation%0At-%3Es%3A%20%3Ccolor%3A%23blue%3EgenerateBindingStatement%5Cn(publicKey%2C%20AIK%2C%20challenge)%0As-%3Et%3A%20%3Ccolor%3A%23blue%3EBindingStatement%5Cn%7Bchallenge%2C%20thumbprint(publicKey)%2C%20extraClaims%7D%0At-%3Eb%3A%20return%20public%20key%20%26%5Cn%3Ccolor%3A%23blue%3EBindingStatement%5Cn%7Bchallenge%2C%20thumbprint(publicKey)%2C%20extraClaims%3F..%7D%0Anote%20over%20b%3A%20%3Ccolor%3A%23blue%3ECache%20the%20key%20for%20server%0Ab-%3Ew%3A%20%3Ccolor%3A%23blue%3ELoad%20sign-in%5CnSec-Session-Keys%3A%20KeyId%2C%5CnBinding%20Statement%5Cn%7Bchallenge%2C%20thumbprint(publicKey)%2C%20extraClaims...%7D%0Aw-%3Ew%3A%20%3Ccolor%3A%23blue%3Evalidate%20signature%20on%20the%20%5Cnbinding%20statement%20and%20challenge%5Cnstore%20thumbprint%2C%20KeyId%0Aw-%3Eb%3A%20200%20w%2Fsigned-in%20content%2C%20response%20includes%20header%20to%20start%20secure%20session.%20%20%5CnHeader%3A%20%22%22Sec-Session-Registration%3A%20session_identifier%3D...%2C%20challenge%3D...%22%22%2C%5Cn%3Ccolor%3A%23blue%3EKeyId%2C%20extraParams%3C%2Fcolor%3E%5Cn(challenge%20required%20for%20private%20key%20proof%20of%20possession)%0Anote%20over%20b%3A%20browser%20initiates%20session%20binding%5Cnbased%20on%20header%20presence%0Anote%20over%20b%3A%20create%20JWT%20w%2Fchallenge%0Ab-%3Et%3Arequest%20sign%20JWT%20%20%5Cn%3Ccolor%3A%23blue%3E(challenge%2Cpublic%20key%2C%20extraParams%3F..)%0At-%3Eb%3A%20return%20JWT%20signature%0Ab-%3Ew%3A%20POST%20%2Fsecuresession%2Fstartsession%20%5Cn%5Cn%22%22%7B%22alg%22%3A...%2C%20%22typ%22%3A%22JWT%22%2C%20...%7D%7B...%2C%22key%22%3A%22%3Cpublic_key%3E%22%7D%22%22%20%0Anote%20over%20w%3A%20store%20public%20key%2C%20establish%20session%5Cn%3Ccolor%3A%23blue%3Evalidate%20the%20JWT%0Aw-%3Eb%3A%20200%20w%2Fcookie%20and%20session%20ID%5Cnbody%20includes%20scope%20of%20cookies%20(origin%20%2B%20path)%5Cn%5Cnheader%3A%20%22%22Set-Cookie%3A%20auth_cookie%22%22%5Cnbody%3A%20%22%22%7B%22session_identifier%22%3A...%7D%22%22%0A%3D%3DSome%20time%20passes...%3D%3D%0Anote%20over%20b%3A%20user%20clicks%20link%20for%20path%20%2Fsomecontent%0Ab-%3Eb%3A%20check%20if%20origin%2Bpath%20requires%20bound%20cookie%0Aalt%20bound%20cookie%20not%20required%0Ab-%3Ew%3A%20GET%20%2Fsomecontent%0Aw-%3Eb%3A%20200%20w%2Fcontent%0Aelse%20bound%20cookie%20required%0Ab-%3Eb%3A%20check%20if%20required%20cookies%20exist%0Aalt%20required%20cookie%20present%20and%20not%20expired%0Ab-%3Ew%3A%20GET%20%2Fsomecontent%0Aw-%3Eb%3A%20200%20w%2Fcontent%0Aelse%20required%20cookie%20missing%20or%20expired%0Anote%20over%20b%3A%20request%20deferred%20while%20we%20get%20cookies...%0Ab-%3Ew%3A%20GET%20%2Fsecuresession%2Frefresh%20%5Cnheader%3A%20%22%22Sec-Session-Id%3A%20%5Bsession%20ID%5D%22%22%0Aw-%3Eb%3A401%5Cn%5CnHeader%3A%20%22%22Sec-Session-Challenge%3A%20session_identifier%3D...%2C%20challenge%3D...%22%22%5Cn%3Ccolor%3A%23blue%3E%22extraParams%22%3A%3Ccustom..%3E%7D%22%22%20%0Anote%20over%20b%3A%20create%20JWT%20w%2Fchallenge%0Ab-%3Et%3Arequest%20sign%20JWT%5Cn%3Ccolor%3A%23blue%3Echallenge%2C%20extraParams...%0At-%3Eb%3A%20return%20JWT%20signature%0Ab-%3Ew%3A%20GET%20%2Fsecuresession%2Frefresh%20%5Cnheader%3A%20%22%22Sec-Session-Response%3A%20%5BJWT%5D%22%22%0Anote%20over%20w%3A%20validate%20proof%20of%20possesion%0Aw-%3Eb%3A200%20w%2Fcookie%20and%20session%20ID%5Cnbody%20includes%20scope%20of%20cookies%20(origin%20%2B%20path)%5Cn%5Cnheader%3A%20%22%22Set-Cookie%3A%20auth_cookie%22%22%5Cnbody%3A%20%22%22%7B%22session_identifier%22%3A...%7D%22%22%0Anote%20over%20b%3A%20secure%20session%20established%2C%20resume%5Cnoriginal%20request%0Ab-%3Ew%3A%20GET%20%2Fsomecontent%0Aw-%3Eb%3A%20200%20w%2Fsome%20content%0Aend%0Aend</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1717" height="3207"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 87.00436485745313 71.22148638799999 L 87.00436485745313 3207.5805199879987" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 451.6170157554349 71.22148638799999 L 451.6170157554349 3207.5805199879987" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 832.5288762481432 71.22148638799999 L 832.5288762481432 3207.5805199879987" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1464.5579242408517 71.22148638799999 L 1464.5579242408517 3207.5805199879987" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.167601649999995 27.279789510999997 L 165.84112806490626 27.279789510999997 L 165.84112806490626 71.22148638799999 L 8.167601649999995 71.22148638799999 L 8.167601649999995 27.279789510999997 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.8912972305" y="54.886283088" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Attestation Service</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 364.6377964932943 27.279789510999997 L 538.5962350175755 27.279789510999997 L 538.5962350175755 71.22148638799999 L 364.6377964932943 71.22148638799999 L 364.6377964932943 27.279789510999997 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="382.3614920737943" y="54.886283088" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">LocalKeyHelper/TPM</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 787.9225894200846 27.279789510999997 L 877.1351630762018 27.279789510999997 L 877.1351630762018 71.22148638799999 L 787.9225894200846 71.22148638799999 L 787.9225894200846 27.279789510999997 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="805.6462850005846" y="54.886283088" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Browser</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1422.3961488263674 10.944586210999995 L 1506.7196996553362 10.944586210999995 L 1506.7196996553362 71.22148638799999 L 1422.3961488263674 71.22148638799999 L 1422.3961488263674 10.944586210999995 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1442.9688205421212" y="38.551079787999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Server</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1440.1198444068673" y="54.886283088" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP/IDP</text></g></g><g><g><rect fill="white" stroke="none" x="1086.2076827377787" y="103.891892988" width="55.42308296265625" height="21.23576429"/><rect fill="white" stroke="none" x="1086.2076827377787" y="103.891892988" width="86.37510932984375" height="21.23576429"/><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1088.6579632327787" y="118.593575958" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> initiate </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1139.180485205435" y="118.593575958" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> sign-in flow </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1076.4317669437162" y="118.593575958" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 832.5288762481432 125.12765727799999 L 1451.108606857185 125.12765727799999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1464.5579242408517,125.12765727799999) translate(-1464.5579242408517,-125.12765727799999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1450.945254824185 118.32132256966665 L 1464.5579242408517 125.12765727799999 L 1450.945254824185 131.93399198633333 Z"/></g></g><g><rect fill="white" stroke="none" x="995.5670501083841" y="149.630462228" width="29.36010994019531" height="21.23576429"/><rect fill="white" stroke="none" x="995.5670501083841" y="165.965665528" width="186.61128486695313" height="21.23576429"/><rect fill="white" stroke="none" x="995.5670501083841" y="182.30086882799998" width="318.1788813025" height="21.23576429"/><rect fill="white" stroke="none" x="995.5670501083841" y="214.97127542799996" width="178.45093025269531" height="21.23576429"/><rect fill="white" stroke="none" x="995.5670501083841" y="231.30647872799995" width="290.3550287634375" height="21.23576429"/><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="998.0173306033842" y="164.33214519799998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">302</text><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="985.7911343143217" y="164.33214519799998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="998.0173306033842" y="180.66734849799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-GenerateKey: </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="998.0173306033842" y="197.00255179799996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RPUrl, IDPUrl, challenge=nonce, extraParams...</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="998.0173306033842" y="229.67295839799993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-HelperIdList: </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="998.0173306033842" y="246.00816169799992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[HelperId1, HelperId2, ..], HelperCacheTime</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1464.5579242408517 252.542243018 L 845.9781936318099 252.542243018" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(832.5288762481432,252.542243018) translate(-832.5288762481432,-252.542243018)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 846.1415456648099 245.73590830966666 L 832.5288762481432 252.542243018 L 846.1415456648099 259.3485777263333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 701.6997298727722 277.045047968 L 948.6563396535145 277.045047968 L 963.3580226235144 291.746730938 L 963.3580226235144 396.292032058 L 701.6997298727722 396.292032058 L 701.6997298727722 277.045047968 M 948.6563396535145 277.045047968 L 948.6563396535145 291.746730938 L 963.3580226235144 291.746730938" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="724.5690144927721" y="299.914332588" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">browser pre-generates keys</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="724.5690144927721" y="316.24953588799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">based on headers</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="724.5690144927721" y="348.91994248799995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">currentHelperId=</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="724.5690144927721" y="365.25514578799994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">evaluate policy for </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="724.5690144927721" y="381.5903490879999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(Server, [HelperId1, HelperId2...])</text></g><g><rect fill="white" stroke="none" x="530.0450669350117" y="420.794837008" width="154.02002204957031" height="21.23576429"/><rect fill="white" stroke="none" x="530.0450669350117" y="437.130040308" width="236.2819544226172" height="21.23576429"/><rect fill="white" stroke="none" x="530.0450669350117" y="453.465243608" width="226.5754877478125" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="532.4953474300117" y="435.496519978" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">request create keypair </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="520.2691511409492" y="435.496519978" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="532.4953474300117" y="451.83172327799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(serverUrl,challenge,extraParams?)</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="532.4953474300117" y="468.16692657799996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> pre generates key and attestation</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 832.5288762481432 474.701007898 L 465.0663331391016 474.701007898" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(451.6170157554349,474.701007898) translate(-451.6170157554349,-474.701007898)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 465.2296851721016 467.89467318966666 L 451.6170157554349 474.701007898 L 465.2296851721016 481.50734260633334 Z"/></g></g><g><rect fill="white" stroke="none" x="483.1732026161641" y="499.2038128480001" width="97.79957832398438" height="21.23576429"/><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="485.6234831111641" y="513.9054958180001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">generateKey()</text><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="473.3972868221016" y="513.9054958180001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 451.6170157554349 520.439577138 L 516.9578289554349 520.439577138 L 516.9578289554349 541.675341428 L 465.0663331391016 541.675341428" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(451.6170157554349,541.675341428) translate(-451.6170157554349,-541.675341428)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 465.2296851721016 534.8690067196667 L 451.6170157554349 541.675341428 L 465.2296851721016 548.4816761363334 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 302.8744935255716 566.1781463780001 L 585.6578550152982 566.1781463780001 L 600.3595379852982 580.879829348 L 600.3595379852982 620.0843172680001 L 302.8744935255716 620.0843172680001 L 302.8744935255716 566.1781463780001 M 585.6578550152982 566.1781463780001 L 585.6578550152982 580.879829348 L 600.3595379852982 580.879829348" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="325.74377814557164" y="589.047430998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">For Enterprise, this call will be platform</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="325.74377814557164" y="605.382634298" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">based &amp; generates device attestation</text></g><g><rect fill="white" stroke="none" x="185.51113612980342" y="644.5871222180001" width="178.5010706335547" height="21.23576429"/><rect fill="white" stroke="none" x="185.51113612980342" y="660.9223255180001" width="179.82530464234375" height="21.23576429"/><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="187.9614166248034" y="659.2888051880001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">generateBindingStatement</text><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="175.7352203357409" y="659.2888051880001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="187.9614166248034" y="675.6240084880001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(publicKey, AIK, challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 451.6170157554349 682.1580898080001 L 100.4536822411198 682.1580898080001" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(87.00436485745313,682.1580898080001) translate(-87.00436485745313,-682.1580898080001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 100.61703427411979 675.3517550996668 L 87.00436485745313 682.1580898080001 L 100.61703427411979 688.9644245163335 Z"/></g></g><g><rect fill="white" stroke="none" x="118.56055171818231" y="706.6608947580002" width="120.62707771363281" height="21.23576429"/><rect fill="white" stroke="none" x="118.56055171818231" y="722.9960980580001" width="313.726488724375" height="21.23576429"/><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="121.01083221318231" y="721.3625777280001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BindingStatement</text><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="108.78463592411981" y="721.3625777280001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="121.01083221318231" y="737.6977810280001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{challenge, thumbprint(publicKey), extraClaims}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 87.00436485745313 744.2318623480002 L 438.16769837176827 744.2318623480002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(451.6170157554349,744.2318623480002) translate(-451.6170157554349,-744.2318623480002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 438.00434633876824 737.4255276396668 L 451.6170157554349 744.2318623480002 L 438.00434633876824 751.0381970563335 Z"/></g></g><g><rect fill="white" stroke="none" x="483.1732026161641" y="768.7346672980002" width="126.31065620484375" height="21.23576429"/><rect fill="white" stroke="none" x="483.1732026161641" y="785.0698705980002" width="120.62707771363281" height="21.23576429"/><rect fill="white" stroke="none" x="483.1732026161641" y="801.4050738980002" width="330.0256830603125" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="485.6234831111641" y="783.4363502680002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return public key &amp;</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="473.3972868221016" y="783.4363502680002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="485.6234831111641" y="799.7715535680002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BindingStatement</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="485.6234831111641" y="816.1067568680002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{challenge, thumbprint(publicKey), extraClaims?..}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 451.6170157554349 822.6408381880002 L 819.0795588644766 822.6408381880002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(832.5288762481432,822.6408381880002) translate(-832.5288762481432,-822.6408381880002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 818.9162068314765 815.8345034796669 L 832.5288762481432 822.6408381880002 L 818.9162068314765 829.4471728963335 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 729.8099517355652 847.1436431380002 L 920.5461177907215 847.1436431380002 L 935.2478007607215 861.8453261080002 L 935.2478007607215 884.7146107280003 L 729.8099517355652 884.7146107280003 L 729.8099517355652 847.1436431380002 M 920.5461177907215 847.1436431380002 L 920.5461177907215 861.8453261080002 L 935.2478007607215 861.8453261080002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="752.6792363555651" y="870.0129277580003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Cache the key for server</text></g><g><rect fill="white" stroke="none" x="991.6837416977396" y="909.2174156780003" width="84.77166999878906" height="21.23576429"/><rect fill="white" stroke="none" x="991.6837416977396" y="925.5526189780003" width="174.37791694703125" height="21.23576429"/><rect fill="white" stroke="none" x="991.6837416977396" y="941.8878222780003" width="124.70009101929688" height="21.23576429"/><rect fill="white" stroke="none" x="991.6837416977396" y="958.2230255780003" width="325.9455133825781" height="21.23576429"/><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="994.1340221927396" y="923.9190986480003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Load sign-in</text><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="981.9078259036771" y="923.9190986480003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="994.1340221927396" y="940.2543019480003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Keys: KeyId,</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="994.1340221927396" y="956.5895052480003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Binding Statement</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="994.1340221927396" y="972.9247085480002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{challenge, thumbprint(publicKey), extraClaims...}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 832.5288762481432 979.4587898680003 L 1451.108606857185 979.4587898680003" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1464.5579242408517,979.4587898680003) translate(-1464.5579242408517,-979.4587898680003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1450.945254824185 972.6524551596669 L 1464.5579242408517 979.4587898680003 L 1450.945254824185 986.2651245763336 Z"/></g></g><g><rect fill="white" stroke="none" x="1496.1141111015809" y="1003.9615948180003" width="168.71580757203125" height="21.23576429"/><rect fill="white" stroke="none" x="1496.1141111015809" y="1020.2967981180003" width="215.99568428101563" height="21.23576429"/><rect fill="white" stroke="none" x="1496.1141111015809" y="1036.6320014180003" width="156.4609857946875" height="21.23576429"/><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1498.564391596581" y="1018.6632777880003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">validate signature on the </text><g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1486.3381953075184" y="1018.6632777880003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1498.564391596581" y="1034.9984810880003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">binding statement and challenge</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1498.564391596581" y="1051.3336843880004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">store thumbprint, KeyId</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1464.5579242408517 1057.8677657080004 L 1529.8987374408516 1057.8677657080004 L 1529.8987374408516 1079.1035299980003 L 1478.0072416245184 1079.1035299980003" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1464.5579242408517,1079.1035299980003) translate(-1464.5579242408517,-1079.1035299980003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1478.1705936575183 1072.2971952896671 L 1464.5579242408517 1079.1035299980003 L 1478.1705936575183 1085.9098647063336 Z"/></g></g><g><rect fill="white" stroke="none" x="872.2382460922709" y="1103.6063349480003" width="498.7370478064062" height="21.23576429"/><rect fill="white" stroke="none" x="872.2382460922709" y="1119.9415382480004" width="61.128176346445315" height="21.23576429"/><rect fill="white" stroke="none" x="872.2382460922709" y="1119.9415382480004" width="512.6890131384375" height="21.23576429"/><rect fill="white" stroke="none" x="872.2382460922709" y="1119.9415382480004" width="8.973574295664061" height="21.23576429"/><rect fill="white" stroke="none" x="872.2382460922709" y="1136.2767415480005" width="133.63350166382813" height="21.23576429"/><rect fill="white" stroke="none" x="872.2382460922709" y="1152.6119448480006" width="362.6312128454687" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="874.6885265872709" y="1118.3080179180004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/signed-in content, response includes header to start secure session.  </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="854.3091473148099" y="1118.3080179180004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="874.6885265872709" y="1134.6432212180005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="930.9161419437162" y="1134.6432212180005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Registration: session_identifier=..., challenge=...</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1438.7045940921537" y="1134.6432212180005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">,</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="874.6885265872709" y="1150.9784245180006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">KeyId, extraParams</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="874.6885265872709" y="1167.3136278180007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(challenge required for private key proof of possession)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1464.5579242408517 1173.8477091380003 L 845.9781936318099 1173.8477091380003" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(832.5288762481432,1173.8477091380003) translate(-832.5288762481432,-1173.8477091380003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 846.1415456648099 1167.041374429667 L 832.5288762481432 1173.8477091380003 L 846.1415456648099 1180.6540438463335 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 704.13352198703 1198.3505140880002 L 946.2225475392567 1198.3505140880002 L 960.9242305092566 1213.0521970580003 L 960.9242305092566 1252.2566849780003 L 704.13352198703 1252.2566849780003 L 704.13352198703 1198.3505140880002 M 946.2225475392567 1198.3505140880002 L 946.2225475392567 1213.0521970580003 L 960.9242305092566 1213.0521970580003" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="727.0028066070299" y="1221.2197987080006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">browser initiates session binding</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="727.0028066070299" y="1237.5550020080007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">based on header presence</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 731.4420089255066 1276.7594899280002 L 918.9140606007801 1276.7594899280002 L 933.6157435707801 1291.4611728980003 L 933.6157435707801 1314.3304575180002 L 731.4420089255066 1314.3304575180002 L 731.4420089255066 1276.7594899280002 M 918.9140606007801 1276.7594899280002 L 918.9140606007801 1291.4611728980003 L 933.6157435707801 1291.4611728980003" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="754.3112935455065" y="1299.6287745480004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">create JWT w/challenge</text></g><g><rect fill="white" stroke="none" x="525.2848588051289" y="1338.8332624680002" width="127.10524238648438" height="21.23576429"/><rect fill="white" stroke="none" x="525.2848588051289" y="1355.1684657680003" width="253.14666999878906" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="527.7351393001289" y="1353.5349454380002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">request sign JWT  </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="508.1646436946602" y="1353.5349454380002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">11 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="527.7351393001289" y="1369.8701487380004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(challenge,public key, extraParams?..)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 832.5288762481432 1376.4042300580002 L 465.0663331391016 1376.4042300580002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(451.6170157554349,1376.4042300580002) translate(-451.6170157554349,-1376.4042300580002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 465.2296851721016 1369.597895349667 L 451.6170157554349 1376.4042300580002 L 465.2296851721016 1383.2105647663334 Z"/></g></g><g><rect fill="white" stroke="none" x="581.3764496864766" y="1400.9070350080003" width="141.77237190308594" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="583.8267301814766" y="1415.6087179780004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return JWT signature</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="563.4473509090157" y="1415.6087179780004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">12 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 451.6170157554349 1422.1427992980002 L 819.0795588644766 1422.1427992980002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(832.5288762481432,1422.1427992980002) translate(-832.5288762481432,-1422.1427992980002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 818.9162068314765 1415.336464589667 L 832.5288762481432 1422.1427992980002 L 818.9162068314765 1428.9491340063335 Z"/></g></g><g><rect fill="white" stroke="none" x="932.5925933212748" y="1446.6456042480004" width="233.03216804566406" height="21.23576429"/><rect fill="white" stroke="none" x="932.5925933212748" y="1479.3160108480006" width="448.2079950720312" height="21.23576429"/><rect fill="white" stroke="none" x="932.5925933212748" y="1479.3160108480006" width="8.973574295664061" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="935.0428738162748" y="1461.3472872180005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /securesession/startsession </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="914.6634945438138" y="1461.3472872180005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">13 </text></g><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="935.0428738162748" y="1494.0176938180007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"alg":..., "typ":"JWT", ...}{...,"key":"&lt;public_key&gt;"}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1378.350307898306" y="1494.0176938180007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 832.5288762481432 1500.5517751380003 L 1451.108606857185 1500.5517751380003" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1464.5579242408517,1500.5517751380003) translate(-1464.5579242408517,-1500.5517751380003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1450.945254824185 1493.745440429667 L 1464.5579242408517 1500.5517751380003 L 1450.945254824185 1507.3581098463335 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1331.4131116667502 1525.0545800880004 L 1583.0010538449533 1525.0545800880004 L 1597.7027368149534 1539.7562630580005 L 1597.7027368149534 1578.9607509780003 L 1331.4131116667502 1578.9607509780003 L 1331.4131116667502 1525.0545800880004 M 1583.0010538449533 1525.0545800880004 L 1583.0010538449533 1539.7562630580005 L 1597.7027368149534 1539.7562630580005" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1354.28239628675" y="1547.9238647080006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">store public key, establish session</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1354.28239628675" y="1564.2590680080007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">validate the JWT</text></g><g><rect fill="white" stroke="none" x="1007.3566161484232" y="1603.4635559280002" width="191.51466621460938" height="21.23576429"/><rect fill="white" stroke="none" x="1007.3566161484232" y="1619.7987592280003" width="302.7529169470312" height="21.23576429"/><rect fill="white" stroke="none" x="1007.3566161484232" y="1652.4691658280005" width="58.6943842321875" height="21.23576429"/><rect fill="white" stroke="none" x="1007.3566161484232" y="1652.4691658280005" width="190.2836634069922" height="21.23576429"/><rect fill="white" stroke="none" x="1007.3566161484232" y="1668.8043691280006" width="44.836123123789065" height="21.23576429"/><rect fill="white" stroke="none" x="1007.3566161484232" y="1668.8043691280006" width="214.46406807007813" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1009.8068966434232" y="1618.1652388980003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/cookie and session ID</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="989.4275173709623" y="1618.1652388980003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">14 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1009.8068966434232" y="1634.5004421980004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body includes scope of cookies (origin + path)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1009.8068966434232" y="1667.1708487980006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1063.6007198856107" y="1667.1708487980006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Set-Cookie: auth_cookie</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1009.8068966434232" y="1683.5060520980007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1049.7424587772123" y="1683.5060520980007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"session_identifier":...}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1464.5579242408517 1690.0401334180003 L 845.9781936318099 1690.0401334180003" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(832.5288762481432,1690.0401334180003) translate(-832.5288762481432,-1690.0401334180003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 846.1415456648099 1683.233798709667 L 832.5288762481432 1690.0401334180003 L 846.1415456648099 1696.8464681263335 Z"/></g></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.16760165 1727.8833543963337 L 1708.83239835 1727.8833543963337 M 8.16760165 1733.3284221630004 L 1708.83239835 1733.3284221630004 M 8.16760165 1738.773489929667 L 1708.83239835 1738.773489929667" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 769.2277307608593 1714.5429383680003 L 947.7722692391405 1714.5429383680003 L 947.7722692391405 1752.1139059580003 L 769.2277307608593 1752.1139059580003 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="792.0970153808594" y="1737.4122229880004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Some time passes...</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 689.4771193991394 1776.6167109080002 L 960.8789501271473 1776.6167109080002 L 975.5806330971473 1791.3183938780003 L 975.5806330971473 1814.1876784980002 L 689.4771193991394 1814.1876784980002 L 689.4771193991394 1776.6167109080002 M 960.8789501271473 1776.6167109080002 L 960.8789501271473 1791.3183938780003 L 975.5806330971473 1791.3183938780003" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="712.3464040191393" y="1799.4859955280003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">user clicks link for path /somecontent</text></g><g><rect fill="white" stroke="none" x="872.2382460922709" y="1838.6904834480001" width="279.94694770875" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="874.6885265872709" y="1853.3921664180002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">check if origin+path requires bound cookie</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="854.3091473148099" y="1853.3921664180002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">15 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 832.5288762481432 1859.9262477380003 L 897.8696894481432 1859.9262477380003 L 897.8696894481432 1881.1620120280002 L 845.9781936318099 1881.1620120280002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(832.5288762481432,1881.1620120280002) translate(-832.5288762481432,-1881.1620120280002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 846.1415456648099 1874.355677319667 L 832.5288762481432 1881.1620120280002 L 846.1415456648099 1887.9683467363334 Z"/></g></g><g><rect fill="white" stroke="none" x="1095.1732970566263" y="1949.7698658880004" width="127.11958564820313" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1097.6235775516263" y="1964.4715488580005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /somecontent</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1077.2441982791654" y="1964.4715488580005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">16 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 832.5288762481432 1971.0056301780003 L 1451.108606857185 1971.0056301780003" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1464.5579242408517,1971.0056301780003) translate(-1464.5579242408517,-1971.0056301780003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1450.945254824185 1964.199295469667 L 1464.5579242408517 1971.0056301780003 L 1450.945254824185 1977.8119648863335 Z"/></g></g><g><rect fill="white" stroke="none" x="1110.6421614975443" y="1995.5084351280004" width="96.18185676636719" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1113.0924419925443" y="2010.2101180980005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/content</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1092.7130627200834" y="2010.2101180980005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">17 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1464.5579242408517 2016.7441994180003 L 845.9781936318099 2016.7441994180003" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(832.5288762481432,2016.7441994180003) translate(-832.5288762481432,-2016.7441994180003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 846.1415456648099 2009.937864709667 L 832.5288762481432 2016.7441994180003 L 846.1415456648099 2023.5505341263336 Z"/></g></g><g><rect fill="white" stroke="none" x="872.2382460922709" y="2085.3520532780003" width="200.45520271363281" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="874.6885265872709" y="2100.0537362480004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">check if required cookies exist</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="854.3091473148099" y="2100.0537362480004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">18 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 832.5288762481432 2106.587817568 L 897.8696894481432 2106.587817568 L 897.8696894481432 2127.823581858 L 845.9781936318099 2127.823581858" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(832.5288762481432,2127.823581858) translate(-832.5288762481432,-2127.823581858)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 846.1415456648099 2121.0172471496667 L 832.5288762481432 2127.823581858 L 846.1415456648099 2134.6299165663336 Z"/></g></g><g><rect fill="white" stroke="none" x="1095.1732970566263" y="2196.4314357179996" width="127.11958564820313" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1097.6235775516263" y="2211.1331186879997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /somecontent</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1077.2441982791654" y="2211.1331186879997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">19 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 832.5288762481432 2217.667200008 L 1451.108606857185 2217.667200008" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1464.5579242408517,2217.667200008) translate(-1464.5579242408517,-2217.667200008)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1450.945254824185 2210.8608652996663 L 1464.5579242408517 2217.667200008 L 1450.945254824185 2224.4735347163332 Z"/></g></g><g><rect fill="white" stroke="none" x="1110.6421614975443" y="2242.1700049579995" width="96.18185676636719" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1113.0924419925443" y="2256.8716879279996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/content</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1092.7130627200834" y="2256.8716879279996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">20 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1464.5579242408517 2263.4057692479996 L 845.9781936318099 2263.4057692479996" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(832.5288762481432,2263.4057692479996) translate(-832.5288762481432,-2263.4057692479996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 846.1415456648099 2256.599434539666 L 832.5288762481432 2263.4057692479996 L 846.1415456648099 2270.212103956333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 680.5007323752136 2332.0136231079996 L 969.8553371510731 2332.0136231079996 L 984.557020121073 2346.7153060779997 L 984.557020121073 2369.5845906979994 L 680.5007323752136 2369.5845906979994 L 680.5007323752136 2332.0136231079996 M 969.8553371510731 2332.0136231079996 L 969.8553371510731 2346.7153060779997 L 984.557020121073 2346.7153060779997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="703.3700169952135" y="2354.8829077279997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">request deferred while we get cookies...</text></g><g><rect fill="white" stroke="none" x="1016.5440093368998" y="2394.0873956479995" width="190.66282905640625" height="21.23576429"/><rect fill="white" stroke="none" x="1016.5440093368998" y="2410.4225989479996" width="58.6943842321875" height="21.23576429"/><rect fill="white" stroke="none" x="1016.5440093368998" y="2410.4225989479996" width="230.58433784546875" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1018.9942898318998" y="2408.7890786179996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="998.6149105594388" y="2408.7890786179996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">21 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1018.9942898318998" y="2425.1242819179997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1072.7881130740873" y="2425.1242819179997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Id: [session ID]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 832.5288762481432 2431.6583632379993 L 1451.108606857185 2431.6583632379993" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1464.5579242408517,2431.6583632379993) translate(-1464.5579242408517,-2431.6583632379993)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1450.945254824185 2424.852028529666 L 1464.5579242408517 2431.6583632379993 L 1450.945254824185 2438.4646979463328 Z"/></g></g><g><rect fill="white" stroke="none" x="886.3649550766459" y="2456.1611681879995" width="29.36010994019531" height="21.23576429"/><rect fill="white" stroke="none" x="886.3649550766459" y="2488.8315747879997" width="61.128176346445315" height="21.23576429"/><rect fill="white" stroke="none" x="886.3649550766459" y="2488.8315747879997" width="488.5086542517187" height="21.23576429"/><rect fill="white" stroke="none" x="886.3649550766459" y="2505.166778088" width="179.89692939820313" height="21.23576429"/><rect fill="white" stroke="none" x="886.3649550766459" y="2505.166778088" width="12.960695877695311" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="888.8152355716459" y="2470.8628511579996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">401</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="868.4358562991849" y="2470.8628511579996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">22 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="888.8152355716459" y="2503.5332577579998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="945.0428509280912" y="2503.5332577579998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Challenge: session_identifier=..., challenge=...</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="888.8152355716459" y="2519.868461058" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"extraParams":&lt;custom..&gt;}</text><text fill="blue" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1063.811603979849" y="2519.868461058" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1464.5579242408517 2526.4025423779995 L 845.9781936318099 2526.4025423779995" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(832.5288762481432,2526.4025423779995) translate(-832.5288762481432,-2526.4025423779995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 846.1415456648099 2519.596207669666 L 832.5288762481432 2526.4025423779995 L 846.1415456648099 2533.208877086333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 731.4420089255066 2550.9053473279996 L 918.9140606007801 2550.9053473279996 L 933.6157435707801 2565.6070302979997 L 933.6157435707801 2588.4763149179994 L 731.4420089255066 2588.4763149179994 L 731.4420089255066 2550.9053473279996 M 918.9140606007801 2550.9053473279996 L 918.9140606007801 2565.6070302979997 L 933.6157435707801 2565.6070302979997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="754.3112935455065" y="2573.7746319479998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">create JWT w/challenge</text></g><g><rect fill="white" stroke="none" x="566.698577982375" y="2612.9791198679995" width="118.95921577515625" height="21.23576429"/><rect fill="white" stroke="none" x="566.698577982375" y="2629.3143231679996" width="171.12811531128906" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="569.148858477375" y="2627.6808028379996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">request sign JWT</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="548.7694792049141" y="2627.6808028379996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">23 </text></g><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="569.148858477375" y="2644.0160061379997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">challenge, extraParams...</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 832.5288762481432 2650.5500874579993 L 465.0663331391016 2650.5500874579993" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(451.6170157554349,2650.5500874579993) translate(-451.6170157554349,-2650.5500874579993)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 465.2296851721016 2643.743752749666 L 451.6170157554349 2650.5500874579993 L 465.2296851721016 2657.356422166333 Z"/></g></g><g><rect fill="white" stroke="none" x="581.3764496864766" y="2675.052892407999" width="141.77237190308594" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="583.8267301814766" y="2689.754575377999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return JWT signature</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="563.4473509090157" y="2689.754575377999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">24 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 451.6170157554349 2696.288656697999 L 819.0795588644766 2696.288656697999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(832.5288762481432,2696.288656697999) translate(-832.5288762481432,-2696.288656697999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 818.9162068314765 2689.4823219896657 L 832.5288762481432 2696.288656697999 L 818.9162068314765 2703.0949914063326 Z"/></g></g><g><rect fill="white" stroke="none" x="1020.5740767807474" y="2720.7914616479993" width="190.66282905640625" height="21.23576429"/><rect fill="white" stroke="none" x="1020.5740767807474" y="2737.1266649479994" width="58.6943842321875" height="21.23576429"/><rect fill="white" stroke="none" x="1020.5740767807474" y="2737.1266649479994" width="222.52420295777344" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1023.0243572757474" y="2735.4931446179994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1002.6449780032865" y="2735.4931446179994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">25 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1023.0243572757474" y="2751.8283479179995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1076.818180517935" y="2751.8283479179995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Response: [JWT]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 832.5288762481432 2758.362429237999 L 1451.108606857185 2758.362429237999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1464.5579242408517,2758.362429237999) translate(-1464.5579242408517,-2758.362429237999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1450.945254824185 2751.5560945296656 L 1464.5579242408517 2758.362429237999 L 1450.945254824185 2765.1687639463325 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1354.4875364104025 2782.8652341879992 L 1559.926629101301 2782.8652341879992 L 1574.628312071301 2797.5669171579993 L 1574.628312071301 2820.436201777999 L 1354.4875364104025 2820.436201777999 L 1354.4875364104025 2782.8652341879992 M 1559.926629101301 2782.8652341879992 L 1559.926629101301 2797.5669171579993 L 1574.628312071301 2797.5669171579993" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1377.3568210304024" y="2805.7345188079994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">validate proof of possesion</text></g><g><rect fill="white" stroke="none" x="1007.3566161484232" y="2844.9390067279987" width="191.51466621460938" height="21.23576429"/><rect fill="white" stroke="none" x="1007.3566161484232" y="2861.274210027999" width="302.7529169470312" height="21.23576429"/><rect fill="white" stroke="none" x="1007.3566161484232" y="2893.944616627999" width="58.6943842321875" height="21.23576429"/><rect fill="white" stroke="none" x="1007.3566161484232" y="2893.944616627999" width="190.2836634069922" height="21.23576429"/><rect fill="white" stroke="none" x="1007.3566161484232" y="2910.279819927999" width="44.836123123789065" height="21.23576429"/><rect fill="white" stroke="none" x="1007.3566161484232" y="2910.279819927999" width="214.46406807007813" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1009.8068966434232" y="2859.640689697999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/cookie and session ID</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="989.4275173709623" y="2859.640689697999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">26 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1009.8068966434232" y="2875.975892997999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body includes scope of cookies (origin + path)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1009.8068966434232" y="2908.646299597999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1063.6007198856107" y="2908.646299597999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Set-Cookie: auth_cookie</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1009.8068966434232" y="2924.9815028979992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1049.7424587772123" y="2924.9815028979992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"session_identifier":...}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1464.5579242408517 2931.515584217999 L 845.9781936318099 2931.515584217999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(832.5288762481432,2931.515584217999) translate(-832.5288762481432,-2931.515584217999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 846.1415456648099 2924.7092495096654 L 832.5288762481432 2931.515584217999 L 846.1415456648099 2938.3219189263323 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 693.1349563132019 2956.018389167999 L 957.2211132130848 2956.018389167999 L 971.9227961830848 2970.720072137999 L 971.9227961830848 3009.924560057999 L 693.1349563132019 3009.924560057999 L 693.1349563132019 2956.018389167999 M 957.2211132130848 2956.018389167999 L 957.2211132130848 2970.720072137999 L 971.9227961830848 2970.720072137999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="716.0042409332018" y="2978.887673787999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">secure session established, resume</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="716.0042409332018" y="2995.222877087999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">original request</text></g><g><rect fill="white" stroke="none" x="1095.1732970566263" y="3034.4273650079986" width="127.11958564820313" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1097.6235775516263" y="3049.1290479779987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /somecontent</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1077.2441982791654" y="3049.1290479779987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">27 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 832.5288762481432 3055.6631292979987 L 1451.108606857185 3055.6631292979987" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1464.5579242408517,3055.6631292979987) translate(-1464.5579242408517,-3055.6631292979987)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1450.945254824185 3048.8567945896652 L 1464.5579242408517 3055.6631292979987 L 1450.945254824185 3062.469464006332 Z"/></g></g><g><rect fill="white" stroke="none" x="1090.68153680272" y="3080.1659342479984" width="136.10310615601563" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1093.13181729772" y="3094.8676172179985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/some content</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1072.7524380252592" y="3094.8676172179985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">28 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1464.5579242408517 3101.4016985379985 L 845.9781936318099 3101.4016985379985" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(832.5288762481432,3101.4016985379985) translate(-832.5288762481432,-3101.4016985379985)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 846.1415456648099 3094.595363829665 L 832.5288762481432 3101.4016985379985 L 846.1415456648099 3108.208033246332 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 378.1086009054349 1905.6648169780003 L 1599.131117021301 1905.6648169780003 L 1599.131117021301 3150.407308437999 L 378.1086009054349 3150.407308437999 L 378.1086009054349 1905.6648169780003 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 378.1086009054349 1905.6648169780003 L 378.1086009054349 1925.2670609380002 L 424.4678045025052 1925.2670609380002 L 434.2689264825052 1915.4659389580004 L 434.2689264825052 1905.6648169780003 L 378.1086009054349 1905.6648169780003" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="394.4438042054349" y="1918.7329796180002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="448.1538492875052" y="1906.9716332420003" width="160.64361824097656" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="450.6041297825052" y="1918.7329796180002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[bound cookie not required]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 378.1086009054349 2041.2470043680003 L 1599.131117021301 2041.2470043680003" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray="4.083800825"/></g><g/><g><rect fill="white" stroke="none" x="448.1538492875052" y="2042.5538206320002" width="139.14819587769531" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="450.6041297825052" y="2054.315167008" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[bound cookie required]</text></g><g/><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 394.4438042054349 2152.326386808 L 1582.7959137213008 2152.326386808 L 1582.7959137213008 3125.9045034879987 L 394.4438042054349 3125.9045034879987 L 394.4438042054349 2152.326386808 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 394.4438042054349 2152.326386808 L 394.4438042054349 2171.928630768 L 440.8030078025052 2171.928630768 L 450.6041297825052 2162.127508788 L 450.6041297825052 2152.326386808 L 394.4438042054349 2152.326386808" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="410.7790075054349" y="2165.394549448" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="464.48905258750517" y="2153.633203072" width="236.28714241089844" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="466.9393330825052" y="2165.394549448" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[required cookie present and not expired]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 394.4438042054349 2287.9085741979993 L 1582.7959137213008 2287.9085741979993" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray="4.083800825"/></g><g/><g><rect fill="white" stroke="none" x="464.48905258750517" y="2289.2153904619995" width="207.6208216101172" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="466.9393330825052" y="2300.9767368379994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[required cookie missing or expired]</text></g><g/></g></g></svg>