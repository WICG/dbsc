<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1203.1704007432095" height="2513.794735467364"><desc>participant%20%22TPM%22%20as%20t%0Aparticipant%20%22Browser%22%20as%20b%0Aparticipant%20%22Server%22%20as%20w%0A%0A%0A%0Ab-%3Ew%3A%20sign-in%20flow%20%0Aw-%3Eb%3A%20200%20w%2Fsigned-in%20content%2C%20response%20includes%20header%20to%20start%20secure%20session.%20%20%5CnHeader%3A%20%22%22Sec-Session-Registration%3A%20session_identifier%3D...%2C%20challenge%3D...%22%22%5Cn(challenge%20required%20for%20private%20key%20proof%20of%20possession)%20%5Cn%5Cn%3Csize%3A10%3E%3Ccolor%3A%23blue%3ESec-Session-GenerateKey%3A%20%5CnRPUrl%2C%20IDPUrl%2C%20challenge%3Dnonce%2C%20extraParams...%5Cn%5CnSec-Session-HelperIdList%3A%20%5Cn%5BHelperId1%2C%20HelperId2%5D%2C%20HelperCacheTime%0Anote%20over%20b%3A%20browser%20initiates%20session%20binding%5Cnbased%20on%20header%20presence%20%5Cn%3Ccolor%3A%23blue%3Eevaluate%20policy%20for%20%5Cn(HelperId...)%0Ab-%3Et%3A%20request%20create%20keypair%20%5Cn%3Ccolor%3A%23blue%3E(serverUrl%2C%20authUrl%3F%2C%20challenge%2C%20extraParams%3F)%0Anote%20over%20b%3A%20For%20Enterprise%2C%20this%20call%20will%20be%20platform%5Cnbased%20%26%20generates%20device%20attestation%0At-%3Eb%3A%20return%20public%20key%20%26%5Cn%3Ccolor%3A%23blue%3EBindingStatement%5Cn%7Bchallenge%2C%20thumbprint(pubKey)%2C%20extraClaims%3F..%7D%0Anote%20over%20b%3A%20create%20JWT%20w%2Fchallenge%0Ab-%3Et%3Arequest%20sign%20JWT%20%20%5Cn%3Ccolor%3A%23blue%3E(challenge%2Cpublic%20key%2C%20extraParams%3F..)%0At-%3Eb%3A%20return%20JWT%20signature%0Ab-%3Ew%3A%20POST%20%2Fsecuresession%2Fstartsession%20%5Cn%5Cn%22%22%7B%22alg%22%3A...%2C%20%22typ%22%3A%22JWT%22%2C%20...%7D%7B...%2C%22key%22%3A%22%3Cpublic_key%3E%22%7D%22%22%20%0Anote%20over%20w%3A%20store%20public%20key%2C%20establish%20session%0Aw-%3Eb%3A%20200%20w%2Fcookie%20and%20session%20ID%5Cnbody%20includes%20scope%20of%20cookies%20(origin%20%2B%20path)%5Cn%5Cnheader%3A%20%22%22Set-Cookie%3A%20auth_cookie%22%22%5Cnbody%3A%20%22%22%7B%22session_identifier%22%3A...%7D%22%22%0A%3D%3DSome%20time%20passes...%3D%3D%0Anote%20over%20b%3A%20user%20clicks%20link%20for%20path%20%2Fsomecontent%0Ab-%3Eb%3A%20check%20if%20origin%2Bpath%20requires%20bound%20cookie%0Aalt%20bound%20cookie%20not%20required%0Ab-%3Ew%3A%20GET%20%2Fsomecontent%0Aw-%3Eb%3A%20200%20w%2Fcontent%0Aelse%20bound%20cookie%20required%0Ab-%3Eb%3A%20check%20if%20required%20cookies%20exist%0Aalt%20required%20cookie%20present%20and%20not%20expired%0Ab-%3Ew%3A%20GET%20%2Fsomecontent%0Aw-%3Eb%3A%20200%20w%2Fcontent%0Aelse%20required%20cookie%20missing%20or%20expired%0Anote%20over%20b%3A%20request%20deferred%20while%20we%20get%20cookies...%0Ab-%3Ew%3A%20GET%20%2Fsecuresession%2Frefresh%20%5Cnheader%3A%20%22%22Sec-Session-Id%3A%20%5Bsession%20ID%5D%22%22%0Aw-%3Eb%3A401%5Cn%5CnHeader%3A%20%22%22Sec-Session-Challenge%3A%20session_identifier%3D...%2C%20challenge%3D...%22%22%0Anote%20over%20b%3A%20create%20JWT%20w%2Fchallenge%0Ab-%3Et%3Arequest%20sign%20JWT%0At-%3Eb%3A%20return%20JWT%20signature%0Ab-%3Ew%3A%20GET%20%2Fsecuresession%2Frefresh%20%5Cnheader%3A%20%22%22Sec-Session-Response%3A%20%5BJWT%5D%22%22%0Anote%20over%20w%3A%20validate%20proof%20of%20possesion%0Aw-%3Eb%3A200%20w%2Fcookie%20and%20session%20ID%5Cnbody%20includes%20scope%20of%20cookies%20(origin%20%2B%20path)%5Cn%5Cnheader%3A%20%22%22Set-Cookie%3A%20auth_cookie%22%22%5Cnbody%3A%20%22%22%7B%22session_identifier%22%3A...%7D%22%22%0Anote%20over%20b%3A%20secure%20session%20established%2C%20resume%5Cnoriginal%20request%0Ab-%3Ew%3A%20GET%20%2Fsomecontent%0Aw-%3Eb%3A%20200%20w%2Fsome%20content%0Aend%0Aend</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1203" height="2513"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 89.84361815 55.049635120999994 L 89.84361815 2513.794735467364" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 444.6853492481771 55.049635120999994 L 444.6853492481771 2513.794735467364" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1052.2620046627603 55.049635120999994 L 1052.2620046627603 2513.794735467364" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 56.64747994254687 11.107938244000005 L 123.03975635745311 11.107938244000005 L 123.03975635745311 55.049635120999994 L 56.64747994254687 55.049635120999994 L 56.64747994254687 11.107938244000005 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="74.37117552304687" y="38.71443182099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TPM</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 400.0790624201185 11.107938244000005 L 489.2916360762357 11.107938244000005 L 489.2916360762357 55.049635120999994 L 400.0790624201185 55.049635120999994 L 400.0790624201185 11.107938244000005 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="417.8027580006185" y="38.71443182099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Browser</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1012.9492053835298 11.107938244000005 L 1091.5748039419907 11.107938244000005 L 1091.5748039419907 55.049635120999994 L 1012.9492053835298 55.049635120999994 L 1012.9492053835298 11.107938244000005 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1030.6729009640299" y="38.71443182099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Server</text></g></g><g><g><rect fill="white" stroke="none" x="707.3226289433788" y="87.720041721" width="82.30209602417969" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="709.7729094383789" y="102.42172469100001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">sign-in flow </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 444.6853492481771 108.95580601099999 L 1038.8126872790936 108.95580601099999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1052.2620046627603,108.95580601099999) translate(-1052.2620046627603,-108.95580601099999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1038.6493352460936 102.14947130266665 L 1052.2620046627603 108.95580601099999 L 1038.6493352460936 115.76214071933333 Z"/></g></g><g><rect fill="white" stroke="none" x="464.0153398198437" y="133.458610961" width="498.7370478064062" height="21.23576429"/><rect fill="white" stroke="none" x="464.0153398198437" y="149.793814261" width="61.128176346445315" height="21.23576429"/><rect fill="white" stroke="none" x="464.0153398198437" y="149.793814261" width="512.6890131384375" height="21.23576429"/><rect fill="white" stroke="none" x="464.0153398198437" y="166.12901756099998" width="366.7042108923437" height="21.23576429"/><rect fill="white" stroke="none" x="464.0153398198437" y="198.65092231281812" width="170.12588752808594" height="19.305240263636364"/><rect fill="white" stroke="none" x="464.0153398198437" y="213.50110713099994" width="289.75721992554685" height="19.305240263636364"/><rect fill="white" stroke="none" x="464.0153398198437" y="243.2014767673636" width="162.7058588415625" height="19.305240263636364"/><rect fill="white" stroke="none" x="464.0153398198437" y="258.05166158554545" width="249.64361824097656" height="19.305240263636364"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="466.4656203148437" y="148.16029393099998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/signed-in content, response includes header to start secure session.  </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="466.4656203148437" y="164.49549723099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="522.693235671289" y="164.49549723099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Registration: session_identifier=..., challenge=...</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="466.4656203148437" y="180.83070053099996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(challenge required for private key proof of possession) </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="10pt" font-style="normal" font-weight="normal" text-decoration="normal" x="466.4656203148437" y="212.01608864918177" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-GenerateKey: </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="10pt" font-style="normal" font-weight="normal" text-decoration="normal" x="466.4656203148437" y="226.86627346736358" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RPUrl, IDPUrl, challenge=nonce, extraParams...</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="10pt" font-style="normal" font-weight="normal" text-decoration="normal" x="466.4656203148437" y="256.56664310372724" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-HelperIdList: </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="10pt" font-style="normal" font-weight="normal" text-decoration="normal" x="466.4656203148437" y="271.4168279219091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[HelperId1, HelperId2], HelperCacheTime</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1052.2620046627603 277.50540369736365 L 458.13466663184374 277.50540369736365" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(444.6853492481771,277.50540369736365) translate(-444.6853492481771,-277.50540369736365)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 458.29801866484377 270.6990689890303 L 444.6853492481771 277.50540369736365 L 458.29801866484377 284.311738405697 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 316.28999498706384 302.00820864736363 L 558.3790205392904 302.00820864736363 L 573.0807035092904 316.7098916173636 L 573.0807035092904 388.58478613736366 L 316.28999498706384 388.58478613736366 L 316.28999498706384 302.00820864736363 M 558.3790205392904 302.00820864736363 L 558.3790205392904 316.7098916173636 L 573.0807035092904 316.7098916173636" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="339.1592796070638" y="324.87749326736366" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">browser initiates session binding</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="339.1592796070638" y="341.21269656736365" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">based on header presence </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="339.1592796070638" y="357.54789986736364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">evaluate policy for </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="339.1592796070638" y="373.88310316736363" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(HelperId...)</text></g><g><rect fill="white" stroke="none" x="113.27169221776042" y="413.08759108736365" width="154.02002204957031" height="21.23576429"/><rect fill="white" stroke="none" x="113.27169221776042" y="429.42279438736364" width="307.9855829626562" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="115.72197271276042" y="427.7892740573636" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">request create keypair </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="115.72197271276042" y="444.1244773573636" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(serverUrl, authUrl?, challenge, extraParams?)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 444.6853492481771 450.65855867736366 L 103.29293553366666 450.65855867736366" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(89.84361815,450.65855867736366) translate(-89.84361815,-450.65855867736366)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 103.45628756666666 443.8522239690303 L 89.84361815 450.65855867736366 L 103.45628756666666 457.464893385697 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 295.94282701831384 475.1613636273637 L 578.7261885080404 475.1613636273637 L 593.4278714780404 489.8630465973637 L 593.4278714780404 529.0675345173637 L 295.94282701831384 529.0675345173637 L 295.94282701831384 475.1613636273637 M 578.7261885080404 475.1613636273637 L 578.7261885080404 489.8630465973637 L 593.4278714780404 489.8630465973637" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="318.8121116383138" y="498.0306482473637" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">For Enterprise, this call will be platform</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="318.8121116383138" y="514.3658515473637" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">based &amp; generates device attestation</text></g><g><rect fill="white" stroke="none" x="109.17360872166667" y="553.5703394673637" width="126.31065620484375" height="21.23576429"/><rect fill="white" stroke="none" x="109.17360872166667" y="569.9055427673637" width="120.62707771363281" height="21.23576429"/><rect fill="white" stroke="none" x="109.17360872166667" y="586.2407460673637" width="316.1817499548437" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.62388921666667" y="568.2720224373637" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return public key &amp;</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.62388921666667" y="584.6072257373637" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BindingStatement</text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.62388921666667" y="600.9424290373637" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{challenge, thumbprint(pubKey), extraClaims?..}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 89.84361815 607.4765103573637 L 431.23603186451044 607.4765103573637" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(444.6853492481771,607.4765103573637) translate(-444.6853492481771,-607.4765103573637)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 431.0726798315104 600.6701756490304 L 444.6853492481771 607.4765103573637 L 431.0726798315104 614.2828450656971 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 343.5984819255404 631.9793153073638 L 531.0705336008139 631.9793153073638 L 545.7722165708138 646.6809982773638 L 545.7722165708138 669.5502828973638 L 343.5984819255404 669.5502828973638 L 343.5984819255404 631.9793153073638 M 531.0705336008139 631.9793153073638 L 531.0705336008139 646.6809982773638 L 545.7722165708138 646.6809982773638" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="366.46776654554037" y="654.8485999273638" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">create JWT w/challenge</text></g><g><rect fill="white" stroke="none" x="140.69114869969403" y="694.0530878473638" width="127.10524238648438" height="21.23576429"/><rect fill="white" stroke="none" x="140.69114869969403" y="710.3882911473638" width="253.14666999878906" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="143.141429194694" y="708.7547708173638" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">request sign JWT  </text><text fill="blue" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="143.141429194694" y="725.0899741173638" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(challenge,public key, extraParams?..)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 444.6853492481771 731.6240554373638 L 103.29293553366666 731.6240554373638" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(89.84361815,731.6240554373638) translate(-89.84361815,-731.6240554373638)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 103.45628756666666 724.8177207290305 L 89.84361815 731.6240554373638 L 103.45628756666666 738.4303901456972 Z"/></g></g><g><rect fill="white" stroke="none" x="196.3782977475456" y="756.1268603873638" width="141.77237190308594" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="198.82857824254557" y="770.8285433573637" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return JWT signature</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 89.84361815 777.3626246773638 L 431.23603186451044 777.3626246773638" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(444.6853492481771,777.3626246773638) translate(-444.6853492481771,-777.3626246773638)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 431.0726798315104 770.5562899690304 L 444.6853492481771 777.3626246773638 L 431.0726798315104 784.1689593856971 Z"/></g></g><g><rect fill="white" stroke="none" x="522.3331803960156" y="801.8654296273638" width="233.03216804566406" height="21.23576429"/><rect fill="white" stroke="none" x="522.3331803960156" y="834.5358362273638" width="448.2079950720312" height="21.23576429"/><rect fill="white" stroke="none" x="522.3331803960156" y="834.5358362273638" width="8.973574295664061" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="524.7834608910156" y="816.5671125973638" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /securesession/startsession </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="524.7834608910156" y="849.2375191973638" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"alg":..., "typ":"JWT", ...}{...,"key":"&lt;public_key&gt;"}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="968.0908949730468" y="849.2375191973638" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 444.6853492481771 855.7716005173638 L 1038.8126872790936 855.7716005173638" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1052.2620046627603,855.7716005173638) translate(-1052.2620046627603,-855.7716005173638)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1038.6493352460936 848.9652658090305 L 1052.2620046627603 855.7716005173638 L 1038.6493352460936 862.5779352256972 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 919.1171920886588 880.2744054673637 L 1170.705134266862 880.2744054673637 L 1185.406817236862 894.9760884373637 L 1185.406817236862 917.8453730573638 L 919.1171920886588 917.8453730573638 L 919.1171920886588 880.2744054673637 M 1170.705134266862 880.2744054673637 L 1170.705134266862 894.9760884373637 L 1185.406817236862 894.9760884373637" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="941.9864767086588" y="903.1436900873638" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">store public key, establish session</text></g><g><rect fill="white" stroke="none" x="597.097203223164" y="942.3481780073638" width="191.51466621460938" height="21.23576429"/><rect fill="white" stroke="none" x="597.097203223164" y="958.6833813073638" width="302.7529169470312" height="21.23576429"/><rect fill="white" stroke="none" x="597.097203223164" y="991.3537879073638" width="58.6943842321875" height="21.23576429"/><rect fill="white" stroke="none" x="597.097203223164" y="991.3537879073638" width="190.2836634069922" height="21.23576429"/><rect fill="white" stroke="none" x="597.097203223164" y="1007.6889912073638" width="44.836123123789065" height="21.23576429"/><rect fill="white" stroke="none" x="597.097203223164" y="1007.6889912073638" width="214.46406807007813" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="599.547483718164" y="957.0498609773638" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/cookie and session ID</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="599.547483718164" y="973.3850642773638" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body includes scope of cookies (origin + path)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="599.547483718164" y="1006.0554708773637" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="653.3413069603515" y="1006.0554708773637" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Set-Cookie: auth_cookie</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="599.547483718164" y="1022.3906741773637" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="639.4830458519531" y="1022.3906741773637" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"session_identifier":...}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1052.2620046627603 1028.9247554973638 L 458.13466663184374 1028.9247554973638" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(444.6853492481771,1028.9247554973638) translate(-444.6853492481771,-1028.9247554973638)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 458.29801866484377 1022.1184207890304 L 444.6853492481771 1028.9247554973638 L 458.29801866484377 1035.731090205697 Z"/></g></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.16760165 1066.7679764756972 L 1194.83239835 1066.7679764756972 M 8.16760165 1072.2130442423638 L 1194.83239835 1072.2130442423638 M 8.16760165 1077.6581120090304 L 1194.83239835 1077.6581120090304" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 512.2277307608593 1053.4275604473637 L 690.7722692391405 1053.4275604473637 L 690.7722692391405 1090.9985280373637 L 512.2277307608593 1090.9985280373637 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="535.0970153808594" y="1076.2968450673638" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Some time passes...</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 301.6335923991732 1115.5013329873636 L 573.035423127181 1115.5013329873636 L 587.737106097181 1130.2030159573637 L 587.737106097181 1153.0723005773636 L 301.6335923991732 1153.0723005773636 L 301.6335923991732 1115.5013329873636 M 573.035423127181 1115.5013329873636 L 573.035423127181 1130.2030159573637 L 587.737106097181 1130.2030159573637" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="324.5028770191732" y="1138.3706176073638" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">user clicks link for path /somecontent</text></g><g><rect fill="white" stroke="none" x="464.01533981984375" y="1177.5751055273636" width="279.94694770875" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="466.46562031484376" y="1192.2767884973637" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">check if origin+path requires bound cookie</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 444.6853492481771 1198.8108698173637 L 510.0261624481771 1198.8108698173637 L 510.0261624481771 1220.0466341073636 L 458.13466663184374 1220.0466341073636" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(444.6853492481771,1220.0466341073636) translate(-444.6853492481771,-1220.0466341073636)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 458.29801866484377 1213.2402993990304 L 444.6853492481771 1220.0466341073636 L 458.29801866484377 1226.8529688156968 Z"/></g></g><g><rect fill="white" stroke="none" x="684.9138841313671" y="1288.6544879673638" width="127.11958564820313" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="687.3641646263671" y="1303.356170937364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /somecontent</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 444.6853492481771 1309.8902522573637 L 1038.8126872790936 1309.8902522573637" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1052.2620046627603,1309.8902522573637) translate(-1052.2620046627603,-1309.8902522573637)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1038.6493352460936 1303.0839175490305 L 1052.2620046627603 1309.8902522573637 L 1038.6493352460936 1316.696586965697 Z"/></g></g><g><rect fill="white" stroke="none" x="700.3827485722851" y="1334.3930572073639" width="96.18185676636719" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="702.8330290672851" y="1349.094740177364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/content</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1052.2620046627603 1355.6288214973638 L 458.13466663184374 1355.6288214973638" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(444.6853492481771,1355.6288214973638) translate(-444.6853492481771,-1355.6288214973638)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 458.29801866484377 1348.8224867890306 L 444.6853492481771 1355.6288214973638 L 458.29801866484377 1362.435156205697 Z"/></g></g><g><rect fill="white" stroke="none" x="464.01533981984375" y="1424.2366753573638" width="200.45520271363281" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="466.46562031484376" y="1438.9383583273639" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">check if required cookies exist</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 444.6853492481771 1445.472439647364 L 510.0261624481771 1445.472439647364 L 510.0261624481771 1466.7082039373638 L 458.13466663184374 1466.7082039373638" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(444.6853492481771,1466.7082039373638) translate(-444.6853492481771,-1466.7082039373638)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 458.29801866484377 1459.9018692290306 L 444.6853492481771 1466.7082039373638 L 458.29801866484377 1473.514538645697 Z"/></g></g><g><rect fill="white" stroke="none" x="684.9138841313671" y="1535.316057797364" width="127.11958564820313" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="687.3641646263671" y="1550.017740767364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /somecontent</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 444.6853492481771 1556.551822087364 L 1038.8126872790936 1556.551822087364" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1052.2620046627603,1556.551822087364) translate(-1052.2620046627603,-1556.551822087364)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1038.6493352460936 1549.7454873790307 L 1052.2620046627603 1556.551822087364 L 1038.6493352460936 1563.3581567956971 Z"/></g></g><g><rect fill="white" stroke="none" x="700.3827485722851" y="1581.054627037364" width="96.18185676636719" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="702.8330290672851" y="1595.7563100073642" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/content</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1052.2620046627603 1602.290391327364 L 458.13466663184374 1602.290391327364" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(444.6853492481771,1602.290391327364) translate(-444.6853492481771,-1602.290391327364)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 458.29801866484377 1595.4840566190308 L 444.6853492481771 1602.290391327364 L 458.29801866484377 1609.0967260356972 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 292.65720537524743 1670.898245187364 L 582.0118101511068 1670.898245187364 L 596.7134931211068 1685.599928157364 L 596.7134931211068 1708.469212777364 L 292.65720537524743 1708.469212777364 L 292.65720537524743 1670.898245187364 M 582.0118101511068 1670.898245187364 L 582.0118101511068 1685.599928157364 L 596.7134931211068 1685.599928157364" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="315.5264899952474" y="1693.767529807364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">request deferred while we get cookies...</text></g><g><rect fill="white" stroke="none" x="606.2845964116406" y="1732.972017727364" width="190.66282905640625" height="21.23576429"/><rect fill="white" stroke="none" x="606.2845964116406" y="1749.307221027364" width="58.6943842321875" height="21.23576429"/><rect fill="white" stroke="none" x="606.2845964116406" y="1749.307221027364" width="230.58433784546875" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="608.7348769066406" y="1747.673700697364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="608.7348769066406" y="1764.008903997364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="662.5287001488281" y="1764.008903997364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Id: [session ID]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 444.6853492481771 1770.542985317364 L 1038.8126872790936 1770.542985317364" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1052.2620046627603,1770.542985317364) translate(-1052.2620046627603,-1770.542985317364)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1038.6493352460936 1763.7366506090307 L 1052.2620046627603 1770.542985317364 L 1038.6493352460936 1777.3493200256971 Z"/></g></g><g><rect fill="white" stroke="none" x="476.10554215138666" y="1795.0457902673638" width="29.36010994019531" height="21.23576429"/><rect fill="white" stroke="none" x="476.10554215138666" y="1827.716196867364" width="61.128176346445315" height="21.23576429"/><rect fill="white" stroke="none" x="476.10554215138666" y="1827.716196867364" width="488.5086542517187" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="478.5558226463867" y="1809.747473237364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">401</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="478.5558226463867" y="1842.4178798373641" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="534.783438002832" y="1842.4178798373641" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Challenge: session_identifier=..., challenge=...</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1052.2620046627603 1848.951961157364 L 458.13466663184374 1848.951961157364" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(444.6853492481771,1848.951961157364) translate(-444.6853492481771,-1848.951961157364)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 458.29801866484377 1842.1456264490307 L 444.6853492481771 1848.951961157364 L 458.29801866484377 1855.7582958656972 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 343.5984819255404 1873.4547661073639 L 531.0705336008139 1873.4547661073639 L 545.7722165708138 1888.156449077364 L 545.7722165708138 1911.0257336973639 L 343.5984819255404 1911.0257336973639 L 343.5984819255404 1873.4547661073639 M 531.0705336008139 1873.4547661073639 L 531.0705336008139 1888.156449077364 L 545.7722165708138 1888.156449077364" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="366.46776654554037" y="1896.324050727364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">create JWT w/challenge</text></g><g><rect fill="white" stroke="none" x="207.78487581151043" y="1935.528538647364" width="118.95921577515625" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="210.23515630651042" y="1950.2302216173641" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">request sign JWT</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 444.6853492481771 1956.764302937364 L 103.29293553366666 1956.764302937364" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(89.84361815,1956.764302937364) translate(-89.84361815,-1956.764302937364)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 103.45628756666666 1949.9579682290307 L 89.84361815 1956.764302937364 L 103.45628756666666 1963.5706376456972 Z"/></g></g><g><rect fill="white" stroke="none" x="196.3782977475456" y="1981.267107887364" width="141.77237190308594" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="198.82857824254557" y="1995.9687908573642" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return JWT signature</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 89.84361815 2002.502872177364 L 431.23603186451044 2002.502872177364" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(444.6853492481771,2002.502872177364) translate(-444.6853492481771,-2002.502872177364)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 431.0726798315104 1995.6965374690308 L 444.6853492481771 2002.502872177364 L 431.0726798315104 2009.3092068856972 Z"/></g></g><g><rect fill="white" stroke="none" x="610.3146638554882" y="2027.0056771273642" width="190.66282905640625" height="21.23576429"/><rect fill="white" stroke="none" x="610.3146638554882" y="2043.340880427364" width="58.6943842321875" height="21.23576429"/><rect fill="white" stroke="none" x="610.3146638554882" y="2043.340880427364" width="222.52420295777344" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="612.7649443504882" y="2041.7073600973642" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="612.7649443504882" y="2058.042563397364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="666.5587675926757" y="2058.042563397364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Response: [JWT]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 444.6853492481771 2064.576644717364 L 1038.8126872790936 2064.576644717364" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1052.2620046627603,2064.576644717364) translate(-1052.2620046627603,-2064.576644717364)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1038.6493352460936 2057.7703100090307 L 1052.2620046627603 2064.576644717364 L 1038.6493352460936 2071.3829794256976 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 942.1916168323112 2089.0794496673643 L 1147.6307095232096 2089.0794496673643 L 1162.3323924932097 2103.7811326373644 L 1162.3323924932097 2126.650417257364 L 942.1916168323112 2126.650417257364 L 942.1916168323112 2089.0794496673643 M 1147.6307095232096 2089.0794496673643 L 1147.6307095232096 2103.7811326373644 L 1162.3323924932097 2103.7811326373644" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="965.0609014523111" y="2111.9487342873645" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">validate proof of possesion</text></g><g><rect fill="white" stroke="none" x="597.097203223164" y="2151.153222207364" width="191.51466621460938" height="21.23576429"/><rect fill="white" stroke="none" x="597.097203223164" y="2167.488425507364" width="302.7529169470312" height="21.23576429"/><rect fill="white" stroke="none" x="597.097203223164" y="2200.158832107364" width="58.6943842321875" height="21.23576429"/><rect fill="white" stroke="none" x="597.097203223164" y="2200.158832107364" width="190.2836634069922" height="21.23576429"/><rect fill="white" stroke="none" x="597.097203223164" y="2216.494035407364" width="44.836123123789065" height="21.23576429"/><rect fill="white" stroke="none" x="597.097203223164" y="2216.494035407364" width="214.46406807007813" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="599.547483718164" y="2165.854905177364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/cookie and session ID</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="599.547483718164" y="2182.190108477364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body includes scope of cookies (origin + path)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="599.547483718164" y="2214.860515077364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="653.3413069603515" y="2214.860515077364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Set-Cookie: auth_cookie</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="599.547483718164" y="2231.1957183773643" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">body: </text><text fill="black" stroke="none" font-family="monospace" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="639.4830458519531" y="2231.1957183773643" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"session_identifier":...}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1052.2620046627603 2237.729799697364 L 458.13466663184374 2237.729799697364" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(444.6853492481771,2237.729799697364) translate(-444.6853492481771,-2237.729799697364)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 458.29801866484377 2230.9234649890304 L 444.6853492481771 2237.729799697364 L 458.29801866484377 2244.5361344056973 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 305.2914293132357 2262.232604647364 L 569.3775862131185 2262.232604647364 L 584.0792691831185 2276.934287617364 L 584.0792691831185 2316.138775537364 L 305.2914293132357 2316.138775537364 L 305.2914293132357 2262.232604647364 M 569.3775862131185 2262.232604647364 L 569.3775862131185 2276.934287617364 L 584.0792691831185 2276.934287617364" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="328.1607139332357" y="2285.101889267364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">secure session established, resume</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="328.1607139332357" y="2301.4370925673643" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">original request</text></g><g><rect fill="white" stroke="none" x="684.9138841313671" y="2340.6415804873636" width="127.11958564820313" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="687.3641646263671" y="2355.3432634573637" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /somecontent</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 444.6853492481771 2361.8773447773638 L 1038.8126872790936 2361.8773447773638" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1052.2620046627603,2361.8773447773638) translate(-1052.2620046627603,-2361.8773447773638)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1038.6493352460936 2355.0710100690303 L 1052.2620046627603 2361.8773447773638 L 1038.6493352460936 2368.683679485697 Z"/></g></g><g><rect fill="white" stroke="none" x="680.4221238774609" y="2386.3801497273635" width="136.10310615601563" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="682.8724043724609" y="2401.0818326973636" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 w/some content</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1052.2620046627603 2407.6159140173636 L 458.13466663184374 2407.6159140173636" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(444.6853492481771,2407.6159140173636) translate(-444.6853492481771,-2407.6159140173636)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 458.29801866484377 2400.80957930903 L 444.6853492481771 2407.6159140173636 L 458.29801866484377 2414.422248725697 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 16.335203300000003 1244.5494390573638 L 1186.8351974432096 1244.5494390573638 L 1186.8351974432096 2456.621523917364 L 16.335203300000003 2456.621523917364 L 16.335203300000003 1244.5494390573638 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 16.335203300000003 1244.5494390573638 L 16.335203300000003 1264.1516830173637 L 62.694406897070316 1264.1516830173637 L 72.49552887707031 1254.3505610373638 L 72.49552887707031 1244.5494390573638 L 16.335203300000003 1244.5494390573638" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="32.67040660000001" y="1257.6176016973636" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="86.38045168207032" y="1245.8562553213637" width="160.64361824097656" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="88.83073217707032" y="1257.6176016973636" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[bound cookie not required]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 16.335203300000003 1380.131626447364 L 1186.8351974432096 1380.131626447364" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray="4.083800825"/></g><g/><g><rect fill="white" stroke="none" x="86.38045168207032" y="1381.438442711364" width="139.14819587769531" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="88.83073217707032" y="1393.1997890873638" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[bound cookie required]</text></g><g/><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 32.6704066 1491.211008887364 L 1170.4999941432095 1491.211008887364 L 1170.4999941432095 2432.1187189673637 L 32.6704066 2432.1187189673637 L 32.6704066 1491.211008887364 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 32.6704066 1491.211008887364 L 32.6704066 1510.8132528473639 L 79.02961019707031 1510.8132528473639 L 88.83073217707032 1501.012130867364 L 88.83073217707032 1491.211008887364 L 32.6704066 1491.211008887364" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="49.005609899999996" y="1504.2791715273638" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="102.71565498207032" y="1492.517825151364" width="236.28714241089844" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="105.16593547707032" y="1504.2791715273638" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[required cookie present and not expired]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 32.6704066 1626.7931962773641 L 1170.4999941432095 1626.7931962773641" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray="4.083800825"/></g><g/><g><rect fill="white" stroke="none" x="102.71565498207032" y="1628.100012541364" width="207.6208216101172" height="16.988611432000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="105.16593547707032" y="1639.861358917364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[required cookie missing or expired]</text></g><g/></g></g></svg>