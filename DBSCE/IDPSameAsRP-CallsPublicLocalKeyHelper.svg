<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1827.2088068786109" height="1974.2875210228187"><desc>title%20IdP%20same%20as%20RP%2C%20calls%20a%20public%20Local%20Key%20Helper%0A%0Aautonumber%201%0Aparticipant%20%22Relying%20Party%22%20as%20W%0Aparticipant%20%22IdP%22%20as%20I%0Aparticipant%20%22Browser%22%20as%20B%0Aparticipant%20%22Local%20Key%20Helper%22%20as%20P%0Aparticipant%20%22AttestationService%22%20as%20A%0A%0Anote%20over%20W%2C%20A%3A%20Sign%20in...%0AW-%3E%3EB%3A%20Start%20sign%20in%20(302)%20%5Cn%5CnSec-Session-GenerateKey%3A%20%5CnRPUrl%2C%20IDPUrl%2C%20nonce%2C%20extraParams...%5Cn%5CnSec-Session-HelperIdList%3A%20%5Cn%5BHelperId1%2C%20HelperId2%5D%2C%20HelperCacheTime%0A%0AB-%3E%3EB%3A%20currentHelperId%20%3D%20%5CnEvaluate%20policy%20for%20(IdP%2C%20%5BHelperId1%2C%20HelperId2%2C...%5D)%0AB-%3E%3EP%3A%20Pre-gen%20key%20and%20%5Cnattest%20(RPUrl%2C%20IDPUrl%2C%20nonce%2C%20extratParams...)%0A%0AP-%3E%3EP%3A%20Generate%20Key%0A%0AP-%3E%3EA%3A%20Get%20Binding%20Statement%20%5Cn%20(publicKey%2C%20AIK%2C%20nonce)%0AA-%3E%3EP%3A%20Return%20binding%20statement%20%5Cn%7B%20nonce%2C%20thumbprint(publicKey)%2C%20extraClaims...%20%7D%0AP-%3E%3EB%3A%20KeyId%2C%20%5CnReturn%20binding%20statement%20%5Cn%7B%20nonce%2C%20thumbprint(publicKey)%2C%20extraClaims...%20%7D%0AB-%3E%3EB%3A%20Remember%20this%20key%20is%20for%20RP%20(and%20maybe%20path)%0AB-%3E%3EI%3A%20Load%20sign-in%20%5CnSec-Session-Keys%3A%20KeyId%2C%20%5CnBinding%20statement%20%7B%20nonce%2C%20%20thumbprint(publicKey)%2C%20extraClaims...%20%7D%0AI-%3E%3EI%3A%20validate%20signature%20%5Cnon%20the%20binding%20statement%20and%20nonce%2C%20%5Cnstore%20thumbprint%0A%0AI-%3E%3EB%3A%20Sign%20in%20ceremony%0AB-%3E%3EI%3A%20Sign%20done%0A%0AI-%3E%3EW%3A%20API(Auth%20tokens%20with%20thumbprint%2C%20KeyId)%0A%0Anote%20over%20W%2C%20A%3A%20Initiate%20DBSC%20...%0AW-%3E%3EB%3A%20200%20OK%20%5CnSec-Session-Registration%3A%20%5Cnpath%2C%20RPChallenge%2C%20token%3F%2C%20KeyId%2C%20extraParams%0AB-%3E%3EP%3A%20Request%20Sign%20JWT%20(uri%2C%20challenge%2C%20token%3F%2C%20keyId%3F%2C%20**extraParams...**)%0AP-%3E%3EB%3A%20Return%20JWT%20Signature%0AB-%3E%3EW%3A%20POST%20%2Fsecuresession%2Fstartsession%20(JWT%2C%20tokens)%0AW-%3E%3EW%3A%20Validate%20JWT%2C%20%5Cn(w%2F%20match%20thumbprint%20in%20the%20tokens)%0AW-%3E%3EB%3A%20AuthCookie%0A%0Anote%20over%20W%2C%20A%3A%20Refresh%20DBSC...%0AB-%3E%3EW%3A%20GET%20%2Fsecuresession%2Frefresh%20(sessionID)%0AW-%3E%3EB%3A%20Challenge%2C%20**extraParams...**%0AB-%3E%3EP%3A%20Request%20Sign%20JWT%20(sessionID%2C%20**extraParams...**)%0AP-%3E%3EB%3A%20Return%20JWT%20Signature%0AB-%3E%3EW%3A%20GET%20%2Fsecuresession%2Frefresh%20(JWT)%0AW-%3E%3EW%3A%20Validate%20JWT%20(w%2Fpublic%20key%20on%20file)%0AW-%3E%3EB%3A%20AuthCookie%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1827" height="1974"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 95.73914152281817 L 69.48111046292188 1974.2875210228187" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 393.34934607770055 95.73914152281817 L 393.34934607770055 1974.2875210228187" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 881.0042027862291 95.73914152281817 L 881.0042027862291 1974.2875210228187" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1380.0835437476876 95.73914152281817 L 1380.0835437476876 1974.2875210228187" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1742.2409486739898 95.73914152281817 L 1742.2409486739898 1974.2875210228187" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.167601649999995 51.79744464581818 L 130.79461927584376 51.79744464581818 L 130.79461927584376 95.73914152281817 L 8.167601649999995 95.73914152281817 L 8.167601649999995 51.79744464581818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.8912972305" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Relying Party</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 364.62350663733724 51.79744464581818 L 422.0751855180638 51.79744464581818 L 422.0751855180638 95.73914152281817 L 364.62350663733724 95.73914152281817 L 364.62350663733724 51.79744464581818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="382.34720221783726" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 836.3979159581705 51.79744464581818 L 925.6104896142878 51.79744464581818 L 925.6104896142878 95.73914152281817 L 836.3979159581705 95.73914152281817 L 836.3979159581705 51.79744464581818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="854.1216115386705" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Browser</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1306.5402604596682 51.79744464581818 L 1453.6268270357073 51.79744464581818 L 1453.6268270357073 95.73914152281817 L 1306.5402604596682 95.73914152281817 L 1306.5402604596682 51.79744464581818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1324.263956040168" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Local Key Helper</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1665.4406921193688 51.79744464581818 L 1819.041205228611 51.79744464581818 L 1819.041205228611 95.73914152281817 L 1665.4406921193688 95.73914152281817 L 1665.4406921193688 51.79744464581818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1683.1643876998687" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AttestationService</text></g></g><g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16pt" font-style="normal" font-weight="normal" text-decoration="normal" x="686.6554946899414" y="24.651306798181814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP same as RP, calls a public Local Key Helper</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 54.779427492921876 128.4095481228182 L 1742.2409486739898 128.4095481228182 L 1756.94263164399 143.1112310928182 L 1756.94263164399 165.98051571281817 L 54.779427492921876 165.98051571281817 L 54.779427492921876 128.4095481228182 M 1742.2409486739898 128.4095481228182 L 1742.2409486739898 143.1112310928182 L 1756.94263164399 143.1112310928182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="877.3392095000964" y="151.27883274281814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sign in...</text></g><g><rect fill="white" stroke="none" x="344.32426699871615" y="190.48332066281813" width="124.67859138550781" height="21.23576429"/><rect fill="white" stroke="none" x="344.32426699871615" y="223.1537272628181" width="186.61128486695313" height="21.23576429"/><rect fill="white" stroke="none" x="344.32426699871615" y="239.4889305628181" width="246.8546625525" height="21.23576429"/><rect fill="white" stroke="none" x="344.32426699871615" y="272.1593371628181" width="178.45093025269531" height="21.23576429"/><rect fill="white" stroke="none" x="344.32426699871615" y="288.49454046281807" width="274.0629755407812" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="346.77454749371617" y="205.1850036328181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Start sign in (302) </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="334.54835120465367" y="205.1850036328181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="346.77454749371617" y="237.8554102328181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-GenerateKey: </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="346.77454749371617" y="254.19061353281808" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RPUrl, IDPUrl, nonce, extraParams...</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="346.77454749371617" y="286.86102013281806" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-HelperIdList: </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="346.77454749371617" y="303.19622343281804" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[HelperId1, HelperId2], HelperCacheTime</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 309.73030475281814 L 878.9623023737291 309.73030475281814" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(881.0042027862291,309.73030475281814) translate(-881.0042027862291,-309.73030475281814)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 867.0089584031751 303.4869072671947 L 879.4739029206796 309.73030475281814 L 867.0089584031751 315.9737022384416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="912.5603896469584" y="334.2331097028182" width="122.6456781775" height="21.23576429"/><rect fill="white" stroke="none" x="912.5603896469584" y="350.5683130028182" width="326.4966913610937" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="915.0106701419584" y="348.93479267281816" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">currentHelperId = </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="902.7844738528959" y="348.93479267281816" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="915.0106701419584" y="365.26999597281815" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Evaluate policy for (IdP, [HelperId1, HelperId2,...])</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 881.0042027862291 371.80407729281814 L 946.3450159862291 371.80407729281814 L 946.3450159862291 393.03984158281816 L 883.0461031987292 393.03984158281816" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(881.0042027862291,393.03984158281816) translate(-881.0042027862291,-393.03984158281816)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 894.9994471692831 386.7964440971947 L 882.5345026517787 393.03984158281816 L 894.9994471692831 399.2832390684416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="986.347048887681" y="417.54264653281814" width="116.54689277710938" height="21.23576429"/><rect fill="white" stroke="none" x="986.347048887681" y="433.87784983281813" width="300.6198603064062" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="988.797329382681" y="432.2443295028181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Pre-gen key and </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="976.5711330936185" y="432.2443295028181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="988.797329382681" y="448.5795328028181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">attest (RPUrl, IDPUrl, nonce, extratParams...)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 881.0042027862291 455.11361412281815 L 1378.0416433351877 455.11361412281815" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1380.0835437476876,455.11361412281815) translate(-1380.0835437476876,-455.11361412281815)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1366.0882993646335 448.8702166371947 L 1378.553243882138 455.11361412281815 L 1366.0882993646335 461.3570116084416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="1411.6397306084168" y="479.61641907281813" width="95.35866035523438" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1414.0900111034168" y="494.3181020428181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate Key</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1401.8638148143543" y="494.3181020428181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1380.0835437476876 500.8521833628181 L 1445.4243569476876 500.8521833628181 L 1445.4243569476876 522.0879476528181 L 1382.1254441601875 522.0879476528181" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1380.0835437476876,522.0879476528181) translate(-1380.0835437476876,-522.0879476528181)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1394.0787881307417 515.8445501671947 L 1381.6138436132371 522.0879476528181 L 1394.0787881307417 528.3313451384415" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="1486.736341631366" y="546.5907526028182" width="156.47532905640625" height="21.23576429"/><rect fill="white" stroke="none" x="1486.736341631366" y="562.9259559028181" width="161.07800544800781" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1489.186622126366" y="561.2924355728181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Get Binding Statement </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1476.9604258373035" y="561.2924355728181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1489.186622126366" y="577.6276388728181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> (publicKey, AIK, nonce)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1380.0835437476876 584.1617201928182 L 1740.19904826149 584.1617201928182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1742.2409486739898,584.1617201928182) translate(-1742.2409486739898,-584.1617201928182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1728.2457042909357 577.9183227071948 L 1740.7106488084403 584.1617201928182 L 1728.2457042909357 590.4051176784416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="1411.6397306084168" y="608.6645251428182" width="172.77452339234375" height="21.23576429"/><rect fill="white" stroke="none" x="1411.6397306084168" y="624.9997284428182" width="311.2711969763281" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1414.0900111034168" y="623.3662081128182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return binding statement </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1401.8638148143543" y="623.3662081128182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1414.0900111034168" y="639.7014114128182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{ nonce, thumbprint(publicKey), extraClaims... }</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1742.2409486739898 646.2354927328182 L 1382.1254441601875 646.2354927328182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1380.0835437476876,646.2354927328182) translate(-1380.0835437476876,-646.2354927328182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1394.0787881307417 639.9920952471948 L 1381.6138436132371 646.2354927328182 L 1394.0787881307417 652.4788902184416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="981.0213576645365" y="670.7382976828183" width="50.53404487671875" height="21.23576429"/><rect fill="white" stroke="none" x="981.0213576645365" y="687.0735009828182" width="172.77452339234375" height="21.23576429"/><rect fill="white" stroke="none" x="981.0213576645365" y="703.4087042828182" width="311.2711969763281" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4716381595365" y="685.4399806528182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">KeyId, </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="971.245441870474" y="685.4399806528182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4716381595365" y="701.7751839528182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return binding statement </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="983.4716381595365" y="718.1103872528182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{ nonce, thumbprint(publicKey), extraClaims... }</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1380.0835437476876 724.6444685728183 L 883.0461031987292 724.6444685728183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(881.0042027862291,724.6444685728183) translate(-881.0042027862291,-724.6444685728183)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 894.9994471692831 718.4010710871949 L 882.5345026517787 724.6444685728183 L 894.9994471692831 730.8878660584417" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="912.5603896469584" y="749.1472735228182" width="310.4337030798437" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="915.0106701419584" y="763.8489564928182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Remember this key is for RP (and maybe path)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="902.7844738528959" y="763.8489564928182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 881.0042027862291 770.3830378128182 L 946.3450159862291 770.3830378128182 L 946.3450159862291 791.6188021028182 L 883.0461031987292 791.6188021028182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(881.0042027862291,791.6188021028182) translate(-881.0042027862291,-791.6188021028182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 894.9994471692831 785.3754046171948 L 882.5345026517787 791.6188021028182 L 894.9994471692831 797.8621995884416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="424.9055329384297" y="816.1216070528183" width="88.84468330445313" height="21.23576429"/><rect fill="white" stroke="none" x="424.9055329384297" y="832.4568103528183" width="178.45093025269531" height="21.23576429"/><rect fill="white" stroke="none" x="424.9055329384297" y="848.7920136528182" width="436.7686334997656" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="427.3558134334297" y="830.8232900228182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Load sign-in </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="415.1296171443672" y="830.8232900228182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="427.3558134334297" y="847.1584933228182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Keys: KeyId, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="427.3558134334297" y="863.4936966228182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Binding statement { nonce,  thumbprint(publicKey), extraClaims... }</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 881.0042027862291 870.0277779428183 L 395.39124649020056 870.0277779428183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(393.34934607770055,870.0277779428183) translate(-393.34934607770055,-870.0277779428183)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 407.3445904607546 863.7843804571949 L 394.87964594325 870.0277779428183 L 407.3445904607546 876.2711754284417" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="433.05871592182814" y="894.5305828928183" width="123.88403572144531" height="21.23576429"/><rect fill="white" stroke="none" x="433.05871592182814" y="910.8657861928183" width="246.1531702429297" height="21.23576429"/><rect fill="white" stroke="none" x="433.05871592182814" y="927.2009894928183" width="110.82750190796875" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="435.50899641682815" y="909.2322658628183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">validate signature </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="415.1296171443672" y="909.2322658628183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="435.50899641682815" y="925.5674691628183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">on the binding statement and nonce, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="435.50899641682815" y="941.9026724628183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">store thumbprint</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 393.34934607770055 948.4367537828183 L 458.69015927770056 948.4367537828183 L 458.69015927770056 969.6725180728183 L 395.39124649020056 969.6725180728183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(393.34934607770055,969.6725180728183) translate(-393.34934607770055,-969.6725180728183)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 407.3445904607546 963.4291205871949 L 394.87964594325 969.6725180728183 L 407.3445904607546 975.9159155584417" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="587.8796998085469" y="994.1753230228182" width="118.16464485230469" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="590.3299803035469" y="1008.8770059928182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sign in ceremony</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="570.7594846980782" y="1008.8770059928182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">11 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 393.34934607770055 1015.4110873128183 L 878.9623023737291 1015.4110873128183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(881.0042027862291,1015.4110873128183) translate(-881.0042027862291,-1015.4110873128183)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 867.0089584031751 1009.1676898271949 L 879.4739029206796 1015.4110873128183 L 867.0089584031751 1021.6544847984417" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="611.9025956215352" y="1039.9138922628183" width="70.92773689332031" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="614.3528761165352" y="1054.6155752328184" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sign done</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="593.9734968440742" y="1054.6155752328184" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">12 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 881.0042027862291 1061.1496565528182 L 395.39124649020056 1061.1496565528182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(393.34934607770055,1061.1496565528182) translate(-393.34934607770055,-1061.1496565528182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 407.3445904607546 1054.906259067195 L 394.87964594325 1061.1496565528182 L 407.3445904607546 1067.3930540384415" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="109.1904803070495" y="1085.6524615028184" width="264.82887519898435" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.6407608020495" y="1100.3541444728185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">API(Auth tokens with thumbprint, KeyId)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="91.26138152958856" y="1100.3541444728185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">13 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 393.34934607770055 1106.8882257928183 L 71.52301087542187 1106.8882257928183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(69.48111046292188,1106.8882257928183) translate(-69.48111046292188,-1106.8882257928183)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 83.4763548459759 1100.644828307195 L 71.01141032847136 1106.8882257928183 L 83.4763548459759 1113.1316232784416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 54.779427492921876 1131.3910307428182 L 1742.2409486739898 1131.3910307428182 L 1756.94263164399 1146.0927137128183 L 1756.94263164399 1168.9619983328182 L 54.779427492921876 1168.9619983328182 L 54.779427492921876 1131.3910307428182 M 1742.2409486739898 1131.3910307428182 L 1742.2409486739898 1146.0927137128183 L 1756.94263164399 1146.0927137128183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="853.71716207578" y="1154.2603153628183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Initiate DBSC ...</text></g><g><rect fill="white" stroke="none" x="326.9298654484232" y="1193.4648032828181" width="58.68724311890625" height="21.23576429"/><rect fill="white" stroke="none" x="326.9298654484232" y="1209.8000065828182" width="178.45093025269531" height="21.23576429"/><rect fill="white" stroke="none" x="326.9298654484232" y="1226.1352098828183" width="317.0049616247656" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="329.3801459434232" y="1208.1664862528182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 OK </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="309.00076667096226" y="1208.1664862528182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">14 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="329.3801459434232" y="1224.5016895528183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Registration: </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="329.3801459434232" y="1240.8368928528184" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">path, RPChallenge, token?, KeyId, extraParams</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 1247.3709741728183 L 878.9623023737291 1247.3709741728183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(881.0042027862291,1247.3709741728183) translate(-881.0042027862291,-1247.3709741728183)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 867.0089584031751 1241.127576687195 L 879.4739029206796 1247.3709741728183 L 867.0089584031751 1253.6143716584415" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="920.7135726303568" y="1271.8737791228184" width="334.91472114625" height="21.23576429"/><rect fill="white" stroke="none" x="920.7135726303568" y="1271.8737791228184" width="105.14390815796875" height="21.23576429"/><rect fill="white" stroke="none" x="920.7135726303568" y="1271.8737791228184" width="9.782442703867186" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="923.1638531253568" y="1286.5754620928185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Request Sign JWT (uri, challenge, token?, keyId?, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1253.1780132816068" y="1286.5754620928185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">extraParams...</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1353.4213604495756" y="1286.5754620928185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="902.7844738528959" y="1286.5754620928185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">15 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 881.0042027862291 1293.1095434128183 L 1378.0416433351877 1293.1095434128183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1380.0835437476876,1293.1095434128183) translate(-1380.0835437476876,-1293.1095434128183)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1366.0882993646335 1286.866145927195 L 1378.553243882138 1293.1095434128183 L 1366.0882993646335 1299.3529408984416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="1065.770777830552" y="1317.6123483628185" width="149.92557014527344" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1068.2210583255521" y="1332.3140313328186" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return JWT Signature</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1047.8416790530912" y="1332.3140313328186" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">16 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1380.0835437476876 1338.8481126528184 L 883.0461031987292 1338.8481126528184" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(881.0042027862291,1338.8481126528184) translate(-881.0042027862291,-1338.8481126528184)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 894.9994471692831 1332.604715167195 L 882.5345026517787 1338.8481126528184 L 894.9994471692831 1345.0915101384417" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="324.1167093204935" y="1363.3509176028185" width="322.631273880625" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="326.5669898154935" y="1378.0526005728186" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /securesession/startsession (JWT, tokens)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="306.1876105430326" y="1378.0526005728186" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">17 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 881.0042027862291 1384.5866818928184 L 71.52301087542187 1384.5866818928184" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(69.48111046292188,1384.5866818928184) translate(-69.48111046292188,-1384.5866818928184)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 83.4763548459759 1378.3432844071951 L 71.01141032847136 1384.5866818928184 L 83.4763548459759 1390.8300793784417" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="109.19048030704947" y="1409.0894868428186" width="97.50612129273438" height="21.23576429"/><rect fill="white" stroke="none" x="109.19048030704947" y="1425.4246901428187" width="233.85537971558594" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.64076080204947" y="1423.7911698128187" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate JWT, </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="91.26138152958853" y="1423.7911698128187" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">18 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.64076080204947" y="1440.1263731128188" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(w/ match thumbprint in the tokens)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 1446.6604544328186 L 134.82192366292188 1446.6604544328186 L 134.82192366292188 1467.8962187228185 L 71.52301087542187 1467.8962187228185" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(69.48111046292188,1467.8962187228185) translate(-69.48111046292188,-1467.8962187228185)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 83.4763548459759 1461.6528212371952 L 71.01141032847136 1467.8962187228185 L 83.4763548459759 1474.1396162084418" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="445.0865884708841" y="1492.3990236728187" width="80.69151557984375" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="447.53686896588414" y="1507.1007066428187" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthCookie</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="427.1574896934232" y="1507.1007066428187" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">19 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 1513.6347879628186 L 878.9623023737291 1513.6347879628186" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(881.0042027862291,1513.6347879628186) translate(-881.0042027862291,-1513.6347879628186)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 867.0089584031751 1507.3913904771953 L 879.4739029206796 1513.6347879628186 L 867.0089584031751 1519.8781854484419" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 54.779427492921876 1538.1375929128185 L 1742.2409486739898 1538.1375929128185 L 1756.94263164399 1552.8392758828186 L 1756.94263164399 1575.7085605028185 L 54.779427492921876 1575.7085605028185 L 54.779427492921876 1538.1375929128185 M 1742.2409486739898 1538.1375929128185 L 1742.2409486739898 1552.8392758828186 L 1756.94263164399 1552.8392758828186" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="851.6842336089832" y="1561.0068775328186" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Refresh DBSC...</text></g><g><rect fill="white" stroke="none" x="353.03581485027865" y="1600.2113654528187" width="264.7930780798437" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.48609534527867" y="1614.9130484228187" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh (sessionID)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="335.10671607281773" y="1614.9130484228187" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">20 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 881.0042027862291 1621.4471297428186 L 71.52301087542187 1621.4471297428186" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(69.48111046292188,1621.4471297428186) translate(-69.48111046292188,-1621.4471297428186)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 83.4763548459759 1615.2037322571953 L 71.01141032847136 1621.4471297428186 L 83.4763548459759 1627.6905272284419" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="395.77736911053256" y="1645.9499346928187" width="79.06660713257813" height="21.23576429"/><rect fill="white" stroke="none" x="395.77736911053256" y="1645.9499346928187" width="105.14390815796875" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="398.2276496055326" y="1660.6516176628188" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Challenge, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="472.3936957481107" y="1660.6516176628188" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">extraParams...</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="377.84827033307164" y="1660.6516176628188" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">21 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 1667.1856989828186 L 878.9623023737291 1667.1856989828186" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(881.0042027862291,1667.1856989828186) translate(-881.0042027862291,-1667.1856989828186)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 867.0089584031751 1660.9423014971953 L 879.4739029206796 1667.1856989828186 L 867.0089584031751 1673.429096468442" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="983.8810454697123" y="1691.6885039328188" width="208.5798059851172" height="21.23576429"/><rect fill="white" stroke="none" x="983.8810454697123" y="1691.6885039328188" width="105.14390815796875" height="21.23576429"/><rect fill="white" stroke="none" x="983.8810454697123" y="1691.6885039328188" width="9.782442703867186" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="986.3313259647123" y="1706.3901869028189" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Request Sign JWT (sessionID, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1190.0105709598295" y="1706.3901869028189" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">extraParams...</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1290.2539181277982" y="1706.3901869028189" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="965.9519466922513" y="1706.3901869028189" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">22 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 881.0042027862291 1712.9242682228187 L 1378.0416433351877 1712.9242682228187" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1380.0835437476876,1712.9242682228187) translate(-1380.0835437476876,-1712.9242682228187)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1366.0882993646335 1706.6808707371954 L 1378.553243882138 1712.9242682228187 L 1366.0882993646335 1719.167665708442" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="1065.770777830552" y="1737.4270731728188" width="149.92557014527344" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1068.2210583255521" y="1752.128756142819" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return JWT Signature</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1047.8416790530912" y="1752.128756142819" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">23 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1380.0835437476876 1758.6628374628187 L 883.0461031987292 1758.6628374628187" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(881.0042027862291,1758.6628374628187) translate(-881.0042027862291,-1758.6628374628187)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 894.9994471692831 1752.4194399771955 L 882.5345026517787 1758.6628374628187 L 894.9994471692831 1764.906234948442" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="370.15820559734897" y="1783.165642412819" width="230.54828132691406" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="372.608486092349" y="1797.867325382819" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh (JWT)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="352.22910681988805" y="1797.867325382819" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">24 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 881.0042027862291 1804.4014067028188 L 71.52301087542187 1804.4014067028188" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(69.48111046292188,1804.4014067028188) translate(-69.48111046292188,-1804.4014067028188)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 83.4763548459759 1798.1580092171955 L 71.01141032847136 1804.4014067028188 L 83.4763548459759 1810.644804188442" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="109.19048030704947" y="1828.9042116528187" width="227.86395515503906" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.64076080204947" y="1843.6058946228188" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate JWT (w/public key on file)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="91.26138152958853" y="1843.6058946228188" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">25 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 1850.1399759428189 L 134.82192366292188 1850.1399759428189 L 134.82192366292188 1871.3757402328188 L 71.52301087542187 1871.3757402328188" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(69.48111046292188,1871.3757402328188) translate(-69.48111046292188,-1871.3757402328188)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 83.4763548459759 1865.1323427471955 L 71.01141032847136 1871.3757402328188 L 83.4763548459759 1877.619137718442" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="445.0865884708841" y="1895.878545182819" width="80.69151557984375" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="447.53686896588414" y="1910.580228152819" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthCookie</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="427.1574896934232" y="1910.580228152819" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">26 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 1917.1143094728188 L 878.9623023737291 1917.1143094728188" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(881.0042027862291,1917.1143094728188) translate(-881.0042027862291,-1917.1143094728188)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 867.0089584031751 1910.8709119871955 L 879.4739029206796 1917.1143094728188 L 867.0089584031751 1923.3577069584421" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g></g></g></svg>