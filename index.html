<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Device Bound Session Credentials</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <link href="https://www.w3.org/StyleSheets/TR/2021/cg-draft" rel="stylesheet">
  <meta content="Bikeshed version 82ce88815, updated Thu Sep 7 16:33:55 2023 -0700" name="generator">
  <link href="https://wicg.github.io/dbsc/" rel="canonical">
  <meta content="fb0a4a7f6183d0d9104c8ea4ee1c37bf76801658" name="document-revision">
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    white-space: pre;
    display: inline-block;
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled[role="button"] { cursor: pointer; }
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    white-space: pre;
    display: inline-block;
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled[role="button"] { cursor: pointer; }
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */

code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */


@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
<style>/* Boilerplate: style-var-click-highlighting */
/*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)
*/
var { cursor: pointer; }
var.selected0 { background-color: #F4D200; box-shadow: 0 0 0 2px #F4D200; }
var.selected1 { background-color: #FF87A2; box-shadow: 0 0 0 2px #FF87A2; }
var.selected2 { background-color: #96E885; box-shadow: 0 0 0 2px #96E885; }
var.selected3 { background-color: #3EEED2; box-shadow: 0 0 0 2px #3EEED2; }
var.selected4 { background-color: #EACFB6; box-shadow: 0 0 0 2px #EACFB6; }
var.selected5 { background-color: #82DDFF; box-shadow: 0 0 0 2px #82DDFF; }
var.selected6 { background-color: #FFBCF2; box-shadow: 0 0 0 2px #FFBCF2; }
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Device Bound Session Credentials</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#CG-DRAFT">Draft Community Group Report</a>, <time class="dt-updated" datetime="2024-09-17">17 September 2024</time></p>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://wicg.github.io/dbsc/">https://wicg.github.io/dbsc/</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/WICG/dbsc/issues/">GitHub</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard" data-editor-id="76841"><a class="p-name fn u-email email" href="mailto:kristianm@google.com">Kristian Monsen</a> (<span class="p-org org">Google</span>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 2024 the Contributors to the Device Bound Session Credentials Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>The Device Bound Sessions Credentials (DBSC) aims to prevent hijacking via cookie theft by building a protocol and infrastructure that allows a user agent to assert possession of a securely-stored private key. DBSC is a Web API and a protocol between user agents and servers to achieve this binding.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li>
       <a href="#examples"><span class="secno">1.1</span> <span class="content">Examples</span></a>
       <ol class="toc">
        <li><a href="#example-signin"><span class="secno">1.1.1</span> <span class="content">Signed in session</span></a>
        <li><a href="#example-device-integrity"><span class="secno">1.1.2</span> <span class="content">Device integrity</span></a>
        <li><a href="#example-device-reputation"><span class="secno">1.1.3</span> <span class="content">Device reputation</span></a>
       </ol>
     </ol>
    <li>
     <a href="#privacy"><span class="secno">2</span> <span class="content">Security Considerations</span></a>
     <ol class="toc">
      <li><a href="#non-goals"><span class="secno">2.1</span> <span class="content">Non-goals</span></a>
     </ol>
    <li>
     <a href="#privacy-considerations"><span class="secno">3</span> <span class="content">Privacy Considerations</span></a>
     <ol class="toc">
      <li><a href="#privacy-cookies"><span class="secno">3.1</span> <span class="content">Cookies considerations</span></a>
      <li><a href="#privacy-side-channel-leak"><span class="secno">3.2</span> <span class="content">Timing side channel leak</span></a>
     </ol>
    <li>
     <a href="#alternatives"><span class="secno">4</span> <span class="content">Alternatives considered</span></a>
     <ol class="toc">
      <li><a href="#alternatives-webauthn"><span class="secno">4.1</span> <span class="content">WebAuthn and silent mediation</span></a>
     </ol>
    <li>
     <a href="#framework"><span class="secno">5</span> <span class="content">Framework</span></a>
     <ol class="toc">
      <li><a href="#framework-sessions-origin"><span class="secno">5.1</span> <span class="content">Sessions by registrable domain</span></a>
      <li><a href="#framework-sessions-id"><span class="secno">5.2</span> <span class="content">Sessions by id</span></a>
      <li><a href="#framework-session"><span class="secno">5.3</span> <span class="content">Device bound session</span></a>
      <li><a href="#framework-scope"><span class="secno">5.4</span> <span class="content">Session scope</span></a>
      <li><a href="#framework-scope-specification"><span class="secno">5.5</span> <span class="content">Scope specification</span></a>
      <li><a href="#framework-session-credential"><span class="secno">5.6</span> <span class="content">Session credential</span></a>
     </ol>
    <li>
     <a href="#algorithms"><span class="secno">6</span> <span class="content">Algorithms</span></a>
     <ol class="toc">
      <li><a href="#algo-identify-session"><span class="secno">6.1</span> <span class="content">Identify session</span></a>
      <li><a href="#algo-process-challenge"><span class="secno">6.2</span> <span class="content">Process challenge</span></a>
      <li><a href="#algo-session-refresh"><span class="secno">6.3</span> <span class="content">Session refresh</span></a>
      <li><a href="#algo-session-request"><span class="secno">6.4</span> <span class="content">Send request</span></a>
      <li><a href="#algo-create-session"><span class="secno">6.5</span> <span class="content">Create session</span></a>
      <li><a href="#algo-close-session"><span class="secno">6.6</span> <span class="content">Closing session</span></a>
      <li><a href="#algo-fetch-integration"><span class="secno">6.7</span> <span class="content">Fetch Integration</span></a>
     </ol>
    <li>
     <a href="#format"><span class="secno">7</span> <span class="content">DBSC Formats</span></a>
     <ol class="toc">
      <li><a href="#header-sec-session-registration"><span class="secno">7.1</span> <span class="content">`<code>Sec-Session-Registration</code>` HTTP header field</span></a>
      <li>
       <a href="#header-sec-session-challenge"><span class="secno">7.2</span> <span class="content">`<code>Sec-Session-Challenge</code>` HTTP Header Field</span></a>
       <ol class="toc">
        <li><a href="#challenge-structured-header-serialization"><span class="secno">7.2.1</span> <span class="content">Sec-Session-Challenge structured header serialization</span></a>
       </ol>
      <li><a href="#header-sec-session-response"><span class="secno">7.3</span> <span class="content"><code>Sec-Session-Response</code> HTTP Header Field</span></a>
      <li><a href="#header-sec-session-id"><span class="secno">7.4</span> <span class="content"><code>Sec-Session-Id</code> HTTP Header Field</span></a>
      <li><a href="#format-session-instructions"><span class="secno">7.5</span> <span class="content">DBSC Session Instruction Format</span></a>
      <li><a href="#format-jwt"><span class="secno">7.6</span> <span class="content">DBSC Proof JWT Syntax</span></a>
     </ol>
    <li>
     <a href="#changes-to-other-specifications"><span class="secno">8</span> <span class="content">Changes to other specifications</span></a>
     <ol class="toc">
      <li><a href="#changes-to-fetch"><span class="secno">8.1</span> <span class="content">Changes to the Fetch specification</span></a>
      <li><a href="#changes-to-html"><span class="secno">8.2</span> <span class="content">Changes to the HTML specification</span></a>
     </ol>
    <li>
     <a href="#iana-considerations"><span class="secno">9</span> <span class="content">IANA Considerations</span></a>
     <ol class="toc">
      <li><a href="#iana-ses-session-challenge"><span class="secno">9.1</span> <span class="content">Sec-Session-Challenge</span></a>
      <li><a href="#iana-ses-session-id"><span class="secno">9.2</span> <span class="content">Sec-Session-Id</span></a>
      <li><a href="#iana-sec-session-registration"><span class="secno">9.3</span> <span class="content">Sec-Session-Registration</span></a>
      <li><a href="#iana-ses-session-response"><span class="secno">9.4</span> <span class="content">Sec-Session-Response</span></a>
     </ol>
    <li><a href="#changelog"><span class="secno">10</span> <span class="content">Changelog</span></a>
    <li><a href="#acknowledgements"><span class="secno">11</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p><em>This section is not normative.</em><br> <em>Note this is a very early drafting for writing collaboration only</em></p>
   <p>The web is built on a stateless protocol, to provide required functionality Web
applications store data locally on a user’s computer in order to provide
functionality the are very common today. Primarily this is used for logged in
user sessions that can last for a long time.</p>
   <p>In general user agents do not have a secure way of storing files supporting
these activities across commonly used operating systems, and actions may have
serious consequences, for example transferring money from a bank account.</p>
   <p>This document defines a new API, Device Bound Sessions Credentials (DBSC), that
enables the server to verify that a session cannot be exported from a device by
using commonly available TPMs, or similar APIs, that are designed for this
purpose.</p>
   <p>The goal is to provide users with a safe and secure experience, while offering
the use cases users are already used to. At the same time we want to ensure that
the users privacy is respected with no new privacy identifiers being leaked by
this protocol.</p>
   <h3 class="heading settled" data-level="1.1" id="examples"><span class="secno">1.1. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h3>
    Device Bound Session Credentials are designed to make users more secure in
different situations. Some of the use cases of DBSC are: 
   <h4 class="heading settled" data-level="1.1.1" id="example-signin"><span class="secno">1.1.1. </span><span class="content">Signed in session</span><a class="self-link" href="#example-signin"></a></h4>
   <div class="example" id="signin-example"><a class="self-link" href="#signin-example"></a> A user logs in to his social account, to protect the user’s private data the
  site protects his logged in session wwith a DBSC session. If the user tries to
  log with the same cookie file on a different device, the site can detect and
  refuse this as an unathorized user. </div>
   <h4 class="heading settled" data-level="1.1.2" id="example-device-integrity"><span class="secno">1.1.2. </span><span class="content">Device integrity</span><a class="self-link" href="#example-device-integrity"></a></h4>
   <div class="example" id="device-integrity-example"><a class="self-link" href="#device-integrity-example"></a> A commercial site has different ways of detecting unahtorized log-in attempts.
  A DBSC session on device could be used to see which users has logged on to
  this device before. </div>
   <h4 class="heading settled" data-level="1.1.3" id="example-device-reputation"><span class="secno">1.1.3. </span><span class="content">Device reputation</span><a class="self-link" href="#example-device-reputation"></a></h4>
   <div class="example" id="device-reputation-example"><a class="self-link" href="#device-reputation-example"></a> A payment company hosted at site <code>payment.example</code> could create a session bound
  to when users visit commercial site <code>shopping.example</code>. It could track the
  reliability of the device over time to decide how likely a transaction is
  legitimate. </div>
   <h2 class="heading settled" data-level="2" id="privacy"><span class="secno">2. </span><span class="content">Security Considerations</span><a class="self-link" href="#privacy"></a></h2>
    The goal of DBSC is to reduce session theft by offering an alternative to
long-lived cookie bearer tokens, that allows session authentication that is
bound to the user’s device. This makes the internet safer for users in that it
is less likely their identity is abused, as malware is forced to act locally and
thus becomes easier to detect and mitigate. At the same time the goal is to
disrupt the cookie theft ecosystem and force it to adapt to new protections long
term. 
   <p>As long as the session is valid a host can know with cryptographic certainty
that it is on the same device as the session was originally bound to if the
session was registered to a secure device.</p>
   <h3 class="heading settled" data-level="2.1" id="non-goals"><span class="secno">2.1. </span><span class="content">Non-goals</span><a class="self-link" href="#non-goals"></a></h3>
    DBSC will not prevent temporary access to the browser session while the attacker
is resident on the user’s device. The private key should be stored as safe as
modern operating systems allow, preventing exfiltration of the session private
key, but the signing capability will still be available for any program running
as the user on the user’s device. 
   <p>DBSC will also not prevent an attack if the attacker is replacing or injecting
into the user agent at the time of session registration as the attacker can bind
the session either to keys that are not TPM bound, or to a TPM that the attacker
controls permanently.</p>
   <p>DBSC is not designed to give hosts any sort of guarantee about the device a
session is registered to, or the state of this device.</p>
   <h2 class="heading settled" data-level="3" id="privacy-considerations"><span class="secno">3. </span><span class="content">Privacy Considerations</span><a class="self-link" href="#privacy-considerations"></a></h2>
    The goal of the DBSC protocol is to introduce no additional surface for user
tracking: implementing this API (for a browser) or enabling it (for a website)
should not entail any significant user privacy tradeoffs. 
   <p>Some of the consideration taken to ensure this:</p>
   <ul>
    <li data-md>
     <p>Lifetime of a session/key material: This should provide no additional client
data storage (i.e., a pseudo-cookie). As such, we require that browsers MUST
clear sessions and keys when clearing other site data (like cookies).</p>
    <li data-md>
     <p>Implementing this API should not meaningfully increase the entropy of
heuristic device fingerprinting signals. Unless allowed by user policy, DBSC
should not leak any stable TPM-based device identifier.</p>
    <li data-md>
     <p>As this API MAY allow background "pings" for performance, this must not enable
long-term tracking of a user when they have navigated away from the connected
site.</p>
    <li data-md>
     <p>Each session has a separate new key created, and it should not be possible to
detect that different sessions are from the same device unless the user allows
this by policy.</p>
   </ul>
   <h3 class="heading settled" data-level="3.1" id="privacy-cookies"><span class="secno">3.1. </span><span class="content">Cookies considerations</span><a class="self-link" href="#privacy-cookies"></a></h3>
    Cross-site/cross-origin data leakage: It should be impossible for a site to use
this API to circumvent the same origin policy, 3P cookie policies, etc. 
   <p>Due to the complexity of current and changing cookie behavior and the
interaction between DBSC and cookies the current solution is that each user
agent should use the same policy for DBSC as it uses for cookies. If the DBSC
cookie credential would not apply to a network request, based on user settings,
applied policies or user agent implementation details, neither would any of the
DBSC heuristics. This ensures no new privacy behavior due to implementing DBSC.</p>
   <h3 class="heading settled" data-level="3.2" id="privacy-side-channel-leak"><span class="secno">3.2. </span><span class="content">Timing side channel leak</span><a class="self-link" href="#privacy-side-channel-leak"></a></h3>
    If third party cookies are enabled it is possible for an attacker to leak
whether or not a user is authenticated by measuring how long the request takes
as the refresh is quite slow, partially due to the latency of TPM operations. 
   <p>This only applies if the site to be leaked about has enabled third party
cookies, if an attacker does have third-party cookie access there are often
attackes and leaks.</p>
   <p>This is not a very reliable leak as the user needs to have a session on the site
that is currently out of date and would need to be refreshed. The leak cannot be
trivially repeated as the first request will renew the session that would likely
not expire again for some time.</p>
   <p>It is important websites think about this privacy leak before adopting DBSC,
even more so if the plan is to use sessions with third party cookies.</p>
   <h2 class="heading settled" data-level="4" id="alternatives"><span class="secno">4. </span><span class="content">Alternatives considered</span><a class="self-link" href="#alternatives"></a></h2>
   <h3 class="heading settled" data-level="4.1" id="alternatives-webauthn"><span class="secno">4.1. </span><span class="content">WebAuthn and silent mediation</span><a class="self-link" href="#alternatives-webauthn"></a></h3>
   <h2 class="heading settled" data-level="5" id="framework"><span class="secno">5. </span><span class="content">Framework</span><a class="self-link" href="#framework"></a></h2>
    This document uses ABNF grammar to specify syntax, as defined in <a data-link-type="biblio" href="#biblio-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a> and updated in <a data-link-type="biblio" href="#biblio-rfc7405" title="Case-Sensitive String Support in ABNF">[RFC7405]</a>, along with the <code>#rule</code> extension defined in <a href="https://tools.ietf.org/html/rfc7230#section-7">Section 7</a> of <a data-link-type="biblio" href="#biblio-rfc9112" title="HTTP/1.1">[RFC9112]</a>, and the <code>quoted-string</code> rule defined in <a href="https://tools.ietf.org/html/rfc7230#section-3.2.6">Section 3.2.6</a> of the same document. 
   <p>This document depends on the Infra Standard for a number of foundational
concepts used in its algorithms and prose <a data-link-type="biblio" href="#biblio-infra" title="Infra Standard">[INFRA]</a>.</p>
   <h3 class="heading settled" data-level="5.1" id="framework-sessions-origin"><span class="secno">5.1. </span><span class="content">Sessions by registrable domain</span><a class="self-link" href="#framework-sessions-origin"></a></h3>
    A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="registrable-domain-sessions">registrable domain sessions</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map">ordered map</a> from <a data-link-type="dfn" href="https://url.spec.whatwg.org/#host-registrable-domain" id="ref-for-host-registrable-domain">registrable domain</a> to <a data-link-type="dfn" href="#session-by-id" id="ref-for-session-by-id">session by id</a>. 
   <h3 class="heading settled" data-level="5.2" id="framework-sessions-id"><span class="secno">5.2. </span><span class="content">Sessions by id</span><a class="self-link" href="#framework-sessions-id"></a></h3>
    A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="session-by-id">session by id</dfn> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①">ordered map</a> from <a data-link-type="dfn" href="#device-bound-session-session-identifier" id="ref-for-device-bound-session-session-identifier">session identifier</a> to <a data-link-type="dfn" href="#device-bound-session" id="ref-for-device-bound-session">device bound session</a>s for a
given <a data-link-type="dfn" href="https://url.spec.whatwg.org/#host-registrable-domain" id="ref-for-host-registrable-domain①">registrable domain</a>. 
   <h3 class="heading settled" data-level="5.3" id="framework-session"><span class="secno">5.3. </span><span class="content">Device bound session</span><a class="self-link" href="#framework-session"></a></h3>
    A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="device-bound-session">device bound session</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct">struct</a> with the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item">items</a>: 
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="device bound session" data-dfn-type="dfn" data-noexport id="device-bound-session-session-identifier">session identifier</dfn>
    <dd data-md>
     <p>an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string">string</a> that is a unique identifier of a session on an <a data-link-type="dfn" href="https://url.spec.whatwg.org/#host-registrable-domain" id="ref-for-host-registrable-domain②">registrable domain</a></p>
    <dt data-md><dfn data-dfn-for="device bound session" data-dfn-type="dfn" data-noexport id="device-bound-session-refresh-url">refresh url<a class="self-link" href="#device-bound-session-refresh-url"></a></dfn>
    <dd data-md>
     <p>an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①">string</a> that is representing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url">url</a> to be used to refresh the
session</p>
    <dt data-md><dfn data-dfn-for="device bound session" data-dfn-type="dfn" data-noexport id="device-bound-session-defer-requests">defer requests<a class="self-link" href="#device-bound-session-defer-requests"></a></dfn>
    <dd data-md>
     <p>an OPTIONAL <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean" id="ref-for-boolean">boolean</a> defining if the browser should defer other
requests while refreshing a session</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="device bound session" data-dfn-type="dfn" data-noexport id="device-bound-session-cached-challenge">cached challenge</dfn>
    <dd data-md>
     <p>an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②">string</a> that is to be used as the next challenge for this session</p>
    <dt data-md><a data-link-type="dfn" href="#session-scope" id="ref-for-session-scope">session scope</a>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct①">struct</a> defining which <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①">url</a>'s' are in scope for this session</p>
    <dt data-md><a data-link-type="dfn" href="#session-credential" id="ref-for-session-credential">session credential</a>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list">list</a> of <a data-link-type="dfn" href="#session-credential" id="ref-for-session-credential①">session credential</a> used by the session</p>
   </dl>
   <h3 class="heading settled" data-level="5.4" id="framework-scope"><span class="secno">5.4. </span><span class="content">Session scope</span><a class="self-link" href="#framework-scope"></a></h3>
    The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="session-scope">session scope</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct②">struct</a> with the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item①">items</a>: 
   <dl>
    <dt data-md><dfn data-dfn-for="session scope" data-dfn-type="dfn" data-noexport id="session-scope-include-site">include site<a class="self-link" href="#session-scope-include-site"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean" id="ref-for-boolean①">boolean</a> that indicates if all subdomains of are included by
default.</p>
    <dt data-md><a data-link-type="dfn" href="#scope-specification" id="ref-for-scope-specification">scope specification</a>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①">list</a> of <a data-link-type="dfn" href="#scope-specification" id="ref-for-scope-specification①">scope specification</a> used by the session</p>
   </dl>
   <h3 class="heading settled" data-level="5.5" id="framework-scope-specification"><span class="secno">5.5. </span><span class="content">Scope specification</span><a class="self-link" href="#framework-scope-specification"></a></h3>
    The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="scope-specification">scope specification</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct③">struct</a> with the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item②">items</a>: 
   <dl>
    <dt data-md><dfn data-dfn-for="scope specification" data-dfn-type="dfn" data-noexport id="scope-specification-type">type<a class="self-link" href="#scope-specification-type"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string③">string</a> to be either "include" or "exclude", defining if the item
defined in this struct should be added or removed from the scope</p>
    <dt data-md><dfn data-dfn-for="scope specification" data-dfn-type="dfn" data-noexport id="scope-specification-path">path<a class="self-link" href="#scope-specification-path"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string④">string</a> that defines the path part of this scope item</p>
   </dl>
   <h3 class="heading settled" data-level="5.6" id="framework-session-credential"><span class="secno">5.6. </span><span class="content">Session credential</span><a class="self-link" href="#framework-session-credential"></a></h3>
    The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="session-credential">session credential</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct④">struct</a> with the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item③">items</a>: 
   <dl>
    <dt data-md><dfn data-dfn-for="session credential" data-dfn-type="dfn" data-noexport id="session-credential-name">name<a class="self-link" href="#session-credential-name"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string⑤">string</a> that defines the name of the credential cookie</p>
    <dt data-md><dfn data-dfn-for="session credential" data-dfn-type="dfn" data-noexport id="session-credential-attributes">attributes<a class="self-link" href="#session-credential-attributes"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string⑥">string</a> that defines the other attributes of the credential cookie</p>
   </dl>
   <h2 class="heading settled" data-level="6" id="algorithms"><span class="secno">6. </span><span class="content">Algorithms</span><a class="self-link" href="#algorithms"></a></h2>
   <h3 class="heading settled" data-level="6.1" id="algo-identify-session"><span class="secno">6.1. </span><span class="content">Identify session</span><a class="self-link" href="#algo-identify-session"></a></h3>
   <div class="algorithm" data-algorithm="identify-session">
     This algorithm describes how to <dfn class="dfn-paneled" data-dfn-for="algorithms" data-dfn-type="dfn" data-export id="algorithms-identify-a-session">identify a session</dfn> out of all the
  sessions that exist on a user agent. The <a data-link-type="dfn" href="#device-bound-session-session-identifier" id="ref-for-device-bound-session-session-identifier①">session identifier</a> is unique within a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#host-registrable-domain" id="ref-for-host-registrable-domain③">registrable domain</a>. 
    <p>Given a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url②">url</a> and <a data-link-type="dfn" href="#device-bound-session-session-identifier" id="ref-for-device-bound-session-session-identifier②">session identifier</a> (<var>session identifier</var>), this algorithm returns a <a data-link-type="dfn" href="#device-bound-session" id="ref-for-device-bound-session①">device bound session</a> or
  null if no such session exists.</p>
    <ol>
     <li data-md>
      <p>Let <var>site</var> be the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#host-registrable-domain" id="ref-for-host-registrable-domain④">registrable domain</a> of the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url③">url</a></p>
     <li data-md>
      <p>Let <var>domain sessions</var> be <a data-link-type="dfn" href="#registrable-domain-sessions" id="ref-for-registrable-domain-sessions">registrable domain sessions</a>[<var>site</var>] as a <a data-link-type="dfn" href="#session-by-id" id="ref-for-session-by-id①">session by id</a></p>
     <li data-md>
      <p>Return <var>domain sessions</var>[<var>session identifier</var>]</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="6.2" id="algo-process-challenge"><span class="secno">6.2. </span><span class="content">Process challenge</span><a class="self-link" href="#algo-process-challenge"></a></h3>
   <div class="algorithm" data-algorithm="process-challenge">
     This algorithm describes how to <dfn data-dfn-for="algorithms" data-dfn-type="dfn" data-export id="algorithms-process-a-challenge">process a challenge<a class="self-link" href="#algorithms-process-a-challenge"></a></dfn> received in an HTTP
  header. 
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-response" id="ref-for-concept-response-response">response</a> (<var>response</var>), a <a data-link-type="dfn" href="#registrable-domain-sessions" id="ref-for-registrable-domain-sessions①">registrable domain sessions</a>, this
  algorithm updates the <a data-link-type="dfn" href="#device-bound-session-cached-challenge" id="ref-for-device-bound-session-cached-challenge">cached challenge</a> for a <a data-link-type="dfn" href="#device-bound-session" id="ref-for-device-bound-session②">device bound session</a>, or immediatly resends the <a data-link-type="dfn" href="#dbsc-proof" id="ref-for-dbsc-proof">DBSC proof</a> signed with
  the new challenge if the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-status" id="ref-for-concept-response-status">status</a> is 401.</p>
    <ol>
     <li data-md>
      <p>Let <var>header name</var> be "<code>Sec-Session-Challenge</code>".</p>
     <li data-md>
      <p>Let <var>challenge list</var> be the result of executing <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-get-structured-header" id="ref-for-concept-header-list-get-structured-header">get a structured
field value</a> given <var>header name</var> and "list" from <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list">header list</a>. <a data-link-type="dfn" href="https://datatracker.ietf.org/doc/html/rfc8941#text-parse" id="ref-for-text-parse">parsing structured fields</a></p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate">For each</a> <var>challenge entry</var> of <var>challenge list</var>:</p>
      <ol>
       <li data-md>
        <p>Parse <var>challenge entry</var> according to <a data-link-type="dfn" href="https://datatracker.ietf.org/doc/html/rfc8941#text-parse" id="ref-for-text-parse①">parsing structured fields</a>.</p>
       <li data-md>
        <p>If the type of <var>challenge entry</var> is not string <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue">continue</a>.</p>
       <li data-md>
        <p>Let <var>challenge</var> be the parsed item.</p>
       <li data-md>
        <p>Let <var>session id</var> be null.</p>
       <li data-md>
        <p>If params["id"] exists and is a string, Set <var>session id</var> to params["id"]</p>
       <li data-md>
        <p>If <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-status" id="ref-for-concept-response-status①">status</a> is 401, resend this request as is with updated <var>challenge</var> in <a data-link-type="dfn" href="#dbsc-proof" id="ref-for-dbsc-proof①">DBSC proof</a></p>
       <li data-md>
        <p>Otherwise:</p>
        <ol>
         <li data-md>
          <p>If <var>session id</var> is null, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue①">continue</a></p>
         <li data-md>
          <p>Identify session as described in <a data-link-type="dfn" href="#algorithms-identify-a-session" id="ref-for-algorithms-identify-a-session">identify a session</a> given <var>response</var> and <var>session id</var> and store as <var>session object</var>.</p>
         <li data-md>
          <p>Store <var>challenge</var> in <var>session object</var> to be used next time a <a data-link-type="dfn" href="#dbsc-proof" id="ref-for-dbsc-proof②">DBSC proof</a> is to be sent from this <a data-link-type="dfn" href="#device-bound-session" id="ref-for-device-bound-session③">device bound session</a>.</p>
        </ol>
      </ol>
    </ol>
   </div>
   <h3 class="heading settled" data-level="6.3" id="algo-session-refresh"><span class="secno">6.3. </span><span class="content">Session refresh</span><a class="self-link" href="#algo-session-refresh"></a></h3>
    To <dfn data-dfn-type="dfn" data-export id="refresh-session">Refreshing an existing session<a class="self-link" href="#refresh-session"></a></dfn> 
   <h3 class="heading settled" data-level="6.4" id="algo-session-request"><span class="secno">6.4. </span><span class="content">Send request</span><a class="self-link" href="#algo-session-request"></a></h3>
   <h3 class="heading settled" data-level="6.5" id="algo-create-session"><span class="secno">6.5. </span><span class="content">Create session</span><a class="self-link" href="#algo-create-session"></a></h3>
    To <dfn data-dfn-type="dfn" data-export id="create-session">Create a new session<a class="self-link" href="#create-session"></a></dfn>, start with
parsing the registration structured header defined in <span>`<code><a data-link-type="http-header" href="#sec-session-registration-header" id="ref-for-sec-session-registration-header">Sec-Session-Registration</a></code>`</span>: 
   <div class="algorithm" data-algorithm="process-registration">
    <ol>
     <li data-md>
      <p>Let <var>header name</var> be "<code>Sec-Session-Registration</code>".</p>
     <li data-md>
      <p>Let <var>registration list</var> be the result of executing <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-get-structured-header" id="ref-for-concept-header-list-get-structured-header①">get a structured
field value</a> given <var>header name</var> and "list" from <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list①">header list</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate①">For each</a> <var>registration entry</var>, <var>params</var> → <var>registration list</var>:</p>
      <ol>
       <li data-md>
        <p>Parse <var>registration entry</var> as an innner list. Let <var>algorithm list</var> be a
list of tokens from the inner list where only algorithms supported on this
client should be added. If this list is empty return failure.</p>
       <li data-md>
        <p>If <var>params</var>["path"] exists and is a string let <var>path</var> be <var>params</var>["path"]</p>
       <li data-md>
        <p>Otherwise return failure.</p>
       <li data-md>
        <p>Let <var>challenge</var> be null and Let <var>authorization</var> be null.</p>
       <li data-md>
        <p>If <var>params</var>["challenge"] exists and is a string Set <var>challenge</var> to <var>params</var>["challenge"].</p>
       <li data-md>
        <p>If <var>params</var>["authorization"] exists and is a string Set <var>authorization</var> to <var>params</var>["authorization"].</p>
       <li data-md>
        <p>Call <a href="#algo-session-request">§ 6.4 Send request</a> with <var>registration list</var>, <var>path</var>, <var>challenge</var> and <var>authorization</var> parameters.</p>
      </ol>
    </ol>
   </div>
   <h3 class="heading settled" data-level="6.6" id="algo-close-session"><span class="secno">6.6. </span><span class="content">Closing session</span><a class="self-link" href="#algo-close-session"></a></h3>
    To <dfn data-dfn-type="dfn" data-export id="close-session">close a session<a class="self-link" href="#close-session"></a></dfn> 
   <h3 class="heading settled" data-level="6.7" id="algo-fetch-integration"><span class="secno">6.7. </span><span class="content">Fetch Integration</span><a class="self-link" href="#algo-fetch-integration"></a></h3>
    To <dfn data-dfn-type="dfn" data-export id="fetch-integration">fetch Integration<a class="self-link" href="#fetch-integration"></a></dfn> 
   <h2 class="heading settled" data-level="7" id="format"><span class="secno">7. </span><span class="content">DBSC Formats</span><a class="self-link" href="#format"></a></h2>
   <h3 class="heading settled" data-level="7.1" id="header-sec-session-registration"><span class="secno">7.1. </span><span class="content">`<code>Sec-Session-Registration</code>` HTTP header field</span><a class="self-link" href="#header-sec-session-registration"></a></h3>
    The `<dfn class="dfn-paneled" data-dfn-type="http-header" data-export data-lt="Sec-Session-Registration" id="sec-session-registration-header"> <code>Sec-Session-Registration</code></dfn>` header field can be used in a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-response" id="ref-for-concept-response-response①">response</a> by the server to start a new <a data-link-type="dfn" href="#device-bound-session" id="ref-for-device-bound-session④">device bound session</a> on the
client. 
   <p><span>`<code><a data-link-type="http-header" href="#sec-session-registration-header" id="ref-for-sec-session-registration-header①">Sec-Session-Registration</a></code>`</span> is a List Structured Header <a data-link-type="biblio" href="#biblio-rfc8941" title="Structured Field Values for HTTP">[RFC8941]</a>. Its ABNF
is:</p>
<pre class="abnf">Sec-Session-Registration = <a data-link-type="dfn" href="https://datatracker.ietf.org/doc/html/rfc8941#list" id="ref-for-list②">sf-list</a></pre>
   <p>Each item in the list must be an inner list, and each item in the inner list
MUST be a <a data-link-type="dfn" href="https://datatracker.ietf.org/doc/html/rfc8941#token" id="ref-for-token">sf-token</a> representing a supported algorithm (ES256, RS256).
Only these two values are currently supported.</p>
   <p>The following parameters are defined:</p>
   <ul>
    <li data-md>
     <p>A parameter whose key is "challenge", and whose value is a String (Section
3.3.3 of <a data-link-type="biblio" href="#biblio-rfc8941" title="Structured Field Values for HTTP">[RFC8941]</a>), conveying the challenge to be used in the session
registration.</p>
    <li data-md>
     <p>A parameter whose key is "path", and whose value is a String (Section 3.3.3 of <a data-link-type="biblio" href="#biblio-rfc8941" title="Structured Field Values for HTTP">[RFC8941]</a>), conveying the path to the registration endpoint. This may be
relative to the current <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url④">url</a>, or a full <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑤">url</a>.</p>
    <li data-md>
     <p>A parameter whose key is "authorization", and whose value is a String (Section
3.3.3 of <a data-link-type="biblio" href="#biblio-rfc8941" title="Structured Field Values for HTTP">[RFC8941]</a>), this parameter will be copied into the registration
JWT.</p>
   </ul>
   <div class="example" id="sec-session-registration-example">
    <a class="self-link" href="#sec-session-registration-example"></a> Some examples of <span>`<code><a data-link-type="http-header" href="#sec-session-registration-header" id="ref-for-sec-session-registration-header②">Sec-Session-Registration</a></code>`</span> from
  https://example.com/login.html: 
<pre class="language-html highlight">HTTP/1.1 200 OK
Sec-Session-Registration: (ES256);path="reg";challenge="cv";authorization="ac"
</pre>
<pre class="language-html highlight">HTTP/1.1 200 OK
Sec-Session-Registration: (ES256 RS256);path="reg";challenge="cv"
</pre>
<pre class="language-html highlight">HTTP/1.1 200 OK
Sec-Session-Registration: (ES256);path="reg1";challenge="cv1";authorization="a"
Sec-Session-Registration: (RS256);path="reg2";challenge="cv2";authorization="b"
</pre>
<pre class="language-html highlight">HTTP/1.1 200 OK
Sec-Session-Registration: (ES256);path="reg1";challenge="cv1";authorization="a", (RS256);path="reg2";challenge="cv2";authorization="b"
</pre>
   </div>
   <h3 class="heading settled" data-level="7.2" id="header-sec-session-challenge"><span class="secno">7.2. </span><span class="content">`<code>Sec-Session-Challenge</code>` HTTP Header Field</span><a class="self-link" href="#header-sec-session-challenge"></a></h3>
    The `<dfn class="dfn-paneled" data-dfn-type="http-header" data-export data-lt="Sec-Session-Challenge" id="sec-session-challenge-header"> <code>Sec-Session-Challenge</code></dfn>` header field can be used in a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-response" id="ref-for-concept-response-response②">response</a> by the server to send a challenge to the client that it expects to
be used in future Sec-Session-Response headers inside the <a data-link-type="dfn" href="#dbsc-proof" id="ref-for-dbsc-proof③">DBSC proof</a>, or to
request a newly signed <a data-link-type="dfn" href="#dbsc-proof" id="ref-for-dbsc-proof④">DBSC proof</a> right away if the 
   <p><span>`<code><a data-link-type="http-header" href="#sec-session-challenge-header" id="ref-for-sec-session-challenge-header">Sec-Session-Challenge</a></code>`</span> is a structured header. Its value must be a string.
Its ABNF is: </p>
<pre class="abnf">SecSessionChallenge = <a data-link-type="dfn" href="https://datatracker.ietf.org/doc/html/rfc8941#string" id="ref-for-string⑦">sf-string</a></pre>
    The semantics of the item are defined in <a href="#challenge-structured-header-serialization">§ 7.2.1 Sec-Session-Challenge structured header serialization</a>.
   <p></p>
   <p>The processing steps are defined in <a href="#algo-process-challenge">§ 6.2 Process challenge</a>.</p>
   <h4 class="heading settled" data-level="7.2.1" id="challenge-structured-header-serialization"><span class="secno">7.2.1. </span><span class="content">Sec-Session-Challenge structured header serialization</span><a class="self-link" href="#challenge-structured-header-serialization"></a></h4>
    The <span>`<code><a data-link-type="http-header" href="#sec-session-challenge-header" id="ref-for-sec-session-challenge-header①">Sec-Session-Challenge</a></code>`</span> is represented as a Structured Field.<a data-link-type="biblio" href="#biblio-rfc8941" title="Structured Field Values for HTTP">[RFC8941]</a> 
   <p>In this representation, a challenge is represented by a string.</p>
   <p>Challenges MAY have a Parameter named <code>"id"</code>, whose value MUST be a String
representing a <a data-link-type="dfn" href="#device-bound-session-session-identifier" id="ref-for-device-bound-session-session-identifier③">session identifier</a>. Any other
parameters SHOULD be ignored.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The server might need to use this header to request the <a data-link-type="dfn" href="#dbsc-proof" id="ref-for-dbsc-proof⑤">DBSC proof</a> to
be signed with a new challenge before a session id has been assigned. In this
case the session ID is optional.</p>
   <div class="example" id="sec-session-challenge-example">
    <a class="self-link" href="#sec-session-challenge-example"></a> Some examples of <span>`<code><a data-link-type="http-header" href="#sec-session-challenge-header" id="ref-for-sec-session-challenge-header②">Sec-Session-Challenge</a></code>`</span> from
  https://example.com/login.html: 
<pre class="language-html highlight">HTTP/1.1 401 OK
Sec-Session-Challenge: "new challenge"
</pre>
<pre class="language-html highlight">HTTP/1.1 401 OK
Sec-Session-Challenge: "new challenge";id="my session"
</pre>
<pre class="language-html highlight">HTTP/1.1 200 OK
Sec-Session-Challenge: "new challenge";id="my session"
</pre>
<pre class="language-html highlight">HTTP/1.1 200 OK
Sec-Session-Challenge: "new challenge";id="my session 1"
Sec-Session-Challenge: "another challenge";id="my session 2"
</pre>
<pre class="language-html highlight">HTTP/1.1 200 OK
Sec-Session-Challenge: "c1";id="session 1", "c2";id="session 2"
</pre>
   </div>
   <h3 class="heading settled" data-level="7.3" id="header-sec-session-response"><span class="secno">7.3. </span><span class="content"><code>Sec-Session-Response</code> HTTP Header Field</span><a class="self-link" href="#header-sec-session-response"></a></h3>
    The `<dfn class="dfn-paneled" data-dfn-type="http-header" data-export data-lt="Sec-Session-Response" id="sec-session-response-header"> <code>Sec-Session-Response</code></dfn>` header field can be used in the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-request" id="ref-for-concept-request-request">request</a> by the user agent to send a <a data-link-type="dfn" href="#dbsc-proof" id="ref-for-dbsc-proof⑥">DBSC proof</a> to the server to prove
that the client is still in possesion of the private key of the session key. 
   <p>`<a data-link-type="http-header" href="#sec-session-response-header" id="ref-for-sec-session-response-header"><code>Sec-Session-Response</code></a>` is a structured
header. Its value must be a string. It’s ABNF is:</p>
<pre class="abnf">SecSessionChallenge = <a data-link-type="dfn" href="https://datatracker.ietf.org/doc/html/rfc8941#string" id="ref-for-string⑧">sf-string</a></pre>
   <p>This string MUST only contain the <a data-link-type="dfn" href="#dbsc-proof" id="ref-for-dbsc-proof⑦">DBSC proof</a> JWT. Any parameters SHOULD be
ignored.</p>
   <div class="example" id="sec-session-response-example">
    <a class="self-link" href="#sec-session-response-example"></a> 
<pre class="language-html highlight">POST example.com/refresh
Sec-Session-Response: "eyJhbGciOiJFUzI1NiIsInR5cCI6ImRic2Mrand0In0.eyJhdWQiOiJodHRwczovL2V4YW1wbGUuY29tL3JlZyIsImp0aSI6ImN2IiwiaWF0IjoiMTcyNTU3OTA1NSIsImp3ayI6eyJrdHkiOiJFQyIsImNydiI6IlAtMjU2IiwieCI6IjZfR0Iydm9RMHFyb01oNk9sREZDRlNfU0pyaVFpMVBUdnZCT2hHWjNiSEkiLCJ5IjoiSWVnT0pVTHlFN1N4SF9DZDFLQ0VSN2xXQnZHRkhRLWgweHlqelVqRUlXRSJ9LCJhdXRob3JpemF0aW9uIjoiYWMifQ.6Fb_vVBDmfNghQiBmIGe8o7tBfYPbPCywhQruP0vIhxgmcJmuNTaMHeVn_M8ZnOm1_bzIitbZqCWEn-1Qzmtyw"
</pre>
   </div>
   <h3 class="heading settled" data-level="7.4" id="header-sec-session-id"><span class="secno">7.4. </span><span class="content"><code>Sec-Session-Id</code> HTTP Header Field</span><a class="self-link" href="#header-sec-session-id"></a></h3>
    The `<dfn class="dfn-paneled" data-dfn-type="http-header" data-export data-lt="Sec-Session-Id" id="sec-session-id-header"> <code>Sec-Session-Id</code></dfn>` header field can be used in the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-request" id="ref-for-concept-request-request①">request</a> by the user agent to request the current session is refreshed, 
with the current session identifier as a string argument. 
   <p>`<a data-link-type="http-header" href="#sec-session-id-header" id="ref-for-sec-session-id-header"><code>Sec-Session-Id</code></a>` is a structured header.
Its value must be a string. It’s ABNF is:</p>
<pre class="abnf">SecSessionChallenge = <a data-link-type="dfn" href="https://datatracker.ietf.org/doc/html/rfc8941#string" id="ref-for-string⑨">sf-string</a></pre>
   <p>This string MUST only contain the session identifier. Any paramters SHOULD be
ignored.</p>
   <div class="example" id="sec-session-id-example">
    <a class="self-link" href="#sec-session-id-example"></a> 
<pre class="language-html highlight">POST example.com/refresh
Sec-Session-Id: "session-id"
</pre>
   </div>
   <h3 class="heading settled" data-level="7.5" id="format-session-instructions"><span class="secno">7.5. </span><span class="content">DBSC Session Instruction Format</span><a class="self-link" href="#format-session-instructions"></a></h3>
    The server sends <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="session-instructions">session instructions</dfn> during session registration and
optionally during session refresh. If the response contains session instructions
it MUST be in JSON format. 
   <p>At the root of the JSON object the following keys can exist:</p>
   <dl>
    <dt data-md><dfn data-dfn-for="session instructions" data-dfn-type="dfn" data-noexport id="session-instructions-session-identifier">session identifier<a class="self-link" href="#session-instructions-session-identifier"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①⓪">string</a> representing a <a data-link-type="dfn" href="#device-bound-session-session-identifier" id="ref-for-device-bound-session-session-identifier④">session identifier</a>.
If this <a data-link-type="dfn" href="#session-instructions" id="ref-for-session-instructions">session instructions</a> is sent during a refresh request this MUST be
the <a data-link-type="dfn" href="#device-bound-session-session-identifier" id="ref-for-device-bound-session-session-identifier⑤">session identifier</a> for the current session. If
not these instructions SHOULD be ignored.
If this <a data-link-type="dfn" href="#session-instructions" id="ref-for-session-instructions①">session instructions</a> is sent during a registration it MUST either
be a unique iditifier for this <a data-link-type="dfn" href="https://url.spec.whatwg.org/#host-registrable-domain" id="ref-for-host-registrable-domain⑤">registrable domain</a>, or it will
overwrite the current <a data-link-type="dfn" href="#device-bound-session" id="ref-for-device-bound-session⑤">device bound session</a> with this identifier for the
current <a data-link-type="dfn" href="https://url.spec.whatwg.org/#host-registrable-domain" id="ref-for-host-registrable-domain⑥">registrable domain</a>.
This key MUST be present.</p>
    <dt data-md><dfn data-dfn-for="session instructions" data-dfn-type="dfn" data-noexport id="session-instructions-refresh_url">refresh_url<a class="self-link" href="#session-instructions-refresh_url"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①①">string</a> representing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑥">url</a> used for future refresh requests.
This can be a full url, or relative to the current <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-request" id="ref-for-concept-request-request②">request</a>.
This key is OPTIONAL, if not present the registration url will be used for
future refresh requests.</p>
    <dt data-md><dfn data-dfn-for="session instructions" data-dfn-type="dfn" data-noexport id="session-instructions-continue">continue<a class="self-link" href="#session-instructions-continue"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean" id="ref-for-boolean②">boolean</a> representing if the current session should continue, or be
closed on the client. This key is OPTIONAL, and if not present the default
value will be true.</p>
    <dt data-md><dfn data-dfn-for="session instructions" data-dfn-type="dfn" data-noexport id="session-instructions-defer_requests">defer_requests<a class="self-link" href="#session-instructions-defer_requests"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#boolean" id="ref-for-boolean③">boolean</a> describing the wanted session behavior during a session
refresh. If this value is true all requests related to this session will be
deferred while the session is refreshed. If instead the value is false every
request will instead be sent as normal, but with a <span>`<code><a data-link-type="http-header" href="#sec-session-response-header" id="ref-for-sec-session-response-header①">Sec-Session-Response</a></code>`</span> header containing the <a data-link-type="dfn" href="#dbsc-proof" id="ref-for-dbsc-proof⑧">DBSC proof</a>.
This key is OPTIONAL, and if not present a value of true is default.</p>
   </dl>
   <div class="example" id="sec-session-instruction-example">
    <a class="self-link" href="#sec-session-instruction-example"></a> 
<pre class="language-json highlight"><c- p>{</c->
  <c- f>"session_identifier"</c-><c- p>:</c-> <c- u>"session_id"</c-><c- p>,</c->
  <c- f>"refresh_url"</c-><c- p>:</c-> <c- u>"/RefreshEndpoint"</c-><c- p>,</c->

  <c- f>"scope"</c-><c- p>:</c-> <c- p>{</c->
    <c- c1>// Origin-scoped by default (i.e. https://example.com)</c->
    <c- c1>// Specifies to include https://*.example.com except excluded subdomains.</c->
    <c- c1>// This can only be true if the origin’s host is the root eTLD+1.</c->
    <c- f>"origin"</c-><c- p>:</c-> <c- u>"example.com"</c-><c- p>,</c->
    <c- f>"include_site"</c-><c- p>:</c-> <c- kc>true</c-><c- p>,</c->
    <c- f>"continue"</c-><c- p>:</c-> <c- kc>false</c-><c- p>,</c->
    <c- f>"defer_requests"</c-><c- p>:</c-> <c- kc>true</c-><c- p>,</c-> <c- c1>// optional and true by default</c->

    <c- f>"scope_specification"</c-> <c- p>:</c-> <c- p>[</c->
      <c- p>{</c-> <c- f>"type"</c-><c- p>:</c-> <c- u>"include"</c-><c- p>,</c-> <c- f>"domain"</c-><c- p>:</c-> <c- u>"trusted.example.com"</c-><c- p>,</c-> <c- f>"path"</c-><c- p>:</c-> <c- u>"/only_trusted_path"</c-> <c- p>},</c->
      <c- p>{</c-> <c- f>"type"</c-><c- p>:</c-> <c- u>"exclude"</c-><c- p>,</c-> <c- f>"domain"</c-><c- p>:</c-> <c- u>"untrusted.example.com"</c-><c- p>,</c-> <c- f>"path"</c-><c- p>:</c-> <c- u>"/"</c-> <c- p>},</c->
      <c- p>{</c-> <c- f>"type"</c-><c- p>:</c-> <c- u>"exclude"</c-><c- p>,</c-> <c- f>"domain"</c-><c- p>:</c-> <c- u>"*.example.com"</c-><c- p>,</c-> <c- f>"path"</c-><c- p>:</c-> <c- u>"/static"</c-> <c- p>}</c->
    <c- p>]</c->
  <c- p>},</c->

  <c- f>"credentials"</c-><c- p>:</c-> <c- p>[{</c->
    <c- f>"type"</c-><c- p>:</c-> <c- u>"cookie"</c-><c- p>,</c->
    <c- c1>// This specifies the exact cookie that this config applies to. Attributes</c->
    <c- c1>// match the cookie attributes in RFC 6265bis and are parsed similarly to</c->
    <c- c1>// a normal Set-Cookie line, using the same default values.</c->
    <c- c1>// These SHOULD be equivalent to the Set-Cookie line accompanying this </c->
    <c- c1>// response.</c->
    <c- f>"name"</c-><c- p>:</c-> <c- u>"auth_cookie"</c-><c- p>,</c->
    <c- f>"attributes"</c-><c- p>:</c-> <c- u>"Domain=example.com; Path=/; Secure; SameSite=None"</c->
    <c- c1>// Attributes Max-Age, Expires and HttpOnly are ignored</c->
  <c- p>}]</c->
<c- p>}</c->
</pre>
   </div>
   <h3 class="heading settled" data-level="7.6" id="format-jwt"><span class="secno">7.6. </span><span class="content">DBSC Proof JWT Syntax</span><a class="self-link" href="#format-jwt"></a></h3>
    A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="dbsc-proof">DBSC proof</dfn> proof is a JWT that is signed (using JSON Web Signature
(JWS)), with a private key chosen by the client. The header of a <a data-link-type="dfn" href="#dbsc-proof" id="ref-for-dbsc-proof⑨">DBSC proof</a> MUST contain at least the following parameters: 
   <dl>
    <dt data-md><dfn data-dfn-for="DBSC proof" data-dfn-type="dfn" data-noexport id="dbsc-proof-typ">typ<a class="self-link" href="#dbsc-proof-typ"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①②">string</a> MUST be "dbsc+jwt"</p>
    <dt data-md><dfn data-dfn-for="DBSC proof" data-dfn-type="dfn" data-noexport id="dbsc-proof-alg">alg<a class="self-link" href="#dbsc-proof-alg"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①③">string</a> defining the algorithm used to sign this JWT. It MUST be
either "RS256" or "ES256" from [IANA.JOSE.ALGS].</p>
   </dl>
   <p>The payload of <a data-link-type="dfn" href="#dbsc-proof" id="ref-for-dbsc-proof①⓪">DBSC proof</a> MUST contain at least the following claims:</p>
   <dl>
    <dt data-md><dfn data-dfn-for="DBSC proof" data-dfn-type="dfn" data-noexport id="dbsc-proof-aud">aud<a class="self-link" href="#dbsc-proof-aud"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①④">string</a>, MUST be the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑦">url</a> this JWT was originally sent to.
Example: "https://example.com/refresh.html"</p>
    <dt data-md><dfn data-dfn-for="DBSC proof" data-dfn-type="dfn" data-noexport id="dbsc-proof-jti">jti<a class="self-link" href="#dbsc-proof-jti"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①⑤">string</a>, a copy of the challenge value sent in the registration
header.</p>
    <dt data-md><dfn data-dfn-for="DBSC proof" data-dfn-type="dfn" data-noexport id="dbsc-proof-iat">iat<a class="self-link" href="#dbsc-proof-iat"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①⑥">string</a>, this claim identifies the time at which the JWT was
issued.  This claim can be used to determine the age of the JWT.  Its
value MUST be a number containing a NumericDate value.</p>
    <dt data-md><dfn data-dfn-for="DBSC proof" data-dfn-type="dfn" data-noexport id="dbsc-proof-jwk">jwk<a class="self-link" href="#dbsc-proof-jwk"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①⑦">string</a> defining a JWK as specified in [rfc7517].</p>
   </dl>
   <p>In addition the following claims MUST be present if present in <span>`<code><a data-link-type="http-header" href="#sec-session-registration-header" id="ref-for-sec-session-registration-header③">Sec-Session-Registration</a></code>`</span>:</p>
   <dl>
    <dt data-md><dfn data-dfn-for="DBSC proof" data-dfn-type="dfn" data-noexport id="dbsc-proof-authorization">authorization<a class="self-link" href="#dbsc-proof-authorization"></a></dfn>
    <dd data-md>
     <p>a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①⑧">string</a>, direct copy of the string from <span>`<code><a data-link-type="http-header" href="#sec-session-registration-header" id="ref-for-sec-session-registration-header④">Sec-Session-Registration</a></code>`</span>, if set there. Note that this string is
OPTIONAL to include in the header, but if it is present it is
MANDATORY for clients to add the claim in the <a data-link-type="dfn" href="#dbsc-proof" id="ref-for-dbsc-proof①①">DBSC proof</a>.</p>
   </dl>
   <div class="example" id="dbsc-proof-example">
    <a class="self-link" href="#dbsc-proof-example"></a> An example <a data-link-type="dfn" href="#dbsc-proof" id="ref-for-dbsc-proof①②">DBSC proof</a> sent to https://example.com/reg: 
<pre class="language-json highlight"><c- c1>// Header</c->
<c- p>{</c->
  <c- f>"alg"</c-><c- p>:</c-> <c- u>"ES256"</c-><c- p>,</c->
  <c- f>"typ"</c-><c- p>:</c-> <c- u>"dbsc+jwt"</c->
<c- p>}</c->
<c- c1>// Payload</c->
<c- p>{</c->
  <c- f>"aud"</c-><c- p>:</c-> <c- u>"https://example.com/reg"</c-><c- p>,</c->
  <c- f>"jti"</c-><c- p>:</c-> <c- u>"cv"</c-><c- p>,</c->
  <c- f>"iat"</c-><c- p>:</c-> <c- u>"1725579055"</c-><c- p>,</c->
  <c- f>"jwk"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"kty"</c-><c- p>:</c-> <c- u>"EC"</c-><c- p>,</c->
    <c- f>"crv"</c-><c- p>:</c-> <c- u>"P-256"</c-><c- p>,</c->
    <c- f>"x"</c-><c- p>:</c-> <c- u>"6_GB2voQ0qroMh6OlDFCFS_SJriQi1PTvvBOhGZ3bHI"</c-><c- p>,</c->
    <c- f>"y"</c-><c- p>:</c-> <c- u>"IegOJULyE7SxH_Cd1KCER7lWBvGFHQ-h0xyjzUjEIWE"</c->
  <c- p>},</c->
  <c- f>"authorization"</c-><c- p>:</c-> <c- u>"ac"</c->
<c- p>}</c->
</pre>
    <p>Based on this response header from the server:</p>
<pre class="language-html highlight">HTTP/1.1 200 OK
Sec-Session-Registration: (ES256);path="reg";challenge="cv";authorization="ac"
</pre>
    <p>recieved on a response from <code>http://example.com/page.html</code></p>
   </div>
   <h2 class="heading settled" data-level="8" id="changes-to-other-specifications"><span class="secno">8. </span><span class="content">Changes to other specifications</span><a class="self-link" href="#changes-to-other-specifications"></a></h2>
   <h3 class="heading settled" data-level="8.1" id="changes-to-fetch"><span class="secno">8.1. </span><span class="content">Changes to the Fetch specification</span><a class="self-link" href="#changes-to-fetch"></a></h3>
    --> Check if session should be refreshed before sending request 
   <ul>
    <li data-md>
     <p>Alternatively add proof with Sec-Session-Response</p>
   </ul>
   <h3 class="heading settled" data-level="8.2" id="changes-to-html"><span class="secno">8.2. </span><span class="content">Changes to the HTML specification</span><a class="self-link" href="#changes-to-html"></a></h3>
    --> Clear Site Data: Clear the session if this is received 
   <h2 class="heading settled" data-level="9" id="iana-considerations"><span class="secno">9. </span><span class="content">IANA Considerations</span><a class="self-link" href="#iana-considerations"></a></h2>
   <p>The permanent message header field registry should be updated with the following
registrations: <a data-link-type="biblio" href="#biblio-rfc3864" title="Registration Procedures for Message Header Fields">[RFC3864]</a></p>
   <h3 class="heading settled" data-level="9.1" id="iana-ses-session-challenge"><span class="secno">9.1. </span><span class="content">Sec-Session-Challenge</span><a class="self-link" href="#iana-ses-session-challenge"></a></h3>
   <dl>
    <dt>Header field name
    <dd>Sec-Session-Challenge
    <dt>Applicable protocol
    <dd>http
    <dt>Status
    <dd>draft
    <dt>Author/Change controller
    <dd>W3C
    <dt>Specification document
    <dd>This specification (See <a href="#header-sec-session-challenge">§ 7.2 `Sec-Session-Challenge` HTTP Header Field</a>)
   </dl>
   <h3 class="heading settled" data-level="9.2" id="iana-ses-session-id"><span class="secno">9.2. </span><span class="content">Sec-Session-Id</span><a class="self-link" href="#iana-ses-session-id"></a></h3>
   <dl>
    <dt>Header field name
    <dd>Sec-Session-Id
    <dt>Applicable protocol
    <dd>http
    <dt>Status
    <dd>draft
    <dt>Author/Change controller
    <dd>W3C
    <dt>Specification document
    <dd>This specification (See <a href="#header-sec-session-id">§ 7.4 Sec-Session-Id HTTP Header Field</a>)
   </dl>
   <h3 class="heading settled" data-level="9.3" id="iana-sec-session-registration"><span class="secno">9.3. </span><span class="content">Sec-Session-Registration</span><a class="self-link" href="#iana-sec-session-registration"></a></h3>
   <dl>
    <dt>Header field name
    <dd>Sec-Session-Registration
    <dt>Applicable protocol
    <dd>http
    <dt>Status
    <dd>draft
    <dt>Author/Change controller
    <dd>W3C
    <dt>Specification document
    <dd>This specification (See <a href="#header-sec-session-registration">§ 7.1 `Sec-Session-Registration` HTTP header field</a>)
   </dl>
   <h3 class="heading settled" data-level="9.4" id="iana-ses-session-response"><span class="secno">9.4. </span><span class="content">Sec-Session-Response</span><a class="self-link" href="#iana-ses-session-response"></a></h3>
   <dl>
    <dt>Header field name
    <dd>Sec-Session-Response
    <dt>Applicable protocol
    <dd>http
    <dt>Status
    <dd>draft
    <dt>Author/Change controller
    <dd>W3C
    <dt>Specification document
    <dd>This specification (See <a href="#header-sec-session-response">§ 7.3 Sec-Session-Response HTTP Header Field</a>)
   </dl>
   <h2 class="heading settled" data-level="10" id="changelog"><span class="secno">10. </span><span class="content">Changelog</span><a class="self-link" href="#changelog"></a></h2>
    This is an early draft of the spec. 
   <h2 class="heading settled" data-level="11" id="acknowledgements"><span class="secno">11. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
  </div>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#dbsc-proof-alg">alg</a><span>, in § 7.6</span>
   <li><a href="#session-credential-attributes">attributes</a><span>, in § 5.6</span>
   <li><a href="#dbsc-proof-aud">aud</a><span>, in § 7.6</span>
   <li><a href="#dbsc-proof-authorization">authorization</a><span>, in § 7.6</span>
   <li><a href="#device-bound-session-cached-challenge">cached challenge</a><span>, in § 5.3</span>
   <li><a href="#close-session">close a session</a><span>, in § 6.6</span>
   <li><a href="#session-instructions-continue">continue</a><span>, in § 7.5</span>
   <li><a href="#create-session">Create a new session</a><span>, in § 6.5</span>
   <li><a href="#dbsc-proof">DBSC proof</a><span>, in § 7.6</span>
   <li><a href="#device-bound-session-defer-requests">defer requests</a><span>, in § 5.3</span>
   <li><a href="#session-instructions-defer_requests">defer_requests</a><span>, in § 7.5</span>
   <li><a href="#device-bound-session">device bound session</a><span>, in § 5.3</span>
   <li><a href="#fetch-integration">fetch Integration</a><span>, in § 6.7</span>
   <li><a href="#dbsc-proof-iat">iat</a><span>, in § 7.6</span>
   <li><a href="#algorithms-identify-a-session">identify a session</a><span>, in § 6.1</span>
   <li><a href="#session-scope-include-site">include site</a><span>, in § 5.4</span>
   <li><a href="#dbsc-proof-jti">jti</a><span>, in § 7.6</span>
   <li><a href="#dbsc-proof-jwk">jwk</a><span>, in § 7.6</span>
   <li><a href="#session-credential-name">name</a><span>, in § 5.6</span>
   <li><a href="#scope-specification-path">path</a><span>, in § 5.5</span>
   <li><a href="#algorithms-process-a-challenge">process a challenge</a><span>, in § 6.2</span>
   <li><a href="#refresh-session">Refreshing an existing session</a><span>, in § 6.3</span>
   <li><a href="#device-bound-session-refresh-url">refresh url</a><span>, in § 5.3</span>
   <li><a href="#session-instructions-refresh_url">refresh_url</a><span>, in § 7.5</span>
   <li><a href="#registrable-domain-sessions">registrable domain sessions</a><span>, in § 5.1</span>
   <li><a href="#scope-specification">scope specification</a><span>, in § 5.5</span>
   <li><a href="#sec-session-challenge-header">Sec-Session-Challenge</a><span>, in § 7.2</span>
   <li><a href="#sec-session-id-header">Sec-Session-Id</a><span>, in § 7.4</span>
   <li><a href="#sec-session-registration-header">Sec-Session-Registration</a><span>, in § 7.1</span>
   <li><a href="#sec-session-response-header">Sec-Session-Response</a><span>, in § 7.3</span>
   <li><a href="#session-by-id">session by id</a><span>, in § 5.2</span>
   <li><a href="#session-credential">session credential</a><span>, in § 5.6</span>
   <li>
    session identifier
    <ul>
     <li><a href="#device-bound-session-session-identifier">dfn for device bound session</a><span>, in § 5.3</span>
     <li><a href="#session-instructions-session-identifier">dfn for session instructions</a><span>, in § 7.5</span>
    </ul>
   <li><a href="#session-instructions">session instructions</a><span>, in § 7.5</span>
   <li><a href="#session-scope">session scope</a><span>, in § 5.4</span>
   <li><a href="#dbsc-proof-typ">typ</a><span>, in § 7.6</span>
   <li><a href="#scope-specification-type">type</a><span>, in § 5.5</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="5c66de35">get a structured field value</span>
     <li><span class="dfn-paneled" id="f7b00a8b">header list</span>
     <li><span class="dfn-paneled" id="162d2b51">request</span>
     <li><span class="dfn-paneled" id="e3201629">response</span>
     <li><span class="dfn-paneled" id="a1d47575">status</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="36858240">boolean</span>
     <li><span class="dfn-paneled" id="f937b7b6">continue</span>
     <li><span class="dfn-paneled" id="16d07e10">for each</span>
     <li><span class="dfn-paneled" id="c88f3887">item</span>
     <li><span class="dfn-paneled" id="649608b9">list</span>
     <li><span class="dfn-paneled" id="84b454ff">ordered map</span>
     <li><span class="dfn-paneled" id="0698d556">string</span>
     <li><span class="dfn-paneled" id="984221ca">struct</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC8941]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c6b25c6b">parsing structured fields</span>
     <li><span class="dfn-paneled" id="b93af9cf">sf-list</span>
     <li><span class="dfn-paneled" id="e7aabcb5">sf-string</span>
     <li><span class="dfn-paneled" id="bb423dc4">sf-token</span>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="bc9d7803">registrable domain</span>
     <li><span class="dfn-paneled" id="dcffbccd">url</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-rfc3864">[RFC3864]
   <dd>G. Klyne; M. Nottingham; J. Mogul. <a href="https://www.rfc-editor.org/rfc/rfc3864"><cite>Registration Procedures for Message Header Fields</cite></a>. September 2004. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc3864">https://www.rfc-editor.org/rfc/rfc3864</a>
   <dt id="biblio-rfc5234">[RFC5234]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://www.rfc-editor.org/rfc/rfc5234"><cite>Augmented BNF for Syntax Specifications: ABNF</cite></a>. January 2008. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5234">https://www.rfc-editor.org/rfc/rfc5234</a>
   <dt id="biblio-rfc7405">[RFC7405]
   <dd>P. Kyzivat. <a href="https://www.rfc-editor.org/rfc/rfc7405"><cite>Case-Sensitive String Support in ABNF</cite></a>. December 2014. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7405">https://www.rfc-editor.org/rfc/rfc7405</a>
   <dt id="biblio-rfc8941">[RFC8941]
   <dd>M. Nottingham; P-H. Kamp. <a href="https://httpwg.org/specs/rfc8941.html"><cite>Structured Field Values for HTTP</cite></a>. February 2021. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc8941.html">https://httpwg.org/specs/rfc8941.html</a>
   <dt id="biblio-rfc9112">[RFC9112]
   <dd>R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed.. <a href="https://httpwg.org/specs/rfc9112.html"><cite>HTTP/1.1</cite></a>. June 2022. Internet Standard. URL: <a href="https://httpwg.org/specs/rfc9112.html">https://httpwg.org/specs/rfc9112.html</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
  </dl>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
    const dfnsJson = window.dfnsJson || {};

    function genDfnPanel({dfnID, url, dfnText, refSections, external}) {
        return mk.aside({
            class: "dfn-panel",
            id: `infopanel-for-${dfnID}`,
            "data-for": dfnID,
            "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
            },
            mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
                `Info about the '${dfnText}' ${external?"external":""} reference.`),
            mk.a({href:url}, url),
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({
                                    href: `#${ref.id}`
                                    },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        );
    }

    function genAllDfnPanels() {
        for(const panelData of Object.values(window.dfnpanelData)) {
            const dfnID = panelData.dfnID;
            const dfn = document.getElementById(dfnID);
            if(!dfn) {
                console.log(`Can't find dfn#${dfnID}.`, panelData);
            } else {
                const panel = genDfnPanel(panelData);
                append(document.body, panel);
                insertDfnPopupAction(dfn, panel)
            }
        }
    }

    document.addEventListener("DOMContentLoaded", ()=>{
        genAllDfnPanels();

        // Add popup behavior to all dfns to show the corresponding dfn-panel.
        var dfns = queryAll('.dfn-paneled');
        for(let dfn of dfns) { ; }

        document.body.addEventListener("click", (e) => {
            // If not handled already, just hide all dfn panels.
            hideAllDfnPanels();
        });
    })


    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn, dfnPanel) {
        // Find dfn panel
        const panelWrapper = document.createElement('span');
        panelWrapper.appendChild(dfnPanel);
        panelWrapper.style.position = "relative";
        panelWrapper.style.height = "0px";
        dfn.insertAdjacentElement("afterend", panelWrapper);
        dfn.setAttribute('role', 'button');
        dfn.setAttribute('aria-expanded', 'false')
        dfn.tabIndex = 0;
        dfn.classList.add('has-dfn-panel');
        dfn.addEventListener('click', (event) => {
            showDfnPanel(dfnPanel, dfn);
            event.stopPropagation();
        });
        dfn.addEventListener('keypress', (event) => {
            const kc = event.keyCode;
            // 32->Space, 13->Enter
            if(kc == 32 || kc == 13) {
                toggleDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        });

        dfnPanel.addEventListener('click', (event) => {
            if (event.target.nodeName == 'A') {
                pinDfnPanel(dfnPanel);
            }
            event.stopPropagation();
        });

        dfnPanel.addEventListener('keydown', (event) => {
            if(event.keyCode == 27) { // Escape key
                hideDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        })
    }
}
</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
    const dfnsJson = window.dfnsJson || {};

    function genDfnPanel({dfnID, url, dfnText, refSections, external}) {
        return mk.aside({
            class: "dfn-panel",
            id: `infopanel-for-${dfnID}`,
            "data-for": dfnID,
            "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
            },
            mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
                `Info about the '${dfnText}' ${external?"external":""} reference.`),
            mk.a({href:url}, url),
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({
                                    href: `#${ref.id}`
                                    },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        );
    }

    function genAllDfnPanels() {
        for(const panelData of Object.values(window.dfnpanelData)) {
            const dfnID = panelData.dfnID;
            const dfn = document.getElementById(dfnID);
            if(!dfn) {
                console.log(`Can't find dfn#${dfnID}.`, panelData);
            } else {
                const panel = genDfnPanel(panelData);
                append(document.body, panel);
                insertDfnPopupAction(dfn, panel)
            }
        }
    }

    document.addEventListener("DOMContentLoaded", ()=>{
        genAllDfnPanels();

        // Add popup behavior to all dfns to show the corresponding dfn-panel.
        var dfns = queryAll('.dfn-paneled');
        for(let dfn of dfns) { ; }

        document.body.addEventListener("click", (e) => {
            // If not handled already, just hide all dfn panels.
            hideAllDfnPanels();
        });
    })


    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn, dfnPanel) {
        // Find dfn panel
        const panelWrapper = document.createElement('span');
        panelWrapper.appendChild(dfnPanel);
        panelWrapper.style.position = "relative";
        panelWrapper.style.height = "0px";
        dfn.insertAdjacentElement("afterend", panelWrapper);
        dfn.setAttribute('role', 'button');
        dfn.setAttribute('aria-expanded', 'false')
        dfn.tabIndex = 0;
        dfn.classList.add('has-dfn-panel');
        dfn.addEventListener('click', (event) => {
            showDfnPanel(dfnPanel, dfn);
            event.stopPropagation();
        });
        dfn.addEventListener('keypress', (event) => {
            const kc = event.keyCode;
            // 32->Space, 13->Enter
            if(kc == 32 || kc == 13) {
                toggleDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        });

        dfnPanel.addEventListener('click', (event) => {
            if (event.target.nodeName == 'A') {
                pinDfnPanel(dfnPanel);
            }
            event.stopPropagation();
        });

        dfnPanel.addEventListener('keydown', (event) => {
            if(event.keyCode == 27) { // Escape key
                hideDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        })
    }
}
</script>
<script>/* Boilerplate: script-dfn-panel-json */
window.dfnpanelData = {};
window.dfnpanelData['5c66de35'] = {"dfnID": "5c66de35", "url": "https://fetch.spec.whatwg.org/#concept-header-list-get-structured-header", "dfnText": "get a structured field value", "refSections": [{"refs": [{"id": "ref-for-concept-header-list-get-structured-header"}], "title": "6.2. Process challenge"}, {"refs": [{"id": "ref-for-concept-header-list-get-structured-header\u2460"}], "title": "6.5. Create session"}], "external": true};
window.dfnpanelData['f7b00a8b'] = {"dfnID": "f7b00a8b", "url": "https://fetch.spec.whatwg.org/#concept-response-header-list", "dfnText": "header list", "refSections": [{"refs": [{"id": "ref-for-concept-response-header-list"}], "title": "6.2. Process challenge"}, {"refs": [{"id": "ref-for-concept-response-header-list\u2460"}], "title": "6.5. Create session"}], "external": true};
window.dfnpanelData['162d2b51'] = {"dfnID": "162d2b51", "url": "https://fetch.spec.whatwg.org/#concept-request-request", "dfnText": "request", "refSections": [{"refs": [{"id": "ref-for-concept-request-request"}], "title": "7.3. Sec-Session-Response HTTP Header Field"}, {"refs": [{"id": "ref-for-concept-request-request\u2460"}], "title": "7.4. Sec-Session-Id HTTP Header Field"}, {"refs": [{"id": "ref-for-concept-request-request\u2461"}], "title": "7.5. DBSC Session Instruction Format"}], "external": true};
window.dfnpanelData['e3201629'] = {"dfnID": "e3201629", "url": "https://fetch.spec.whatwg.org/#concept-response-response", "dfnText": "response", "refSections": [{"refs": [{"id": "ref-for-concept-response-response"}], "title": "6.2. Process challenge"}, {"refs": [{"id": "ref-for-concept-response-response\u2460"}], "title": "7.1. `Sec-Session-Registration` HTTP header field"}, {"refs": [{"id": "ref-for-concept-response-response\u2461"}], "title": "7.2. `Sec-Session-Challenge` HTTP Header Field"}], "external": true};
window.dfnpanelData['a1d47575'] = {"dfnID": "a1d47575", "url": "https://fetch.spec.whatwg.org/#concept-response-status", "dfnText": "status", "refSections": [{"refs": [{"id": "ref-for-concept-response-status"}, {"id": "ref-for-concept-response-status\u2460"}], "title": "6.2. Process challenge"}], "external": true};
window.dfnpanelData['36858240'] = {"dfnID": "36858240", "url": "https://infra.spec.whatwg.org/#boolean", "dfnText": "boolean", "refSections": [{"refs": [{"id": "ref-for-boolean"}], "title": "5.3. Device bound session"}, {"refs": [{"id": "ref-for-boolean\u2460"}], "title": "5.4. Session scope"}, {"refs": [{"id": "ref-for-boolean\u2461"}, {"id": "ref-for-boolean\u2462"}], "title": "7.5. DBSC Session Instruction Format"}], "external": true};
window.dfnpanelData['f937b7b6'] = {"dfnID": "f937b7b6", "url": "https://infra.spec.whatwg.org/#iteration-continue", "dfnText": "continue", "refSections": [{"refs": [{"id": "ref-for-iteration-continue"}, {"id": "ref-for-iteration-continue\u2460"}], "title": "6.2. Process challenge"}], "external": true};
window.dfnpanelData['16d07e10'] = {"dfnID": "16d07e10", "url": "https://infra.spec.whatwg.org/#list-iterate", "dfnText": "for each", "refSections": [{"refs": [{"id": "ref-for-list-iterate"}], "title": "6.2. Process challenge"}, {"refs": [{"id": "ref-for-list-iterate\u2460"}], "title": "6.5. Create session"}], "external": true};
window.dfnpanelData['c88f3887'] = {"dfnID": "c88f3887", "url": "https://infra.spec.whatwg.org/#struct-item", "dfnText": "item", "refSections": [{"refs": [{"id": "ref-for-struct-item"}], "title": "5.3. Device bound session"}, {"refs": [{"id": "ref-for-struct-item\u2460"}], "title": "5.4. Session scope"}, {"refs": [{"id": "ref-for-struct-item\u2461"}], "title": "5.5. Scope specification"}, {"refs": [{"id": "ref-for-struct-item\u2462"}], "title": "5.6. Session credential"}], "external": true};
window.dfnpanelData['649608b9'] = {"dfnID": "649608b9", "url": "https://infra.spec.whatwg.org/#list", "dfnText": "list", "refSections": [{"refs": [{"id": "ref-for-list"}], "title": "5.3. Device bound session"}, {"refs": [{"id": "ref-for-list\u2460"}], "title": "5.4. Session scope"}], "external": true};
window.dfnpanelData['84b454ff'] = {"dfnID": "84b454ff", "url": "https://infra.spec.whatwg.org/#ordered-map", "dfnText": "ordered map", "refSections": [{"refs": [{"id": "ref-for-ordered-map"}], "title": "5.1. Sessions by registrable domain"}, {"refs": [{"id": "ref-for-ordered-map\u2460"}], "title": "5.2. Sessions by id"}], "external": true};
window.dfnpanelData['0698d556'] = {"dfnID": "0698d556", "url": "https://infra.spec.whatwg.org/#string", "dfnText": "string", "refSections": [{"refs": [{"id": "ref-for-string"}, {"id": "ref-for-string\u2460"}, {"id": "ref-for-string\u2461"}], "title": "5.3. Device bound session"}, {"refs": [{"id": "ref-for-string\u2462"}, {"id": "ref-for-string\u2463"}], "title": "5.5. Scope specification"}, {"refs": [{"id": "ref-for-string\u2464"}, {"id": "ref-for-string\u2465"}], "title": "5.6. Session credential"}, {"refs": [{"id": "ref-for-string\u2460\u24ea"}, {"id": "ref-for-string\u2460\u2460"}], "title": "7.5. DBSC Session Instruction Format"}, {"refs": [{"id": "ref-for-string\u2460\u2461"}, {"id": "ref-for-string\u2460\u2462"}, {"id": "ref-for-string\u2460\u2463"}, {"id": "ref-for-string\u2460\u2464"}, {"id": "ref-for-string\u2460\u2465"}, {"id": "ref-for-string\u2460\u2466"}, {"id": "ref-for-string\u2460\u2467"}], "title": "7.6. DBSC Proof JWT Syntax"}], "external": true};
window.dfnpanelData['984221ca'] = {"dfnID": "984221ca", "url": "https://infra.spec.whatwg.org/#struct", "dfnText": "struct", "refSections": [{"refs": [{"id": "ref-for-struct"}, {"id": "ref-for-struct\u2460"}], "title": "5.3. Device bound session"}, {"refs": [{"id": "ref-for-struct\u2461"}], "title": "5.4. Session scope"}, {"refs": [{"id": "ref-for-struct\u2462"}], "title": "5.5. Scope specification"}, {"refs": [{"id": "ref-for-struct\u2463"}], "title": "5.6. Session credential"}], "external": true};
window.dfnpanelData['c6b25c6b'] = {"dfnID": "c6b25c6b", "url": "https://datatracker.ietf.org/doc/html/rfc8941#text-parse", "dfnText": "parsing structured fields", "refSections": [{"refs": [{"id": "ref-for-text-parse"}, {"id": "ref-for-text-parse\u2460"}], "title": "6.2. Process challenge"}], "external": true};
window.dfnpanelData['b93af9cf'] = {"dfnID": "b93af9cf", "url": "https://datatracker.ietf.org/doc/html/rfc8941#list", "dfnText": "sf-list", "refSections": [{"refs": [{"id": "ref-for-list\u2461"}], "title": "7.1. `Sec-Session-Registration` HTTP header field"}], "external": true};
window.dfnpanelData['e7aabcb5'] = {"dfnID": "e7aabcb5", "url": "https://datatracker.ietf.org/doc/html/rfc8941#string", "dfnText": "sf-string", "refSections": [{"refs": [{"id": "ref-for-string\u2466"}], "title": "7.2. `Sec-Session-Challenge` HTTP Header Field"}, {"refs": [{"id": "ref-for-string\u2467"}], "title": "7.3. Sec-Session-Response HTTP Header Field"}, {"refs": [{"id": "ref-for-string\u2468"}], "title": "7.4. Sec-Session-Id HTTP Header Field"}], "external": true};
window.dfnpanelData['bb423dc4'] = {"dfnID": "bb423dc4", "url": "https://datatracker.ietf.org/doc/html/rfc8941#token", "dfnText": "sf-token", "refSections": [{"refs": [{"id": "ref-for-token"}], "title": "7.1. `Sec-Session-Registration` HTTP header field"}], "external": true};
window.dfnpanelData['bc9d7803'] = {"dfnID": "bc9d7803", "url": "https://url.spec.whatwg.org/#host-registrable-domain", "dfnText": "registrable domain", "refSections": [{"refs": [{"id": "ref-for-host-registrable-domain"}], "title": "5.1. Sessions by registrable domain"}, {"refs": [{"id": "ref-for-host-registrable-domain\u2460"}], "title": "5.2. Sessions by id"}, {"refs": [{"id": "ref-for-host-registrable-domain\u2461"}], "title": "5.3. Device bound session"}, {"refs": [{"id": "ref-for-host-registrable-domain\u2462"}, {"id": "ref-for-host-registrable-domain\u2463"}], "title": "6.1. Identify session"}, {"refs": [{"id": "ref-for-host-registrable-domain\u2464"}, {"id": "ref-for-host-registrable-domain\u2465"}], "title": "7.5. DBSC Session Instruction Format"}], "external": true};
window.dfnpanelData['dcffbccd'] = {"dfnID": "dcffbccd", "url": "https://url.spec.whatwg.org/#concept-url", "dfnText": "url", "refSections": [{"refs": [{"id": "ref-for-concept-url"}, {"id": "ref-for-concept-url\u2460"}], "title": "5.3. Device bound session"}, {"refs": [{"id": "ref-for-concept-url\u2461"}, {"id": "ref-for-concept-url\u2462"}], "title": "6.1. Identify session"}, {"refs": [{"id": "ref-for-concept-url\u2463"}, {"id": "ref-for-concept-url\u2464"}], "title": "7.1. `Sec-Session-Registration` HTTP header field"}, {"refs": [{"id": "ref-for-concept-url\u2465"}], "title": "7.5. DBSC Session Instruction Format"}, {"refs": [{"id": "ref-for-concept-url\u2466"}], "title": "7.6. DBSC Proof JWT Syntax"}], "external": true};
window.dfnpanelData['registrable-domain-sessions'] = {"dfnID": "registrable-domain-sessions", "url": "#registrable-domain-sessions", "dfnText": "registrable domain sessions", "refSections": [{"refs": [{"id": "ref-for-registrable-domain-sessions"}], "title": "6.1. Identify session"}, {"refs": [{"id": "ref-for-registrable-domain-sessions\u2460"}], "title": "6.2. Process challenge"}], "external": false};
window.dfnpanelData['session-by-id'] = {"dfnID": "session-by-id", "url": "#session-by-id", "dfnText": "session by id", "refSections": [{"refs": [{"id": "ref-for-session-by-id"}], "title": "5.1. Sessions by registrable domain"}, {"refs": [{"id": "ref-for-session-by-id\u2460"}], "title": "6.1. Identify session"}], "external": false};
window.dfnpanelData['device-bound-session'] = {"dfnID": "device-bound-session", "url": "#device-bound-session", "dfnText": "device bound session", "refSections": [{"refs": [{"id": "ref-for-device-bound-session"}], "title": "5.2. Sessions by id"}, {"refs": [{"id": "ref-for-device-bound-session\u2460"}], "title": "6.1. Identify session"}, {"refs": [{"id": "ref-for-device-bound-session\u2461"}, {"id": "ref-for-device-bound-session\u2462"}], "title": "6.2. Process challenge"}, {"refs": [{"id": "ref-for-device-bound-session\u2463"}], "title": "7.1. `Sec-Session-Registration` HTTP header field"}, {"refs": [{"id": "ref-for-device-bound-session\u2464"}], "title": "7.5. DBSC Session Instruction Format"}], "external": false};
window.dfnpanelData['device-bound-session-session-identifier'] = {"dfnID": "device-bound-session-session-identifier", "url": "#device-bound-session-session-identifier", "dfnText": "session identifier", "refSections": [{"refs": [{"id": "ref-for-device-bound-session-session-identifier"}], "title": "5.2. Sessions by id"}, {"refs": [{"id": "ref-for-device-bound-session-session-identifier\u2460"}, {"id": "ref-for-device-bound-session-session-identifier\u2461"}], "title": "6.1. Identify session"}, {"refs": [{"id": "ref-for-device-bound-session-session-identifier\u2462"}], "title": "7.2.1. Sec-Session-Challenge structured header serialization"}, {"refs": [{"id": "ref-for-device-bound-session-session-identifier\u2463"}, {"id": "ref-for-device-bound-session-session-identifier\u2464"}], "title": "7.5. DBSC Session Instruction Format"}], "external": false};
window.dfnpanelData['device-bound-session-cached-challenge'] = {"dfnID": "device-bound-session-cached-challenge", "url": "#device-bound-session-cached-challenge", "dfnText": "cached challenge", "refSections": [{"refs": [{"id": "ref-for-device-bound-session-cached-challenge"}], "title": "6.2. Process challenge"}], "external": false};
window.dfnpanelData['session-scope'] = {"dfnID": "session-scope", "url": "#session-scope", "dfnText": "session scope", "refSections": [{"refs": [{"id": "ref-for-session-scope"}], "title": "5.3. Device bound session"}], "external": false};
window.dfnpanelData['scope-specification'] = {"dfnID": "scope-specification", "url": "#scope-specification", "dfnText": "scope specification", "refSections": [{"refs": [{"id": "ref-for-scope-specification"}, {"id": "ref-for-scope-specification\u2460"}], "title": "5.4. Session scope"}], "external": false};
window.dfnpanelData['session-credential'] = {"dfnID": "session-credential", "url": "#session-credential", "dfnText": "session credential", "refSections": [{"refs": [{"id": "ref-for-session-credential"}, {"id": "ref-for-session-credential\u2460"}], "title": "5.3. Device bound session"}], "external": false};
window.dfnpanelData['algorithms-identify-a-session'] = {"dfnID": "algorithms-identify-a-session", "url": "#algorithms-identify-a-session", "dfnText": "identify a session", "refSections": [{"refs": [{"id": "ref-for-algorithms-identify-a-session"}], "title": "6.2. Process challenge"}], "external": false};
window.dfnpanelData['sec-session-registration-header'] = {"dfnID": "sec-session-registration-header", "url": "#sec-session-registration-header", "dfnText": "\nSec-Session-Registration", "refSections": [{"refs": [{"id": "ref-for-sec-session-registration-header"}], "title": "6.5. Create session"}, {"refs": [{"id": "ref-for-sec-session-registration-header\u2460"}, {"id": "ref-for-sec-session-registration-header\u2461"}], "title": "7.1. `Sec-Session-Registration` HTTP header field"}, {"refs": [{"id": "ref-for-sec-session-registration-header\u2462"}, {"id": "ref-for-sec-session-registration-header\u2463"}], "title": "7.6. DBSC Proof JWT Syntax"}], "external": false};
window.dfnpanelData['sec-session-challenge-header'] = {"dfnID": "sec-session-challenge-header", "url": "#sec-session-challenge-header", "dfnText": "\nSec-Session-Challenge", "refSections": [{"refs": [{"id": "ref-for-sec-session-challenge-header"}], "title": "7.2. `Sec-Session-Challenge` HTTP Header Field"}, {"refs": [{"id": "ref-for-sec-session-challenge-header\u2460"}, {"id": "ref-for-sec-session-challenge-header\u2461"}], "title": "7.2.1. Sec-Session-Challenge structured header serialization"}], "external": false};
window.dfnpanelData['sec-session-response-header'] = {"dfnID": "sec-session-response-header", "url": "#sec-session-response-header", "dfnText": "\nSec-Session-Response", "refSections": [{"refs": [{"id": "ref-for-sec-session-response-header"}], "title": "7.3. Sec-Session-Response HTTP Header Field"}, {"refs": [{"id": "ref-for-sec-session-response-header\u2460"}], "title": "7.5. DBSC Session Instruction Format"}], "external": false};
window.dfnpanelData['sec-session-id-header'] = {"dfnID": "sec-session-id-header", "url": "#sec-session-id-header", "dfnText": "\nSec-Session-Id", "refSections": [{"refs": [{"id": "ref-for-sec-session-id-header"}], "title": "7.4. Sec-Session-Id HTTP Header Field"}], "external": false};
window.dfnpanelData['session-instructions'] = {"dfnID": "session-instructions", "url": "#session-instructions", "dfnText": "session instructions", "refSections": [{"refs": [{"id": "ref-for-session-instructions"}, {"id": "ref-for-session-instructions\u2460"}], "title": "7.5. DBSC Session Instruction Format"}], "external": false};
window.dfnpanelData['dbsc-proof'] = {"dfnID": "dbsc-proof", "url": "#dbsc-proof", "dfnText": "DBSC proof", "refSections": [{"refs": [{"id": "ref-for-dbsc-proof"}, {"id": "ref-for-dbsc-proof\u2460"}, {"id": "ref-for-dbsc-proof\u2461"}], "title": "6.2. Process challenge"}, {"refs": [{"id": "ref-for-dbsc-proof\u2462"}, {"id": "ref-for-dbsc-proof\u2463"}], "title": "7.2. `Sec-Session-Challenge` HTTP Header Field"}, {"refs": [{"id": "ref-for-dbsc-proof\u2464"}], "title": "7.2.1. Sec-Session-Challenge structured header serialization"}, {"refs": [{"id": "ref-for-dbsc-proof\u2465"}, {"id": "ref-for-dbsc-proof\u2466"}], "title": "7.3. Sec-Session-Response HTTP Header Field"}, {"refs": [{"id": "ref-for-dbsc-proof\u2467"}], "title": "7.5. DBSC Session Instruction Format"}, {"refs": [{"id": "ref-for-dbsc-proof\u2468"}, {"id": "ref-for-dbsc-proof\u2460\u24ea"}, {"id": "ref-for-dbsc-proof\u2460\u2460"}, {"id": "ref-for-dbsc-proof\u2460\u2461"}], "title": "7.6. DBSC Proof JWT Syntax"}], "external": false};
</script>
<script>/* Boilerplate: script-dom-helper */
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}
</script>
<script>/* Boilerplate: script-var-click-highlighting */
/*
Color-choosing design:

Colors are ordered by goodness.
Each color has a usage count (initially zero).
Each variable has a last-used color.

* If the var has a last-used color, and that color's usage is 0,
    return that color.
* Otherwise, return the lowest-indexed color with the lowest usage.
    Increment the color's usage and set it as the last-used color
    for that var.
* On unclicking, decrement usage of the color.
*/
"use strict";
{
    document.addEventListener("click", e=>{
        if(e.target.nodeName == "VAR") {
            highlightSameAlgoVars(e.target);
        }
    });
    const indexCounts = new Map();
    const indexNames = new Map();
    function highlightSameAlgoVars(v) {
        // Find the algorithm container.
        let algoContainer = null;
        let searchEl = v;
        while(algoContainer == null && searchEl != document.body) {
            searchEl = searchEl.parentNode;
            if(searchEl.hasAttribute("data-algorithm")) {
                algoContainer = searchEl;
            }
        }

        // Not highlighting document-global vars,
        // too likely to be unrelated.
        if(algoContainer == null) return;

        const algoName = algoContainer.getAttribute("data-algorithm");
        const varName = getVarName(v);
        const addClass = !v.classList.contains("selected");
        let highlightClass = null;
        if(addClass) {
            const index = chooseHighlightIndex(algoName, varName);
            indexCounts.get(algoName)[index] += 1;
            indexNames.set(algoName+"///"+varName, index);
            highlightClass = nameFromIndex(index);
        } else {
            const index = previousHighlightIndex(algoName, varName);
            indexCounts.get(algoName)[index] -= 1;
            highlightClass = nameFromIndex(index);
        }

        // Find all same-name vars, and toggle their class appropriately.
        for(const el of algoContainer.querySelectorAll("var")) {
            if(getVarName(el) == varName) {
                el.classList.toggle("selected", addClass);
                el.classList.toggle(highlightClass, addClass);
            }
        }
    }
    function getVarName(el) {
        return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
    }
    function chooseHighlightIndex(algoName, varName) {
        let indexes = null;
        if(indexCounts.has(algoName)) {
            indexes = indexCounts.get(algoName);
        } else {
            // 7 classes right now
            indexes = [0,0,0,0,0,0,0];
            indexCounts.set(algoName, indexes);
        }

        // If the element was recently unclicked,
        // *and* that color is still unclaimed,
        // give it back the same color.
        const lastIndex = previousHighlightIndex(algoName, varName);
        if(indexes[lastIndex] === 0) return lastIndex;

        // Find the earliest index with the lowest count.
        const minCount = Math.min.apply(null, indexes);
        let index = null;
        for(var i = 0; i < indexes.length; i++) {
            if(indexes[i] == minCount) {
                return i;
            }
        }
    }
    function previousHighlightIndex(algoName, varName) {
        return indexNames.get(algoName+"///"+varName);
    }
    function nameFromIndex(index) {
        return "selected" + index;
    }
}
</script>