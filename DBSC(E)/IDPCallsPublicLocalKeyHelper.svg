<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1458.506691329522" height="2160.5088386428183"><desc>title%20IdP%20calls%20a%20public%20Local%20Key%20Helper%0A%0Aautonumber%201%0Aparticipant%20%22Relying%20Party%22%20as%20W%0Aparticipant%20%22IdP%22%20as%20I%0Aparticipant%20%22Browser%22%20as%20B%0Aparticipant%20%22Local%20Key%20Helper%22%20as%20P%0Aparticipant%20%22AttestationService%22%20as%20A%0A%0Anote%20over%20W%2C%20A%3A%20Sign%20in...%0AW-%3E%3EB%3A%20Start%20sign%20in%20(302)%0AB-%3E%3EI%3A%20Load%20sign-in%20(follow%20the%20302)%0A%0AI-%3E%3EB%3A%20Sec-Session-GenerateKey%3A%20%5CnRPUrl%2C%20IDPUrl%2C%20challenge%3Dnonce%2C%20extraParams...%5Cn%5CnSec-Session-HelperIdList%3A%20%5Cn%5BHelperId1%2C%20HelperId2%5D%2C%20HelperCacheTime%0AB-%3E%3EB%3A%20currentHelperId%20%3D%20%5CnEvaluate%20policy%20for%20(IdP%2C%20%5BHelperId1%2C%20HelperId2%2C...%5D)%0AB-%3E%3EP%3A%20Pre-gen%20key%20and%20%5Cnattest%20(RPUrl%2C%20IDPUrl%2C%20%5Cnchallenge%3Dnonce%2C%20extraParams...)%0A%0AP-%3E%3EP%3A%20Generate%20Key%0A%0AP-%3E%3EA%3A%20Get%20Binding%20Statement%20%5Cn(publicKey%2C%20AIK%2C%20challenge%3Dnonce)%0AA-%3E%3EP%3A%20Return%20binding%20statement%20%5Cn%7B%20nonce%2C%20thumbprint(publicKey)%2C%20extraClaims...%20%7D%0AP-%3E%3EB%3A%20KeyId%2C%20%5CnReturn%20binding%20statement%20%5Cn%7B%20nonce%2C%20thumbprint(publicKey)%2C%20extraClaims...%20%7D%0AB-%3E%3EB%3A%20Remember%20this%20key%20is%20for%20RP%20(and%20maybe%20path)%0AB-%3E%3EI%3A%20Sec-Session-Keys%3A%20KeyId%2C%20%5CnBinding%20statement%20%5Cn%7B%20nonce%2C%20thumbprint(publicKey)%2C%20extraClaims...%20%7D%0AI-%3E%3EI%3A%20validate%20signature%20on%20the%20binding%20statement%20%5Cn%26%20nonce%2C%20store%20thumbprint%0A%0AI-%3E%3EB%3A%20Sign%20in%20ceremony%0AB-%3E%3EI%3A%20Sign%20done%0A%0AI-%3E%3EB%3A%20Auth%20tokens%20(with%20thumbprint)%2C%20%5CnKeyId%0AB-%3E%3EW%3A%20Auth%20tokens%20(with%20thumbprint)%2C%20%5CnKeyId%0A%0Anote%20over%20W%2C%20A%3A%20Initiate%20DBSC%20...%0AW-%3E%3EB%3A%20StartSession%20%5Cn(challenge%3Dnonce%2C%20token%3F%2C%20KeyId%3F%2C%20**extraParams...**)%0AB-%3E%3EP%3A%20Request%20Sign%20JWT%20%5Cn(uri%2C%20challenge%3Dnonce%2C%5Cn%20token%3F%2C%20keyId%3F%2C%20**extraParams...**)%0AP-%3E%3EB%3A%20Return%20JWT%20Signature%0AB-%3E%3EW%3A%20POST%20%2Fsecuresession%2Fstartsession%20(JWT%2C%20tokens)%0AW-%3E%3EW%3A%20Validate%20JWT%2C%20%5Cn(w%2F%20match%20thumbprint%20%5Cnin%20the%20tokens)%0AW-%3E%3EB%3A%20AuthCookie%0A%0Anote%20over%20W%2C%20A%3A%20Refresh%20DBSC...%0AB-%3E%3EW%3A%20GET%20%2Fsecuresession%2Frefresh%20(sessionID)%0AW-%3E%3EB%3A%20Challenge%2C%20**extraParams...**%0AB-%3E%3EP%3A%20Request%20Sign%20JWT%20(sessionID%2C%20**extraParams...**)%0AP-%3E%3EB%3A%20Return%20JWT%20Signature%0AB-%3E%3EW%3A%20GET%20%2Fsecuresession%2Frefresh%20(JWT)%0AW-%3E%3EW%3A%20Validate%20JWT%20%5Cn(w%2Fpublic%20key%20on%20file)%0AW-%3E%3EB%3A%20AuthCookie%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1458" height="2160"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 95.73914152281817 L 69.48111046292188 2160.5088386428183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 269.13532867314325 95.73914152281817 L 269.13532867314325 2160.5088386428183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 638.6370329158516 95.73914152281817 L 638.6370329158516 2160.5088386428183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1011.381428198599 95.73914152281817 L 1011.381428198599 2160.5088386428183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1373.538833124901 95.73914152281817 L 1373.538833124901 2160.5088386428183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.167601649999995 51.79744464581818 L 130.79461927584376 51.79744464581818 L 130.79461927584376 95.73914152281817 L 8.167601649999995 95.73914152281817 L 8.167601649999995 51.79744464581818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.8912972305" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Relying Party</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 240.40948923277998 51.79744464581818 L 297.86116811350655 51.79744464581818 L 297.86116811350655 95.73914152281817 L 240.40948923277998 95.73914152281817 L 240.40948923277998 51.79744464581818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="258.13318481327997" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 594.030746087793 51.79744464581818 L 683.2433197439102 51.79744464581818 L 683.2433197439102 95.73914152281817 L 594.030746087793 95.73914152281817 L 594.030746087793 51.79744464581818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="611.754441668293" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Browser</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 937.8381449105794 51.79744464581818 L 1084.9247114866184 51.79744464581818 L 1084.9247114866184 95.73914152281817 L 937.8381449105794 95.73914152281817 L 937.8381449105794 51.79744464581818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="955.5618404910795" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Local Key Helper</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1296.73857657028 51.79744464581818 L 1450.3390896795222 51.79744464581818 L 1450.3390896795222 95.73914152281817 L 1296.73857657028 95.73914152281817 L 1296.73857657028 51.79744464581818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1314.4622721507799" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AttestationService</text></g></g><g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16pt" font-style="normal" font-weight="normal" text-decoration="normal" x="564.7914810180664" y="24.651306798181814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP calls a public Local Key Helper</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 54.779427492921876 128.4095481228182 L 1373.538833124901 128.4095481228182 L 1388.240516094901 143.1112310928182 L 1388.240516094901 165.98051571281817 L 54.779427492921876 165.98051571281817 L 54.779427492921876 128.4095481228182 M 1373.538833124901 128.4095481228182 L 1373.538833124901 143.1112310928182 L 1388.240516094901 143.1112310928182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="692.988151725552" y="151.27883274281814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sign in...</text></g><g><rect fill="white" stroke="none" x="299.86938079399613" y="190.4833206628182" width="120.60557807984375" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="302.31966128899614" y="205.18500363281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Start sign in (302)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="290.09346499993364" y="205.18500363281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 211.71908495281818 L 636.5951325033516 211.71908495281818" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(638.6370329158516,211.71908495281818) translate(-638.6370329158516,-211.71908495281818)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.6417885327976 205.47568746719475 L 637.1067330503021 211.71908495281818 L 624.6417885327976 217.9624824384416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="365.46242770428256" y="236.22188990281816" width="189.0737024694922" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="367.9127081992826" y="250.92357287281814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Load sign-in (follow the 302)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="355.6865119102201" y="250.92357287281814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 638.6370329158516 257.45765419281815 L 271.17722908564326 257.45765419281815" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(269.13532867314325,257.45765419281815) translate(-269.13532867314325,-257.45765419281815)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 283.1305730561973 251.21425670719472 L 270.6656285386927 257.45765419281815 L 283.1305730561973 263.7010516784416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="300.9098306583841" y="281.9604591428182" width="186.61128486695313" height="21.23576429"/><rect fill="white" stroke="none" x="300.9098306583841" y="298.2956624428182" width="318.1788813025" height="21.23576429"/><rect fill="white" stroke="none" x="300.9098306583841" y="330.96606904281816" width="178.45093025269531" height="21.23576429"/><rect fill="white" stroke="none" x="300.9098306583841" y="347.30127234281815" width="274.0629755407812" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="303.36011115338414" y="296.6621421128182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-GenerateKey: </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="291.13391486432164" y="296.6621421128182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="303.36011115338414" y="312.99734541281816" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RPUrl, IDPUrl, challenge=nonce, extraParams...</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="303.36011115338414" y="345.66775201281814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-HelperIdList: </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="303.36011115338414" y="362.00295531281813" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[HelperId1, HelperId2], HelperCacheTime</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 269.13532867314325 368.5370366328182 L 636.5951325033516 368.5370366328182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(638.6370329158516,368.5370366328182) translate(-638.6370329158516,-368.5370366328182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.6417885327976 362.2936391471947 L 637.1067330503021 368.5370366328182 L 624.6417885327976 374.78043411844163" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="670.1932197765808" y="393.0398415828182" width="122.6456781775" height="21.23576429"/><rect fill="white" stroke="none" x="670.1932197765808" y="409.3750448828182" width="326.4966913610937" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="672.6435002715808" y="407.7415245528182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">currentHelperId = </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="660.4173039825183" y="407.7415245528182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="672.6435002715808" y="424.0767278528182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Evaluate policy for (IdP, [HelperId1, HelperId2,...])</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 638.6370329158516 430.61080917281816 L 703.9778461158515 430.61080917281816 L 703.9778461158515 451.8465734628182 L 640.6789333283516 451.8465734628182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(638.6370329158516,451.8465734628182) translate(-638.6370329158516,-451.8465734628182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 652.6322772989056 445.6031759771947 L 640.1673327814011 451.8465734628182 L 652.6322772989056 458.08997094844165" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="718.8653694347838" y="476.34937841281817" width="116.54689277710938" height="21.23576429"/><rect fill="white" stroke="none" x="718.8653694347838" y="492.68458171281816" width="148.25770820679688" height="21.23576429"/><rect fill="white" stroke="none" x="718.8653694347838" y="509.01978501281815" width="224.51391853394531" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="721.3156499297838" y="491.05106138281815" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Pre-gen key and </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="709.0894536407213" y="491.05106138281815" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="721.3156499297838" y="507.38626468281814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">attest (RPUrl, IDPUrl, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="721.3156499297838" y="523.7214679828181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">challenge=nonce, extraParams...)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 638.6370329158516 530.2555493028182 L 1009.339527786099 530.2555493028182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1011.381428198599,530.2555493028182) translate(-1011.381428198599,-530.2555493028182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 997.386183815545 524.0121518171948 L 1009.8511283330495 530.2555493028182 L 997.386183815545 536.4989467884416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="1042.9376150593282" y="554.7583542528181" width="95.35866035523438" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1045.3878955543282" y="569.4600372228181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate Key</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1033.1616992652657" y="569.4600372228181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1011.381428198599 575.9941185428181 L 1076.722241398599 575.9941185428181 L 1076.722241398599 597.2298828328181 L 1013.423328611099 597.2298828328181" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1011.381428198599,597.2298828328181) translate(-1011.381428198599,-597.2298828328181)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1025.376672581653 590.9864853471947 L 1012.9117280641485 597.2298828328181 L 1025.376672581653 603.4732803184415" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="1084.408615730715" y="621.7326877828182" width="156.47532905640625" height="21.23576429"/><rect fill="white" stroke="none" x="1084.408615730715" y="638.0678910828182" width="228.32922615113281" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1086.858896225715" y="636.4343707528182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Get Binding Statement </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1074.6326999366524" y="636.4343707528182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1086.858896225715" y="652.7695740528181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(publicKey, AIK, challenge=nonce)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1011.381428198599 659.3036553728182 L 1371.496932712401 659.3036553728182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1373.538833124901,659.3036553728182) translate(-1373.538833124901,-659.3036553728182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1359.5435887418469 653.0602578871948 L 1372.0085332593515 659.3036553728182 L 1359.5435887418469 665.5470528584416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="1042.9376150593282" y="683.8064603228182" width="172.77452339234375" height="21.23576429"/><rect fill="white" stroke="none" x="1042.9376150593282" y="700.1416636228182" width="311.2711969763281" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1045.3878955543282" y="698.5081432928182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return binding statement </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1033.1616992652657" y="698.5081432928182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1045.3878955543282" y="714.8433465928182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{ nonce, thumbprint(publicKey), extraClaims... }</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1373.538833124901 721.3774279128182 L 1013.423328611099 721.3774279128182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1011.381428198599,721.3774279128182) translate(-1011.381428198599,-721.3774279128182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1025.376672581653 715.1340304271948 L 1012.9117280641485 721.3774279128182 L 1025.376672581653 727.6208253984416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="675.4867149548033" y="745.8802328628183" width="50.53404487671875" height="21.23576429"/><rect fill="white" stroke="none" x="675.4867149548033" y="762.2154361628183" width="172.77452339234375" height="21.23576429"/><rect fill="white" stroke="none" x="675.4867149548033" y="778.5506394628183" width="311.2711969763281" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="677.9369954498034" y="760.5819158328183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">KeyId, </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="665.7107991607409" y="760.5819158328183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="677.9369954498034" y="776.9171191328182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return binding statement </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="677.9369954498034" y="793.2523224328182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{ nonce, thumbprint(publicKey), extraClaims... }</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1011.381428198599 799.7864037528183 L 640.6789333283516 799.7864037528183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(638.6370329158516,799.7864037528183) translate(-638.6370329158516,-799.7864037528183)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 652.6322772989056 793.5430062671949 L 640.1673327814011 799.7864037528183 L 652.6322772989056 806.0298012384417" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="678.3464027599792" y="824.2892087028182" width="310.4337030798437" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="680.7966832549793" y="838.9908916728182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Remember this key is for RP (and maybe path)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="660.4173039825183" y="838.9908916728182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 638.6370329158516 845.5249729928182 L 703.9778461158515 845.5249729928182 L 703.9778461158515 866.7607372828182 L 640.6789333283516 866.7607372828182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(638.6370329158516,866.7607372828182) translate(-638.6370329158516,-866.7607372828182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 652.6322772989056 860.5173397971948 L 640.1673327814011 866.7607372828182 L 652.6322772989056 873.0041347684416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="308.03581485027865" y="891.2635422328183" width="178.45093025269531" height="21.23576429"/><rect fill="white" stroke="none" x="308.03581485027865" y="907.5987455328183" width="126.3249994665625" height="21.23576429"/><rect fill="white" stroke="none" x="308.03581485027865" y="923.9339488328183" width="311.2711969763281" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.48609534527867" y="905.9652252028183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Keys: KeyId, </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="290.9155997398099" y="905.9652252028183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">11 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.48609534527867" y="922.3004285028182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Binding statement </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.48609534527867" y="938.6356318028182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{ nonce, thumbprint(publicKey), extraClaims... }</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 638.6370329158516 945.1697131228183 L 271.17722908564326 945.1697131228183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(269.13532867314325,945.1697131228183) translate(-269.13532867314325,-945.1697131228183)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 283.1305730561973 938.9263156371949 L 270.6656285386927 945.1697131228183 L 283.1305730561973 951.4131106084417" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="308.84469851727084" y="969.6725180728182" width="288.51530708375" height="21.23576429"/><rect fill="white" stroke="none" x="308.84469851727084" y="986.0077213728182" width="172.76735176148438" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="311.29497901227086" y="984.3742010428182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">validate signature on the binding statement </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="290.9155997398099" y="984.3742010428182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">12 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="311.29497901227086" y="1000.7094043428182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp; nonce, store thumbprint</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 269.13532867314325 1007.2434856628182 L 334.47614187314326 1007.2434856628182 L 334.47614187314326 1028.4792499528182 L 271.17722908564326 1028.4792499528182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(269.13532867314325,1028.4792499528182) translate(-269.13532867314325,-1028.4792499528182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 283.1305730561973 1022.2358524671948 L 270.6656285386927 1028.4792499528182 L 283.1305730561973 1034.7226474384415" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="404.99354800457553" y="1052.9820549028184" width="118.16464485230469" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="407.44382849957555" y="1067.6837378728185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sign in ceremony</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="387.0644492271146" y="1067.6837378728185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">13 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 269.13532867314325 1074.2178191928183 L 636.5951325033516 1074.2178191928183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(638.6370329158516,1074.2178191928183) translate(-638.6370329158516,-1074.2178191928183)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.6417885327976 1067.974421707195 L 637.1067330503021 1074.2178191928183 L 624.6417885327976 1080.4612166784416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="428.6120019840677" y="1098.7206241428185" width="70.92773689332031" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.06228247906773" y="1113.4223071128185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sign done</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="410.6829032066068" y="1113.4223071128185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">14 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 638.6370329158516 1119.9563884328184 L 271.17722908564326 1119.9563884328184" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(269.13532867314325,1119.9563884328184) translate(-269.13532867314325,-1119.9563884328184)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 283.1305730561973 1113.712990947195 L 270.6656285386927 1119.9563884328184 L 283.1305730561973 1126.1997859184416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="362.2197595524271" y="1144.4591933828183" width="203.71222175660156" height="21.23576429"/><rect fill="white" stroke="none" x="362.2197595524271" y="1160.7943966828184" width="42.38801826539063" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="364.6700400474271" y="1159.1608763528184" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Auth tokens (with thumbprint), </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="344.29066077496617" y="1159.1608763528184" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">15 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="364.6700400474271" y="1175.4960796528185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">KeyId</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 269.13532867314325 1182.0301609728183 L 636.5951325033516 1182.0301609728183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(638.6370329158516,1182.0301609728183) translate(-638.6370329158516,-1182.0301609728183)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.6417885327976 1175.786763487195 L 637.1067330503021 1182.0301609728183 L 624.6417885327976 1188.2735584584416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="262.39265044731644" y="1206.5329659228182" width="203.71222175660156" height="21.23576429"/><rect fill="white" stroke="none" x="262.39265044731644" y="1222.8681692228183" width="42.38801826539063" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="264.84293094231646" y="1221.2346488928183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Auth tokens (with thumbprint), </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="244.46355166985552" y="1221.2346488928183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">16 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="264.84293094231646" y="1237.5698521928184" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">KeyId</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 638.6370329158516 1244.1039335128182 L 71.52301087542187 1244.1039335128182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(69.48111046292188,1244.1039335128182) translate(-69.48111046292188,-1244.1039335128182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 83.4763548459759 1237.860536027195 L 71.01141032847136 1244.1039335128182 L 83.4763548459759 1250.3473309984415" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 54.779427492921876 1268.6067384628182 L 1373.538833124901 1268.6067384628182 L 1388.240516094901 1283.3084214328182 L 1388.240516094901 1306.1777060528182 L 54.779427492921876 1306.1777060528182 L 54.779427492921876 1268.6067384628182 M 1373.538833124901 1268.6067384628182 L 1373.538833124901 1283.3084214328182 L 1388.240516094901 1283.3084214328182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="669.3661043012356" y="1291.4760230828183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Initiate DBSC ...</text></g><g><rect fill="white" stroke="none" x="194.11422332329303" y="1330.680511002818" width="92.08734382691406" height="21.23576429"/><rect fill="white" stroke="none" x="194.11422332329303" y="1347.0157143028182" width="235.1438471228125" height="21.23576429"/><rect fill="white" stroke="none" x="194.11422332329303" y="1347.0157143028182" width="105.14390815796875" height="21.23576429"/><rect fill="white" stroke="none" x="194.11422332329303" y="1347.0157143028182" width="9.782442703867186" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="196.56450381829302" y="1345.3821939728182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">StartSession </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="176.18512454583208" y="1345.3821939728182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">17 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="196.56450381829302" y="1361.7173972728183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(challenge=nonce, token?, KeyId?, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="426.8077899511055" y="1361.7173972728183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">extraParams...</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="527.0511371190743" y="1361.7173972728183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 1368.251478592818 L 636.5951325033516 1368.251478592818" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(638.6370329158516,1368.251478592818) translate(-638.6370329158516,-1368.251478592818)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.6417885327976 1362.0080811071948 L 637.1067330503021 1368.251478592818 L 624.6417885327976 1374.4948760784414" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="726.3993583874205" y="1392.754283542818" width="131.18542732300781" height="21.23576429"/><rect fill="white" stroke="none" x="726.3993583874205" y="1409.0894868428181" width="149.560473099375" height="21.23576429"/><rect fill="white" stroke="none" x="726.3993583874205" y="1425.4246901428182" width="112.47389473023438" height="21.23576429"/><rect fill="white" stroke="none" x="726.3993583874205" y="1425.4246901428182" width="105.14390815796875" height="21.23576429"/><rect fill="white" stroke="none" x="726.3993583874205" y="1425.4246901428182" width="9.782442703867186" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="728.8496388824205" y="1407.4559665128181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Request Sign JWT </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="708.4702596099596" y="1407.4559665128181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">18 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="728.8496388824205" y="1423.7911698128182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(uri, challenge=nonce,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="728.8496388824205" y="1440.1263731128183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> token?, keyId?, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="836.4229726226549" y="1440.1263731128183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">extraParams...</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="936.6663197906237" y="1440.1263731128183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 638.6370329158516 1446.6604544328181 L 1009.339527786099 1446.6604544328181" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1011.381428198599,1446.6604544328181) translate(-1011.381428198599,-1446.6604544328181)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 997.386183815545 1440.4170569471949 L 1009.8511283330495 1446.6604544328181 L 997.386183815545 1452.9038519184414" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="760.236135120819" y="1471.1632593828183" width="149.92557014527344" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="762.686415615819" y="1485.8649423528184" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return JWT Signature</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="742.307036343358" y="1485.8649423528184" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">19 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1011.381428198599 1492.3990236728182 L 640.6789333283516 1492.3990236728182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(638.6370329158516,1492.3990236728182) translate(-638.6370329158516,-1492.3990236728182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 652.6322772989056 1486.155626187195 L 640.1673327814011 1492.3990236728182 L 652.6322772989056 1498.6424211584415" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="202.93312438530475" y="1516.9018286228184" width="322.631273880625" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="205.38340488030474" y="1531.6035115928184" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /securesession/startsession (JWT, tokens)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="185.0040256078438" y="1531.6035115928184" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">20 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 638.6370329158516 1538.1375929128183 L 71.52301087542187 1538.1375929128183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(69.48111046292188,1538.1375929128183) translate(-69.48111046292188,-1538.1375929128183)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 83.4763548459759 1531.894195427195 L 71.01141032847136 1538.1375929128183 L 83.4763548459759 1544.3809903984416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="109.19048030704947" y="1562.6403978628182" width="97.50612129273438" height="21.23576429"/><rect fill="white" stroke="none" x="109.19048030704947" y="1578.9756011628183" width="145.84540046753906" height="21.23576429"/><rect fill="white" stroke="none" x="109.19048030704947" y="1595.3108044628184" width="92.91054023804688" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.64076080204947" y="1577.3420808328183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate JWT, </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="91.26138152958853" y="1577.3420808328183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">21 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.64076080204947" y="1593.6772841328184" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(w/ match thumbprint </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.64076080204947" y="1610.0124874328185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">in the tokens)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 1616.5465687528183 L 134.82192366292188 1616.5465687528183 L 134.82192366292188 1637.7823330428182 L 71.52301087542187 1637.7823330428182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(69.48111046292188,1637.7823330428182) translate(-69.48111046292188,-1637.7823330428182)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 83.4763548459759 1631.538935557195 L 71.01141032847136 1637.7823330428182 L 83.4763548459759 1644.0257305284415" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="323.90300353569535" y="1662.2851379928184" width="80.69151557984375" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="326.35328403069536" y="1676.9868209628185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthCookie</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="305.9739047582344" y="1676.9868209628185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">22 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 1683.5209022828183 L 636.5951325033516 1683.5209022828183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(638.6370329158516,1683.5209022828183) translate(-638.6370329158516,-1683.5209022828183)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.6417885327976 1677.277504797195 L 637.1067330503021 1683.5209022828183 L 624.6417885327976 1689.7642997684416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 54.779427492921876 1708.0237072328182 L 1373.538833124901 1708.0237072328182 L 1388.240516094901 1722.7253902028183 L 1388.240516094901 1745.5946748228182 L 54.779427492921876 1745.5946748228182 L 54.779427492921876 1708.0237072328182 M 1373.538833124901 1708.0237072328182 L 1373.538833124901 1722.7253902028183 L 1388.240516094901 1722.7253902028183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="667.3331758344387" y="1730.8929918528183" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Refresh DBSC...</text></g><g><rect fill="white" stroke="none" x="231.8522299150899" y="1770.0974797728184" width="264.7930780798437" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="234.3025104100899" y="1784.7991627428185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh (sessionID)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="213.92313113762896" y="1784.7991627428185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">23 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 638.6370329158516 1791.3332440628183 L 71.52301087542187 1791.3332440628183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(69.48111046292188,1791.3332440628183) translate(-69.48111046292188,-1791.3332440628183)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 83.4763548459759 1785.089846577195 L 71.01141032847136 1791.3332440628183 L 83.4763548459759 1797.5766415484416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="274.5937841753438" y="1815.8360490128184" width="79.06660713257813" height="21.23576429"/><rect fill="white" stroke="none" x="274.5937841753438" y="1815.8360490128184" width="105.14390815796875" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="277.0440646703438" y="1830.5377319828185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Challenge, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="351.2101108129219" y="1830.5377319828185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">extraParams...</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="256.66468539788286" y="1830.5377319828185" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">24 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 1837.0718133028183 L 636.5951325033516 1837.0718133028183" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(638.6370329158516,1837.0718133028183) translate(-638.6370329158516,-1837.0718133028183)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.6417885327976 1830.828415817195 L 637.1067330503021 1837.0718133028183 L 624.6417885327976 1843.3152107884416" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="678.3464027599791" y="1861.5746182528185" width="208.5798059851172" height="21.23576429"/><rect fill="white" stroke="none" x="678.3464027599791" y="1861.5746182528185" width="105.14390815796875" height="21.23576429"/><rect fill="white" stroke="none" x="678.3464027599791" y="1861.5746182528185" width="9.782442703867186" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="680.7966832549791" y="1876.2763012228186" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Request Sign JWT (sessionID, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="884.4759282500963" y="1876.2763012228186" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">extraParams...</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="984.7192754180651" y="1876.2763012228186" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="660.4173039825182" y="1876.2763012228186" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">25 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 638.6370329158516 1882.8103825428184 L 1009.339527786099 1882.8103825428184" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1011.381428198599,1882.8103825428184) translate(-1011.381428198599,-1882.8103825428184)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 997.386183815545 1876.566985057195 L 1009.8511283330495 1882.8103825428184 L 997.386183815545 1889.0537800284417" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="760.236135120819" y="1907.3131874928185" width="149.92557014527344" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="762.686415615819" y="1922.0148704628186" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return JWT Signature</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="742.307036343358" y="1922.0148704628186" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">26 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1011.381428198599 1928.5489517828184 L 640.6789333283516 1928.5489517828184" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(638.6370329158516,1928.5489517828184) translate(-638.6370329158516,-1928.5489517828184)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 652.6322772989056 1922.3055542971952 L 640.1673327814011 1928.5489517828184 L 652.6322772989056 1934.7923492684417" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="248.97462066216022" y="1953.0517567328186" width="230.54828132691406" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="251.4249011571602" y="1967.7534397028187" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh (JWT)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="231.04552188469927" y="1967.7534397028187" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">27 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 638.6370329158516 1974.2875210228185 L 71.52301087542187 1974.2875210228185" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(69.48111046292188,1974.2875210228185) translate(-69.48111046292188,-1974.2875210228185)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 83.4763548459759 1968.0441235371952 L 71.01141032847136 1974.2875210228185 L 83.4763548459759 1980.5309185084418" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="109.19048030704947" y="1998.7903259728187" width="95.05801643433594" height="21.23576429"/><rect fill="white" stroke="none" x="109.19048030704947" y="2015.1255292728188" width="137.70649971070313" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.64076080204947" y="2013.4920089428188" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate JWT </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="91.26138152958853" y="2013.4920089428188" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">28 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.64076080204947" y="2029.8272122428189" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(w/public key on file)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 2036.3612935628187 L 134.82192366292188 2036.3612935628187 L 134.82192366292188 2057.5970578528186 L 71.52301087542187 2057.5970578528186" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(69.48111046292188,2057.5970578528186) translate(-69.48111046292188,-2057.5970578528186)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 83.4763548459759 2051.353660367195 L 71.01141032847136 2057.5970578528186 L 83.4763548459759 2063.840455338442" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><rect fill="white" stroke="none" x="323.90300353569535" y="2082.0998628028183" width="80.69151557984375" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="326.35328403069536" y="2096.8015457728184" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthCookie</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="305.9739047582344" y="2096.8015457728184" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">29 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 69.48111046292188 2103.3356270928184 L 636.5951325033516 2103.3356270928184" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(638.6370329158516,2103.3356270928184) translate(-638.6370329158516,-2103.3356270928184)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.6417885327976 2097.092229607195 L 637.1067330503021 2103.3356270928184 L 624.6417885327976 2109.579024578442" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g></g></g></svg>