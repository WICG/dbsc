<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1650.5746479641668" height="2928.5364086790914"><desc>title%20IdP%20calls%20a%20private%20Local%20Key%20Helper%0A%0Aautonumber%201%0Aparticipant%20%22Relying%20Party%22%20as%20W%0Aparticipant%20%22IdP%22%20as%20I%0Aparticipant%20%22Browser%22%20as%20B%0Aparticipant%20%22Local%20Key%20Helper%22%20as%20P%0A%0Anote%20over%20W%2C%20P%3A%20IdP%20life...%0AB-%3E%3EI%3A%20Any%20request%0AI-%3E%3EB%3A%20Any%20response%5CnSec-Session-HelperIdList%3A%20%5BHelperId1%2C%20HelperId2%5D%2C%20HelperCacheTime%0AB-%3E%3EB%3A%20Cache%20HelperId%20for%20IDPURL%20for%20HelperCacheTime%0A%0Anote%20over%20W%2C%20P%3A%20Sign%20in...%0AW-%3E%3EB%3A%20Start%20sign%20in%20(302)%5CnSec-Session-Registration%3A%20path%2C%20RPChallenge%2C...%20%5CnSec-Session-GenerateKey%3A%20RPURL%2C%20IDPURL%2C%20extraParams%0AB-%3E%3EB%3A%20Check%20for%20cached%20HelperId%20for%20IDPURL%0A%0Aalt%20Cached%20HelperId%20present%20(99.99%25%20cases)%0A%0A%20%20%20%20B-%3E%3EB%3A%20currentHelperId%20%3D%20Evaluate%20policy%20for%20(IdP%2C%20%5BHelperId1%2C%20HelperId2...%5D)%0A%0A%20%20%20%20B-%3E%3EP%3A%20Pre-gen%20key%20and%20attest%20(RPURL%2C%20IDPURL%2C%20extraParams...)%0A%0A%20%20%20%20P-%3E%3EP%3A%20Generate%20Key%0A%0A%20%20%20%20loop%20For%20each%20device%0A%20%20%20%20%20%20%20%20P-%3E%3EP%3A%20create%20binding%20statement%20S(publicKey%2C%20AIK)%0A%20%20%20%20end%0A%0A%20%20%20%20P-%3E%3EB%3A%20Return%3A%20KeyId%2C%20%5Cnarray%20of%20binding%20statements%20%5BBindingStatement1%20%7BextraClaims....%7D%2C%20%5CnBindingStatement2%20%7BextraCalims...%7D%5D%0A%20%20%20%20B-%3E%3EB%3A%20Remember%20this%20key%20is%20for%20RP%20(and%20maybe%20path)%0A%0A%20%20%20%20B-%3E%3EI%3A%20Load%20sign-in%20(follow%20the%20302)%5Cn%5Cnx-ms-RefreshTokenCredential1%7Bnonce%7D%5Cnx-ms-DeviceCredential1%7Bnonce%7D%5Cnx-ms-RefreshTokenCredential2%7Bnonce%7D%5Cnx-ms-DeviceCredential2%7Bnonce%7D%20...%5Cn%5CnSec-Session-BindingInfo%3A%20KeyId%2C%20PublicKey%2C%20%5Cnarray%20of%20binding%20statements%20%5BBindingStatement1%20%7BextraClaims....%7D%2C%20%5CnBindingStatement2%20%7BextraCalims...%7D%5D%0A%0A%20%20%20%20opt%20nonce%20is%20stale%0A%20%20%20%20%20%20%20%20I-%3E%3EB%3A%20302%20to%20IdP%20with%20qs%20parameter%20sso_nonce%3Dnew_nonce%5CnSec-Session-GenerateKey%3A%20RPURL%2C%20IDPURL%2C%20extraParams%0A%20%20%20%20%20%20%20%20B-%3E%3EI%3A%20Load%20sign-in%5Cn%5Cnx-ms-RefreshTokenCredential1%7Bnew_nonce%7D%5Cnx-ms-DeviceCredential1%7Bnew_nonce%7D%5Cnx-ms-RefreshTokenCredential2%7Bnew_nonce%7D%5Cnx-ms-DeviceCredential2%7Bnew_nonce%7D%20...%5Cn%5CnSec-Session-BindingInfo%3A%20KeyId%2C%20PublicKey%2C%20%5Cnarray%20of%20binding%20statements%20%5BBindingStatement1%20%7BextraClaims....%7D%2C%20%5CnBindingStatement2%20%7BextraCalims...%7D%5D%0A%20%20%20%20end%0A%0Aelse%20No%20cached%20HelperId%20present%0A%0A%0A%20%20%20%20B-%3E%3EI%3A%20Load%20sign-in%20(follow%20the%20302)%5Cn%5Cnx-ms-RefreshTokenCredential1%7Bnonce%7D%5Cnx-ms-DeviceCredential1%7Bnonce%7D%5Cnx-ms-RefreshTokenCredential2%7Bnonce%7D%5Cnx-ms-DeviceCredential2%7Bnonce%7D%20...%20%5Cn%5CnSec-Session-HelperDiscoveryNeeded%3A%20RPURL%2C%20IDPURL%2C%20extraParams%0A%0A%20%20%20%20note%20over%20I%2C%20B%3A%20No%20binding%20info%20present%2C%20but%20the%20reequest%20has%20GenerratKey%2C%20so%20IdP%20issues%20helper%20id%20list%0A%0A%20%20%20%20I-%3E%3EB%3A%20302%20to%20IdP%20with%20qs%20parameter%20sso_nonce%3Dnew_nonce%5Cn%5CnSec-Session-GenerateKey%3A%20RPURL%2C%20IDPURL%2C%20extraParams%5CnSec-Session-HelperIdList%3A%20%5BHelperId1%2C%20HelperId2%5D%2C%20HelperCacheTime%0A%20%20%20%20B-%3E%3EB%3A%20Cache%20HelperId%20for%20IDPURL%20for%20HelperCacheTime%0A%0A%20%20%20%20B-%3E%3EB%3A%20currentHelperId%20%3D%20Evaluate%20policy%20for%20(IdP%2C%20%5BHelperId1%5D)%0A%20%20%20%20B-%3E%3EP%3A%20Pre-gen%20key%20and%20attest%20(RPURL%2C%20IDPURL%2C%20extraParams...)%0A%0A%20%20%20%20P-%3E%3EP%3A%20Generate%20Key%0A%0A%20%20%20%20loop%20For%20each%20device%0A%20%20%20%20%20%20%20%20P-%3E%3EP%3A%20create%20binding%20statement%20S(publicKey%2C%20AIK)%0A%20%20%20%20end%0A%0A%20%20%20%20P-%3E%3EB%3A%20Return%3A%20KeyId%2C%20%5Cnarray%20of%20binding%20statements%20%5BBindingStatement1%20%7BextraClaims....%7D%2C%20%5CnBindingStatement2%20%7BextraCalims...%7D%5D%0A%20%20%20%20B-%3E%3EB%3A%20Remember%20this%20key%20is%20for%20RP%20(and%20maybe%20path)%0A%0A%20%20%20%20B-%3E%3EI%3A%20Load%20sign-in%5Cn%5Cnx-ms-RefreshTokenCredential1%7Bnew_nonce%7D%5Cnx-ms-DeviceCredential1%7Bnew_nonce%7D%5Cn%20x-ms-RefreshTokenCredential2%7Bnew_nonce%7D%5Cn%20x-ms-DeviceCredential2%7Bnew_nonce%7D%20...%20%5Cn%5CnSec-Session-BindingInfo%3A%20KeyId%2C%20PublicKey%2C%20%5Cnarray%20of%20binding%20statements%20%5BBindingStatement1%20%7BextraClaims....%7D%2C%20%5CnBindingStatement2%20%7BextraCalims...%7D%5D%0A%0A%0Aend%0A%0Aopt%20SSO%20information%20is%20not%20sufficient%0A%20%20%20%20I-%3E%3EB%3A%20Sign%20in%20ceremony%0A%20%20%20%20B-%3E%3EI%3A%20Sign%20done%0Aend%0A%0AI-%3E%3EB%3A%20Authorization%20code%2C%20KeyId%0A%0A%0Anote%20over%20W%2C%20B%3A%20Since%20DBSC%20session%20has%20been%20initialized%20already%20for%20RP%2C%20browser%20needs%20to%20generate%20JWT%20on%20redirect%20back%0AB-%3E%3EP%3A%20Request%20Sign%20JWT%20(path%2C%20RPChallenge%2C%20extraParams)%0AP-%3E%3EB%3A%20Return%20JWT%20Signature%0Anote%20over%20W%2C%20B%3A%20JWT%20is%20appended%20by%20the%20browser%20before%20returning%20the%20response%20from%20IDP%20back%20to%20the%20RP%0AB-%3E%3EW%3A%20Authorization%20code%2C%20KeyId%2C%20JWT%0AW-%3E%3EI%3A%20(confidential%20client%20request)%20redeem%20authorization%20code%0AI-%3E%3EW%3A%20(confidential%20client%20response)%20return%20id_token%0AW-%3E%3EW%3A%20parse%20id_token%20and%20validate%20binding%2C%20match%20with%20the%20JWT%20from%20the%20previous%0AW-%3E%3EB%3A%20Bound%20AuthCookie%0A%0Anote%20over%20W%2C%20P%3A%20Refresh%20DBSC...%0AB-%3E%3EW%3A%20GET%20%2Fsecuresession%2Frefresh%20(sessionID)%0AW-%3E%3EB%3A%20Challenge%2C%20**extraParams**%0AB-%3E%3EP%3A%20Request%20Sign%20JWT%20(sessionID%2C%20RPChallenge%2C%20**extraParams**)%0AP-%3E%3EB%3A%20Return%20JWT%20Signature%0AB-%3E%3EW%3A%20GET%20%2Fsecuresession%2Frefresh%20(JWT)%0AW-%3E%3EW%3A%20Validate%20JWT%20(w%2Fpublic%20key%20on%20file)%0AW-%3E%3EB%3A%20AuthCookie%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1650" height="2928"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 55.59704654749999 73.6454934790909 L 55.59704654749999 2928.5364086790914" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray="9.665800769230769,4.188513666666666"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 492.18855921416673 73.6454934790909 L 492.18855921416673 2928.5364086790914" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray="9.665800769230769,4.188513666666666"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 73.6454934790909 L 960.1271470891668 2928.5364086790914" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray="9.665800769230769,4.188513666666666"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1357.8305689225 73.6454934790909 L 1357.8305689225 2928.5364086790914" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray="9.665800769230769,4.188513666666666"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 6.282770499999998 39.84418818909091 L 104.91132259499999 39.84418818909091 L 104.91132259499999 73.6454934790909 L 6.282770499999998 73.6454934790909 L 6.282770499999998 39.84418818909091 Z" stroke-miterlimit="10" stroke-width="2.01048656" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.916382484999993" y="61.07995247909089" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Relying Party</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 469.5490878541667 39.84418818909091 L 514.8280305741667 39.84418818909091 L 514.8280305741667 73.6454934790909 L 469.5490878541667 73.6454934790909 L 469.5490878541667 39.84418818909091 Z" stroke-miterlimit="10" stroke-width="2.01048656" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="483.18269983916673" y="61.07995247909089" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 924.4886522916668 39.84418818909091 L 995.7656418866668 39.84418818909091 L 995.7656418866668 73.6454934790909 L 924.4886522916668 73.6454934790909 L 924.4886522916668 39.84418818909091 Z" stroke-miterlimit="10" stroke-width="2.01048656" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="938.1222642766668" y="61.07995247909089" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Browser</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1298.5055506875 39.84418818909091 L 1417.1555871575001 39.84418818909091 L 1417.1555871575001 73.6454934790909 L 1298.5055506875 73.6454934790909 L 1298.5055506875 39.84418818909091 Z" stroke-miterlimit="10" stroke-width="2.01048656" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1312.1391626725" y="61.07995247909089" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Local Key Helper</text></g></g><g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="13.090909090909092pt" font-style="normal" font-weight="normal" text-decoration="normal" x="687.270393371582" y="18.962543690909094" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP calls a private Local Key Helper</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 44.28805964749999 98.77657547909091 L 1357.8305689225 98.77657547909091 L 1369.1395558225001 110.0855623790909 L 1369.1395558225001 127.67731977909091 L 44.28805964749999 127.67731977909091 L 44.28805964749999 98.77657547909091 M 1357.8305689225 98.77657547909091 L 1357.8305689225 110.0855623790909 L 1369.1395558225001 110.0855623790909" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="683.370057735" y="116.36833287909091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP life...</text></g><g><rect fill="white" stroke="none" x="697.2583735641668" y="146.52563127909093" width="67.806771675" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="699.1432047141668" y="157.83461817909094" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Any request</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="689.1353922141668" y="157.83461817909094" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 162.86083457909092 L 493.7592518391667 162.86083457909092" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(492.18855921416673,162.86083457909092) translate(-492.18855921416673,-162.86083457909092)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 502.954131816516 158.05822112861134 L 493.3657129568971 162.86083457909092 L 502.954131816516 167.6634480295705" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="548.0845454391668" y="181.70914607909094" width="77.146615425" height="16.3352033"/><rect fill="white" stroke="none" x="548.0845454391668" y="194.27468707909094" width="366.154427925" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="549.9693765891668" y="193.01813297909095" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Any response</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="539.9615640891668" y="193.01813297909095" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="549.9693765891668" y="205.58367397909095" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-HelperIdList: [HelperId1, HelperId2], HelperCacheTime</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 492.18855921416673 210.60989037909093 L 958.5564544641668 210.60989037909093" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,210.60989037909093) translate(-960.1271470891668,-210.60989037909093)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 949.3615744868175 205.80727692861134 L 958.9499933464364 210.60989037909093 L 949.3615744868175 215.4125038295705" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="985.0041831058335" y="229.45820187909092" width="268.759896675" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="986.8890142558334" y="240.76718877909093" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Cache HelperId for IDPURL for HelperCacheTime</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="976.8812017558334" y="240.76718877909093" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 245.79340517909094 L 1010.3893110891668 245.79340517909094 L 1010.3893110891668 262.12860847909093 L 961.6978397141668 262.12860847909093" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,262.12860847909093) translate(-960.1271470891668,-262.12860847909093)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 970.892719691516 257.3259950286114 L 961.3043008318972 262.12860847909093 L 970.892719691516 266.9312219295705" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 44.28805964749999 280.97691997909095 L 1357.8305689225 280.97691997909095 L 1369.1395558225001 292.28590687909093 L 1369.1395558225001 309.87766427909094 L 44.28805964749999 309.87766427909094 L 44.28805964749999 280.97691997909095 M 1357.8305689225 280.97691997909095 L 1357.8305689225 292.28590687909093 L 1369.1395558225001 292.28590687909093" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="683.3671280475" y="298.5686773790909" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sign in...</text></g><g><rect fill="white" stroke="none" x="353.58957035583336" y="328.72597577909096" width="98.4805998" height="16.3352033"/><rect fill="white" stroke="none" x="353.58957035583336" y="341.29151677909095" width="263.23450605" height="16.3352033"/><rect fill="white" stroke="none" x="353.58957035583336" y="353.85705777909095" width="318.552865425" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.4744015058334" y="340.03496267909094" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Start sign in (302)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="345.4665890058334" y="340.03496267909094" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.4744015058334" y="352.60050367909093" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-Registration: path, RPChallenge,... </text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.4744015058334" y="365.16604467909093" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-GenerateKey: RPURL, IDPURL, extraParams</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 55.59704654749999 370.19226107909094 L 958.5564544641668 370.19226107909094" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,370.19226107909094) translate(-960.1271470891668,-370.19226107909094)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 949.3615744868175 365.3896476286114 L 958.9499933464364 370.19226107909094 L 949.3615744868175 374.9948745295705" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="985.0041831058335" y="389.04057257909096" width="210.52356855" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="986.8890142558334" y="400.34955947909094" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Check for cached HelperId for IDPURL</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="976.8812017558334" y="400.34955947909094" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 405.37577587909095 L 1010.3893110891668 405.37577587909095 L 1010.3893110891668 421.71097917909094 L 961.6978397141668 421.71097917909094" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,421.71097917909094) translate(-960.1271470891668,-421.71097917909094)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 970.892719691516 416.9083657286114 L 961.3043008318972 421.71097917909094 L 970.892719691516 426.5135926295705" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="985.0041831058335" y="474.48625137909096" width="360.060677925" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="986.8890142558334" y="485.79523827909094" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">currentHelperId = Evaluate policy for (IdP, [HelperId1, HelperId2...])</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="976.8812017558334" y="485.79523827909094" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 490.82145467909095 L 1010.3893110891668 490.82145467909095 L 1010.3893110891668 507.15665797909094 L 961.6978397141668 507.15665797909094" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,507.15665797909094) translate(-960.1271470891668,-507.15665797909094)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 970.892719691516 502.3540445286114 L 961.3043008318972 507.15665797909094 L 970.892719691516 511.9592714295705" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="1008.0432456058335" y="526.004969479091" width="311.8790373" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1009.9280767558334" y="537.313956379091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Pre-gen key and attest (RPURL, IDPURL, extraParams...)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="999.9202642558334" y="537.313956379091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 542.340172779091 L 1356.2598762975 542.340172779091" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(1357.8305689225,542.340172779091) translate(-1357.8305689225,-542.340172779091)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1347.0649963201508 537.5375593286113 L 1356.6534151797698 542.340172779091 L 1347.0649963201508 547.1427862295706" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="1382.7076049391667" y="561.188484279091" width="77.814584175" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1384.5924360891668" y="572.497471179091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate Key</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1374.5846235891668" y="572.497471179091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1357.8305689225 577.523687579091 L 1408.0927329225 577.523687579091 L 1408.0927329225 593.858890879091 L 1359.4012615475 593.858890879091" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(1357.8305689225,593.858890879091) translate(-1357.8305689225,-593.858890879091)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1368.5961415248494 589.0562774286113 L 1359.0077226652304 593.858890879091 L 1368.5961415248494 598.6615043295706" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="1382.7076049391667" y="646.634163079091" width="231.66419355" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1384.5924360891668" y="657.943149979091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">create binding statement S(publicKey, AIK)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1374.5846235891668" y="657.943149979091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1357.8305689225 662.969366379091 L 1408.0927329225 662.969366379091 L 1408.0927329225 679.304569679091 L 1359.4012615475 679.304569679091" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(1357.8305689225,679.304569679091) translate(-1357.8305689225,-679.304569679091)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1368.5961415248494 674.5019562286113 L 1359.0077226652304 679.304569679091 L 1368.5961415248494 684.1071831295706" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="991.6780112308335" y="717.001192679091" width="83.8087248" height="16.3352033"/><rect fill="white" stroke="none" x="991.6780112308335" y="729.566733679091" width="351.283334175" height="16.3352033"/><rect fill="white" stroke="none" x="991.6780112308335" y="742.1322746790911" width="193.20325605" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="993.5628423808334" y="728.310179579091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return: KeyId, </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="976.8812017558334" y="728.310179579091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="993.5628423808334" y="740.8757205790911" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">array of binding statements [BindingStatement1 {extraClaims....}, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="993.5628423808334" y="753.4412615790911" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BindingStatement2 {extraCalims...}]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1357.8305689225 758.467477979091 L 961.6978397141668 758.467477979091" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,758.467477979091) translate(-960.1271470891668,-758.467477979091)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 970.892719691516 753.6648645286114 L 961.3043008318972 758.467477979091 L 970.892719691516 763.2700914295706" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="991.0159018558335" y="777.315789479091" width="253.865365425" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="992.9007330058334" y="788.624776379091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Remember this key is for RP (and maybe path)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="976.8812017558334" y="788.624776379091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">11 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 793.650992779091 L 1010.3893110891668 793.650992779091 L 1010.3893110891668 809.986196079091 L 961.6978397141668 809.986196079091" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,809.986196079091) translate(-960.1271470891668,-809.986196079091)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 970.892719691516 805.1835826286114 L 961.3043008318972 809.986196079091 L 970.892719691516 814.7888095295706" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="558.8570063766668" y="828.834507579091" width="154.525521675" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="853.9655895790911" width="209.8790373" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="866.5311305790912" width="172.5196623" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="879.0966715790912" width="209.8790373" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="891.6622125790913" width="185.8555998" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="916.7932945790914" width="238.338021675" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="929.3588355790914" width="351.283334175" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="941.9243765790915" width="193.20325605" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="840.143494479091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Load sign-in (follow the 302)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="544.0601969016668" y="840.143494479091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">12 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="865.2745764790911" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">x-ms-RefreshTokenCredential1{nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="877.8401174790912" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">x-ms-DeviceCredential1{nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="890.4056584790912" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">x-ms-RefreshTokenCredential2{nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="902.9711994790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">x-ms-DeviceCredential2{nonce} ...</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="928.1022814790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-BindingInfo: KeyId, PublicKey, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="940.6678224790915" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">array of binding statements [BindingStatement1 {extraClaims....}, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="953.2333634790915" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BindingStatement2 {extraCalims...}]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 958.259579879091 L 493.7592518391667 958.259579879091" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(492.18855921416673,958.259579879091) translate(-492.18855921416673,-958.259579879091)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 502.954131816516 953.4569664286114 L 493.3657129568971 958.259579879091 L 502.954131816516 963.0621933295706" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="575.2222407516668" y="1011.034852079091" width="286.95325605" height="16.3352033"/><rect fill="white" stroke="none" x="575.2222407516668" y="1023.600393079091" width="318.552865425" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="577.1070719016668" y="1022.3438389790911" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">302 to IdP with qs parameter sso_nonce=new_nonce</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="560.4254312766668" y="1022.3438389790911" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">13 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="577.1070719016668" y="1034.909379979091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-GenerateKey: RPURL, IDPURL, extraParams</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 492.18855921416673 1039.935596379091 L 958.5564544641668 1039.935596379091" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,1039.935596379091) translate(-960.1271470891668,-1039.935596379091)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 949.3615744868175 1035.1329829286117 L 958.9499933464364 1039.935596379091 L 949.3615744868175 1044.7382098295705" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="558.8570063766668" y="1058.783907879091" width="69.14856855" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="1083.9149898790909" width="238.5665373" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="1096.4805308790908" width="201.2071623" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="1109.0460718790907" width="238.5665373" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="1121.6116128790907" width="214.5430998" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="1146.7426948790905" width="238.338021675" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="1159.3082358790905" width="351.283334175" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="1171.8737768790904" width="193.20325605" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="1070.092894779091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Load sign-in</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="544.0601969016668" y="1070.092894779091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">14 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="1095.223976779091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">x-ms-RefreshTokenCredential1{new_nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="1107.7895177790908" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">x-ms-DeviceCredential1{new_nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="1120.3550587790908" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">x-ms-RefreshTokenCredential2{new_nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="1132.9205997790907" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">x-ms-DeviceCredential2{new_nonce} ...</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="1158.0516817790906" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-BindingInfo: KeyId, PublicKey, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="1170.6172227790905" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">array of binding statements [BindingStatement1 {extraClaims....}, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="1183.1827637790905" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BindingStatement2 {extraCalims...}]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 1188.208980179091 L 493.7592518391667 1188.208980179091" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(492.18855921416673,1188.208980179091) translate(-492.18855921416673,-1188.208980179091)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 502.954131816516 1183.4063667286116 L 493.3657129568971 1188.208980179091 L 502.954131816516 1193.0115936295704" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="545.5474360641668" y="1259.8325638790911" width="154.525521675" height="16.3352033"/><rect fill="white" stroke="none" x="545.5474360641668" y="1284.963645879091" width="209.8790373" height="16.3352033"/><rect fill="white" stroke="none" x="545.5474360641668" y="1297.529186879091" width="172.5196623" height="16.3352033"/><rect fill="white" stroke="none" x="545.5474360641668" y="1310.094727879091" width="209.8790373" height="16.3352033"/><rect fill="white" stroke="none" x="545.5474360641668" y="1322.6602688790908" width="189.189584175" height="16.3352033"/><rect fill="white" stroke="none" x="545.5474360641668" y="1347.7913508790907" width="377.9024748" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="547.4322672141668" y="1271.1415507790912" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Load sign-in (follow the 302)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="530.7506265891668" y="1271.1415507790912" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">15 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="547.4322672141668" y="1296.272632779091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">x-ms-RefreshTokenCredential1{nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="547.4322672141668" y="1308.838173779091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">x-ms-DeviceCredential1{nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="547.4322672141668" y="1321.403714779091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">x-ms-RefreshTokenCredential2{nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="547.4322672141668" y="1333.9692557790909" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">x-ms-DeviceCredential2{nonce} ... </text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="547.4322672141668" y="1359.1003377790908" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-HelperDiscoveryNeeded: RPURL, IDPURL, extraParams</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 1364.126554179091 L 493.7592518391667 1364.126554179091" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(492.18855921416673,1364.126554179091) translate(-492.18855921416673,-1364.126554179091)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 502.954131816516 1359.3239407286117 L 493.3657129568971 1364.126554179091 L 502.954131816516 1368.9291676295704" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 480.87957231416675 1382.974865679091 L 960.1271470891668 1382.974865679091 L 971.4361339891668 1394.283852579091 L 971.4361339891668 1411.875609979091 L 480.87957231416675 1411.875609979091 L 480.87957231416675 1382.974865679091 M 960.1271470891668 1382.974865679091 L 960.1271470891668 1394.283852579091 L 971.4361339891668 1394.283852579091" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="498.4713297141668" y="1400.566623079091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">No binding info present, but the reequest has GenerratKey, so IdP issues helper id list</text></g><g><rect fill="white" stroke="none" x="551.4214595016668" y="1430.7239214790911" width="286.95325605" height="16.3352033"/><rect fill="white" stroke="none" x="551.4214595016668" y="1455.855003479091" width="318.552865425" height="16.3352033"/><rect fill="white" stroke="none" x="551.4214595016668" y="1468.420544479091" width="366.154427925" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="553.3062906516668" y="1442.0329083790912" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">302 to IdP with qs parameter sso_nonce=new_nonce</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="536.6246500266668" y="1442.0329083790912" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">16 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="553.3062906516668" y="1467.163990379091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-GenerateKey: RPURL, IDPURL, extraParams</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="553.3062906516668" y="1479.729531379091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-HelperIdList: [HelperId1, HelperId2], HelperCacheTime</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 492.18855921416673 1484.755747779091 L 958.5564544641668 1484.755747779091" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,1484.755747779091) translate(-960.1271470891668,-1484.755747779091)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 949.3615744868175 1479.9531343286117 L 958.9499933464364 1484.755747779091 L 949.3615744868175 1489.5583612295704" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="991.6780112308335" y="1503.6040592790912" width="268.759896675" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="993.5628423808334" y="1514.9130461790912" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Cache HelperId for IDPURL for HelperCacheTime</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="976.8812017558334" y="1514.9130461790912" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">17 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 1519.939262579091 L 1010.3893110891668 1519.939262579091 L 1010.3893110891668 1536.2744658790912 L 961.6978397141668 1536.2744658790912" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,1536.2744658790912) translate(-960.1271470891668,-1536.2744658790912)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 970.892719691516 1531.4718524286118 L 961.3043008318972 1536.2744658790912 L 970.892719691516 1541.0770793295706" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="991.6780112308335" y="1555.1227773790913" width="291.35950605" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="993.5628423808334" y="1566.4317642790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">currentHelperId = Evaluate policy for (IdP, [HelperId1])</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="976.8812017558334" y="1566.4317642790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">18 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 1571.4579806790912 L 1010.3893110891668 1571.4579806790912 L 1010.3893110891668 1587.7931839790913 L 961.6978397141668 1587.7931839790913" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,1587.7931839790913) translate(-960.1271470891668,-1587.7931839790913)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 970.892719691516 1582.990570528612 L 961.3043008318972 1587.7931839790913 L 970.892719691516 1592.5957974295707" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="1011.3801596683335" y="1606.6414954790912" width="311.8790373" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1013.2649908183334" y="1617.9504823790912" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Pre-gen key and attest (RPURL, IDPURL, extraParams...)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="996.5833501933334" y="1617.9504823790912" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">19 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 1622.9766987790913 L 1356.2598762975 1622.9766987790913" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(1357.8305689225,1622.9766987790913) translate(-1357.8305689225,-1622.9766987790913)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1347.0649963201508 1618.174085328612 L 1356.6534151797698 1622.9766987790913 L 1347.0649963201508 1627.7793122295707" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="1389.3814330641667" y="1641.8250102790914" width="77.814584175" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1391.2662642141668" y="1653.1339971790915" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate Key</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1374.5846235891668" y="1653.1339971790915" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">20 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1357.8305689225 1658.1602135790913 L 1408.0927329225 1658.1602135790913 L 1408.0927329225 1674.4954168790914 L 1359.4012615475 1674.4954168790914" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(1357.8305689225,1674.4954168790914) translate(-1357.8305689225,-1674.4954168790914)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1368.5961415248494 1669.692803428612 L 1359.0077226652304 1674.4954168790914 L 1368.5961415248494 1679.2980303295708" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="1389.3814330641667" y="1727.2706890790917" width="231.66419355" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1391.2662642141668" y="1738.5796759790917" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">create binding statement S(publicKey, AIK)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1374.5846235891668" y="1738.5796759790917" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">21 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1357.8305689225 1743.6058923790915 L 1408.0927329225 1743.6058923790915 L 1408.0927329225 1759.9410956790916 L 1359.4012615475 1759.9410956790916" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(1357.8305689225,1759.9410956790916) translate(-1357.8305689225,-1759.9410956790916)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1368.5961415248494 1755.1384822286122 L 1359.0077226652304 1759.9410956790916 L 1368.5961415248494 1764.743709129571" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="991.6780112308335" y="1797.6377186790914" width="83.8087248" height="16.3352033"/><rect fill="white" stroke="none" x="991.6780112308335" y="1810.2032596790914" width="351.283334175" height="16.3352033"/><rect fill="white" stroke="none" x="991.6780112308335" y="1822.7688006790913" width="193.20325605" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="993.5628423808334" y="1808.9467055790915" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return: KeyId, </text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="976.8812017558334" y="1808.9467055790915" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">22 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="993.5628423808334" y="1821.5122465790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">array of binding statements [BindingStatement1 {extraClaims....}, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="993.5628423808334" y="1834.0777875790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BindingStatement2 {extraCalims...}]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1357.8305689225 1839.1040039790914 L 961.6978397141668 1839.1040039790914" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,1839.1040039790914) translate(-960.1271470891668,-1839.1040039790914)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 970.892719691516 1834.301390528612 L 961.3043008318972 1839.1040039790914 L 970.892719691516 1843.9066174295708" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="991.6780112308335" y="1857.9523154790916" width="253.865365425" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="993.5628423808334" y="1869.2613023790916" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Remember this key is for RP (and maybe path)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="976.8812017558334" y="1869.2613023790916" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">23 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 1874.2875187790914 L 1010.3893110891668 1874.2875187790914 L 1010.3893110891668 1890.6227220790915 L 961.6978397141668 1890.6227220790915" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,1890.6227220790915) translate(-960.1271470891668,-1890.6227220790915)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 970.892719691516 1885.8201086286122 L 961.3043008318972 1890.6227220790915 L 970.892719691516 1895.425335529571" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="558.8570063766668" y="1909.4710335790915" width="69.14856855" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="1934.6021155790913" width="238.5665373" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="1947.1676565790913" width="201.2071623" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="1959.7331975790912" width="241.900521675" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="1972.2987385790912" width="221.21106855" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="1997.429820579091" width="238.338021675" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="2009.995361579091" width="351.283334175" height="16.3352033"/><rect fill="white" stroke="none" x="558.8570063766668" y="2022.560902579091" width="193.20325605" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="1920.7800204790915" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Load sign-in</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="544.0601969016668" y="1920.7800204790915" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">24 </text></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="1945.9111024790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">x-ms-RefreshTokenCredential1{new_nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="1958.4766434790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">x-ms-DeviceCredential1{new_nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="1971.0421844790912" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> x-ms-RefreshTokenCredential2{new_nonce}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="1983.6077254790912" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> x-ms-DeviceCredential2{new_nonce} ... </text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="2008.738807479091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sec-Session-BindingInfo: KeyId, PublicKey, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="2021.304348479091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">array of binding statements [BindingStatement1 {extraClaims....}, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.7418375266668" y="2033.869889479091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">BindingStatement2 {extraCalims...}]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 2038.8961058790915 L 493.7592518391667 2038.8961058790915" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(492.18855921416673,2038.8961058790915) translate(-492.18855921416673,-2038.8961058790915)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 502.954131816516 2034.093492428612 L 493.3657129568971 2038.8961058790915 L 502.954131816516 2043.6987193295708" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="686.2573970016668" y="2110.5196895790914" width="96.482552925" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="688.1422281516668" y="2121.8286764790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sign in ceremony</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="671.4605875266668" y="2121.8286764790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">25 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 492.18855921416673 2126.8548928790915 L 958.5564544641668 2126.8548928790915" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,2126.8548928790915) translate(-960.1271470891668,-2126.8548928790915)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 949.3615744868175 2122.0522794286117 L 958.9499933464364 2126.8548928790915 L 949.3615744868175 2131.6575063295713" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="705.5904048141668" y="2145.7032043790914" width="57.8165373" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="707.4752359641668" y="2157.0121912790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sign done</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="690.7935953391668" y="2157.0121912790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">26 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 2162.0384076790915 L 493.7592518391667 2162.0384076790915" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(492.18855921416673,2162.0384076790915) translate(-492.18855921416673,-2162.0384076790915)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 502.954131816516 2157.2357942286117 L 493.3657129568971 2162.0384076790915 L 502.954131816516 2166.8410211295713" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="664.2378657516668" y="2199.7350306790913" width="140.521615425" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="666.1226969016668" y="2211.0440175790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization code, KeyId</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="649.4410562766668" y="2211.0440175790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">27 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 492.18855921416673 2216.0702339790914 L 958.5564544641668 2216.0702339790914" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,2216.0702339790914) translate(-960.1271470891668,-2216.0702339790914)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 949.3615744868175 2211.2676205286116 L 958.9499933464364 2216.0702339790914 L 949.3615744868175 2220.8728474295713" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 44.28805964749999 2234.9185454790913 L 960.1271470891667 2234.9185454790913 L 971.4361339891667 2246.2275323790914 L 971.4361339891667 2263.8192897790914 L 44.28805964749999 2263.8192897790914 L 44.28805964749999 2234.9185454790913 M 960.1271470891667 2234.9185454790913 L 960.1271470891667 2246.2275323790914 L 971.4361339891667 2246.2275323790914" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="227.49686244333338" y="2252.5103028790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Since DBSC session has been initialized already for RP, browser needs to generate JWT on redirect back</text></g><g><rect fill="white" stroke="none" x="1022.0412924808335" y="2282.6676012790913" width="290.556771675" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1023.9261236308334" y="2293.9765881790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Request Sign JWT (path, RPChallenge, extraParams)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1007.2444830058334" y="2293.9765881790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">28 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 2299.0028045790914 L 1356.2598762975 2299.0028045790914" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(1357.8305689225,2299.0028045790914) translate(-1357.8305689225,-2299.0028045790914)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1347.0649963201508 2294.2001911286116 L 1356.6534151797698 2299.0028045790914 L 1347.0649963201508 2303.8054180295712" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="1106.0793784183334" y="2317.8511160790913" width="122.4805998" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1107.9642095683334" y="2329.1601029790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return JWT Signature</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1091.2825689433334" y="2329.1601029790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">29 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1357.8305689225 2334.1863193790914 L 961.6978397141668 2334.1863193790914" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,2334.1863193790914) translate(-960.1271470891668,-2334.1863193790914)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 970.892719691516 2329.3837059286116 L 961.3043008318972 2334.1863193790914 L 970.892719691516 2338.9889328295712" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 44.28805964749999 2353.0346308790913 L 960.1271470891667 2353.0346308790913 L 971.4361339891667 2364.3436177790913 L 971.4361339891667 2381.9353751790914 L 44.28805964749999 2381.9353751790914 L 44.28805964749999 2353.0346308790913 M 960.1271470891667 2353.0346308790913 L 960.1271470891667 2364.3436177790913 L 971.4361339891667 2364.3436177790913" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="273.4109249433334" y="2370.6263882790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">JWT is appended by the browser before returning the response from IDP back to the RP</text></g><g><rect fill="white" stroke="none" x="430.28000004333336" y="2400.7836866790913" width="171.845834175" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="432.1648311933334" y="2412.0926735790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization code, KeyId, JWT</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="415.4831905683334" y="2412.0926735790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">30 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 2417.1188899790914 L 57.16773917249999 2417.1188899790914" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(55.59704654749999,2417.1188899790914) translate(-55.59704654749999,-2417.1188899790914)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 66.36261914984925 2412.3162765286115 L 56.77420029023036 2417.1188899790914 L 66.36261914984925 2421.921503429571" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="135.93277641833336" y="2435.9672014790913" width="292.60169355" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="137.81760756833336" y="2447.2761883790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(confidential client request) redeem authorization code</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="121.13596694333336" y="2447.2761883790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">31 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 55.59704654749999 2452.3024047790914 L 490.61786658916674 2452.3024047790914" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(492.18855921416673,2452.3024047790914) translate(-492.18855921416673,-2452.3024047790914)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 481.42298661181746 2447.4997913286115 L 491.0114054714364 2452.3024047790914 L 481.42298661181746 2457.105018229571" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="162.28238579333336" y="2471.1507162790913" width="239.9024748" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="164.16721694333336" y="2482.4597031790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(confidential client response) return id_token</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="147.48557631833336" y="2482.4597031790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">32 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 492.18855921416673 2487.4859195790914 L 57.16773917249999 2487.4859195790914" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(55.59704654749999,2487.4859195790914) translate(-55.59704654749999,-2487.4859195790914)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 66.36261914984925 2482.6833061286115 L 56.77420029023036 2487.4859195790914 L 66.36261914984925 2492.288533029571" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="87.14791068916666" y="2506.3342310790913" width="400.642709175" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="89.03274183916666" y="2517.6432179790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">parse id_token and validate binding, match with the JWT from the previous</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="72.35110121416666" y="2517.6432179790913" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">33 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 55.59704654749999 2522.6694343790914 L 105.8592105475 2522.6694343790914 L 105.8592105475 2539.0046376790915 L 57.16773917249999 2539.0046376790915" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(55.59704654749999,2539.0046376790915) translate(-55.59704654749999,-2539.0046376790915)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 66.36261914984925 2534.2020242286117 L 56.77420029023036 2539.0046376790915 L 66.36261914984925 2543.8072511295713" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="464.28195316833336" y="2557.8529491790914" width="103.841927925" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="466.1667843183334" y="2569.1619360790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bound AuthCookie</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="449.4851436933334" y="2569.1619360790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">34 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 55.59704654749999 2574.1881524790915 L 958.5564544641668 2574.1881524790915" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,2574.1881524790915) translate(-960.1271470891668,-2574.1881524790915)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 949.3615744868175 2569.3855390286117 L 958.9499933464364 2574.1881524790915 L 949.3615744868175 2578.9907659295714" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 44.28805964749999 2593.0364639790914 L 1357.8305689225 2593.0364639790914 L 1369.1395558225001 2604.3454508790915 L 1369.1395558225001 2621.9372082790915 L 44.28805964749999 2621.9372082790915 L 44.28805964749999 2593.0364639790914 M 1357.8305689225 2593.0364639790914 L 1357.8305689225 2604.3454508790915 L 1369.1395558225001 2604.3454508790915" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="662.3671280475" y="2610.6282213790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Refresh DBSC...</text></g><g><rect fill="white" stroke="none" x="407.94992191833336" y="2640.7855197790914" width="216.505990425" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="409.8347530683334" y="2652.0945066790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh (sessionID)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="393.1531124433334" y="2652.0945066790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">35 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 2657.1207230790915 L 57.16773917249999 2657.1207230790915" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(55.59704654749999,2657.1207230790915) translate(-55.59704654749999,-2657.1207230790915)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 66.36261914984925 2652.3181096286116 L 56.77420029023036 2657.1207230790915 L 66.36261914984925 2661.9233365295713" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="447.93722660583336" y="2675.9690345790914" width="64.478646675" height="16.3352033"/><rect fill="white" stroke="none" x="447.93722660583336" y="2675.9690345790914" width="75.822396675" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="449.8220577558334" y="2687.2780214790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Challenge, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="510.5310421308334" y="2687.2780214790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">extraParams</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="433.1404171308334" y="2687.2780214790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">36 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 55.59704654749999 2692.3042378790915 L 958.5564544641668 2692.3042378790915" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,2692.3042378790915) translate(-960.1271470891668,-2692.3042378790915)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 949.3615744868175 2687.5016244286116 L 958.9499933464364 2692.3042378790915 L 949.3615744868175 2697.1068513295713" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="1005.3596518558335" y="2711.1525493790914" width="247.8712248" height="16.3352033"/><rect fill="white" stroke="none" x="1005.3596518558335" y="2711.1525493790914" width="75.822396675" height="16.3352033"/><rect fill="white" stroke="none" x="1005.3596518558335" y="2711.1525493790914" width="7.76575605" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1007.2444830058334" y="2722.4615362790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Request Sign JWT (sessionID, RPChallenge, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1251.3460455058334" y="2722.4615362790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">extraParams</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1323.3987798808334" y="2722.4615362790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="990.5628423808334" y="2722.4615362790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">37 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 2727.4877526790915 L 1356.2598762975 2727.4877526790915" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(1357.8305689225,2727.4877526790915) translate(-1357.8305689225,-2727.4877526790915)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1347.0649963201508 2722.6851392286117 L 1356.6534151797698 2727.4877526790915 L 1347.0649963201508 2732.2903661295713" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="1106.0793784183334" y="2746.3360641790914" width="122.4805998" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1107.9642095683334" y="2757.6450510790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return JWT Signature</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1091.2825689433334" y="2757.6450510790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">38 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1357.8305689225 2762.6712674790915 L 961.6978397141668 2762.6712674790915" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,2762.6712674790915) translate(-960.1271470891668,-2762.6712674790915)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 970.892719691516 2757.8686540286117 L 961.3043008318972 2762.6712674790915 L 970.892719691516 2767.4738809295714" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="421.96554691833336" y="2781.5195789790914" width="188.474740425" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="423.8503780683334" y="2792.8285658790915" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /securesession/refresh (JWT)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="407.1687374433334" y="2792.8285658790915" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">39 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 960.1271470891668 2797.8547822790915 L 57.16773917249999 2797.8547822790915" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(55.59704654749999,2797.8547822790915) translate(-55.59704654749999,-2797.8547822790915)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 66.36261914984925 2793.0521688286117 L 56.77420029023036 2797.8547822790915 L 66.36261914984925 2802.6573957295714" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="87.14791068916666" y="2816.7030937790914" width="186.2774748" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="89.03274183916666" y="2828.0120806790915" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate JWT (w/public key on file)</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="72.35110121416666" y="2828.0120806790915" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">40 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 55.59704654749999 2833.0382970790915 L 105.8592105475 2833.0382970790915 L 105.8592105475 2849.3735003790916 L 57.16773917249999 2849.3735003790916" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(55.59704654749999,2849.3735003790916) translate(-55.59704654749999,-2849.3735003790916)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 66.36261914984925 2844.570886928612 L 56.77420029023036 2849.3735003790916 L 66.36261914984925 2854.1761138295715" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><rect fill="white" stroke="none" x="483.29855473083336" y="2868.2218118790915" width="65.8087248" height="16.3352033"/><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="485.1833858808334" y="2879.5307987790916" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthCookie</text><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="bold" text-decoration="normal" x="468.5017452558334" y="2879.5307987790916" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">41 </text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 55.59704654749999 2884.5570151790916 L 958.5564544641668 2884.5570151790916" stroke-miterlimit="10" stroke-width="1.0471284166666666" stroke-dasharray=""/><g transform="translate(960.1271470891668,2884.5570151790916) translate(-960.1271470891668,-2884.5570151790916)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 949.3615744868175 2879.754401728612 L 958.9499933464364 2884.5570151790916 L 949.3615744868175 2889.3596286295715" stroke-miterlimit="10" stroke-width="1.0471284166666666"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 435.6436247141667 440.55929067909096 L 1638.0091069641667 440.55929067909096 L 1638.0091069641667 2057.7444173790914 L 435.6436247141667 2057.7444173790914 L 435.6436247141667 440.55929067909096 Z" stroke-miterlimit="10" stroke-width="1.7950772857142856" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 435.6436247141667 440.55929067909096 L 435.6436247141667 455.63793987909094 L 471.9778011965886 455.63793987909094 L 479.5171257965886 448.09861527909095 L 479.5171257965886 440.55929067909096 L 435.6436247141667 440.55929067909096" stroke-miterlimit="10" stroke-width="1.7950772857142856" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="7.2pt" font-style="normal" font-weight="bold" text-decoration="normal" x="448.2091657141667" y="450.6117234790909" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="490.19783564658854" y="441.5645339590909" width="194.24584333027343" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7.2pt" font-style="normal" font-weight="bold" text-decoration="normal" x="492.08266679658857" y="450.6117234790909" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Cached HelperId present (99.99% cases)]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 435.6436247141667 1225.905603179091 L 1638.0091069641667 1225.905603179091" stroke-miterlimit="10" stroke-width="1.7950772857142856" stroke-dasharray="3.14138525"/></g><g/><g><rect fill="white" stroke="none" x="490.19783564658854" y="1226.9108464590909" width="137.13347760761718" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7.2pt" font-style="normal" font-weight="bold" text-decoration="normal" x="492.08266679658857" y="1235.958035979091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[No cached HelperId present]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1313.8511754225 612.707202379091 L 1618.7697378391667 612.707202379091 L 1618.7697378391667 698.152881179091 L 1313.8511754225 698.152881179091 L 1313.8511754225 612.707202379091 Z" stroke-miterlimit="10" stroke-width="1.7950772857142856" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1313.8511754225 612.707202379091 L 1313.8511754225 627.785851579091 L 1359.2416110601955 627.785851579091 L 1366.7809356601956 620.246526979091 L 1366.7809356601956 612.707202379091 L 1313.8511754225 612.707202379091" stroke-miterlimit="10" stroke-width="1.7950772857142856" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="7.2pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1326.4167164225" y="622.759635179091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">loop</text><g><rect fill="white" stroke="none" x="1377.4616455101955" y="613.712445659091" width="82.73044721210937" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7.2pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1379.3464766601955" y="622.759635179091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[For each device]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 448.2091657141667 977.107891379091 L 1004.1065405891668 977.107891379091 L 1004.1065405891668 1207.057291679091 L 448.2091657141667 1207.057291679091 L 448.2091657141667 977.107891379091 Z" stroke-miterlimit="10" stroke-width="1.7950772857142856" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 448.2091657141667 977.107891379091 L 448.2091657141667 992.186540579091 L 488.26523550713546 992.186540579091 L 495.80456010713544 984.647215979091 L 495.80456010713544 977.107891379091 L 448.2091657141667 977.107891379091" stroke-miterlimit="10" stroke-width="1.7950772857142856" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="7.2pt" font-style="normal" font-weight="bold" text-decoration="normal" x="460.7747067141667" y="987.160324179091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">opt</text><g><rect fill="white" stroke="none" x="506.4852699571354" y="978.1131346590911" width="73.65545026386718" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7.2pt" font-style="normal" font-weight="bold" text-decoration="normal" x="508.37010110713544" y="987.160324179091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[nonce is stale]</text></g><g/><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1313.8511754225 1693.3437283790915 L 1625.4435659641667 1693.3437283790915 L 1625.4435659641667 1778.7894071790915 L 1313.8511754225 1778.7894071790915 L 1313.8511754225 1693.3437283790915 Z" stroke-miterlimit="10" stroke-width="1.7950772857142856" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1313.8511754225 1693.3437283790915 L 1313.8511754225 1708.4223775790915 L 1359.2416110601955 1708.4223775790915 L 1366.7809356601956 1700.8830529790916 L 1366.7809356601956 1693.3437283790915 L 1313.8511754225 1693.3437283790915" stroke-miterlimit="10" stroke-width="1.7950772857142856" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="7.2pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1326.4167164225" y="1703.3961611790915" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">loop</text><g><rect fill="white" stroke="none" x="1377.4616455101955" y="1694.3489716590914" width="82.73044721210937" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7.2pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1379.3464766601955" y="1703.3961611790915" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[For each device]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 448.2091657141667 2076.5927288790913 L 1004.1065405891668 2076.5927288790913 L 1004.1065405891668 2180.8867191790914 L 448.2091657141667 2180.8867191790914 L 448.2091657141667 2076.5927288790913 Z" stroke-miterlimit="10" stroke-width="1.7950772857142856" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 448.2091657141667 2076.5927288790913 L 448.2091657141667 2091.6713780790915 L 488.26523550713546 2091.6713780790915 L 495.80456010713544 2084.132053479091 L 495.80456010713544 2076.5927288790913 L 448.2091657141667 2076.5927288790913" stroke-miterlimit="10" stroke-width="1.7950772857142856" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="7.2pt" font-style="normal" font-weight="bold" text-decoration="normal" x="460.7747067141667" y="2086.6451616790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">opt</text><g><rect fill="white" stroke="none" x="506.4852699571354" y="2077.5979721590916" width="159.5022062453125" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7.2pt" font-style="normal" font-weight="bold" text-decoration="normal" x="508.37010110713544" y="2086.6451616790914" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[SSO information is not sufficient]</text></g></g></g></svg>